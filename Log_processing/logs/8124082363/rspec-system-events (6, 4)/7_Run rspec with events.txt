2024-03-02T16:41:36.8871884Z ##[group]Run RUBYOPT='-W:no-deprecated -W:no-experimental' bin/knapsack_pro_rspec
2024-03-02T16:41:36.8872775Z [36;1mRUBYOPT='-W:no-deprecated -W:no-experimental' bin/knapsack_pro_rspec[0m
2024-03-02T16:41:36.8900760Z shell: /usr/bin/bash -e {0}
2024-03-02T16:41:36.8901167Z env:
2024-03-02T16:41:36.8901587Z   POSTGRES_HOST: localhost
2024-03-02T16:41:36.8901991Z   DATABASE_HOST: localhost
2024-03-02T16:41:36.8902331Z   PG_USERNAME: postgres
2024-03-02T16:41:36.8902767Z   PG_PASSWORD: password
2024-03-02T16:41:36.8903191Z   POSTGRES_HOST_AUTH_METHOD: trust
2024-03-02T16:41:36.8903601Z   POSTGRES_PORT: 5432
2024-03-02T16:41:36.8904045Z   PGHOST: localhost
2024-03-02T16:41:36.8904388Z   PGUSER: postgres
2024-03-02T16:41:36.8904784Z   RAILS_ENV: test
2024-03-02T16:41:36.8905438Z   KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC: ***
2024-03-02T16:41:36.8905861Z   KNAPSACK_PRO_CI_NODE_TOTAL: 6
2024-03-02T16:41:36.8906341Z   KNAPSACK_PRO_CI_NODE_INDEX: 4
2024-03-02T16:41:36.8906803Z   KNAPSACK_PRO_RSPEC_SPLIT_BY_TEST_EXAMPLES: true
2024-03-02T16:41:36.8907434Z   KNAPSACK_PRO_LOG_LEVEL: info
2024-03-02T16:41:36.8908082Z   KNAPSACK_PRO_TEST_FILE_PATTERN: {spec/system/**{,/*/**}/*_spec.rb,spec/requests/**{,/*/**}/*_spec.rb}
2024-03-02T16:41:36.8908728Z   EVENTS_READ: true
2024-03-02T16:41:36.8909111Z ##[endgroup]
2024-03-02T16:41:43.0202572Z I, [2024-03-02T16:41:43.019786 #2472]  INFO -- : [knapsack_pro] Generating RSpec test examples JSON report for slow test files to prepare it to be split by test examples (by individual test cases). Thanks to that, a single slow test file can be split across parallel CI nodes. Analyzing 1 slow test files.
2024-03-02T16:41:51.8621509Z Coverage report generated for RSpec to /home/runner/work/human-essentials/human-essentials/coverage. 2526 / 6642 LOC (38.03%) covered.
2024-03-02T16:41:56.0203434Z /opt/hostedtoolcache/Ruby/3.2.2/x64/bin/ruby -I/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/lib:/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-support-3.12.1/lib /home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/exe/rspec  --format documentation --format KnapsackPro::Formatters::TimeTracker --default-path spec "spec/system/adjustment_system_spec.rb" "spec/system/sign_in_system_spec.rb" "spec/system/request_system_spec.rb" "spec/system/admin/base_items_system_spec.rb" "spec/system/partners/managing_requests_system_spec.rb" "spec/system/partners/family_requests_system_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:5:2:1:3]" "spec/system/manufacturer_system_spec.rb" "spec/system/account_system_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:2:1:1]" "spec/requests/purchases_requests_spec.rb" "spec/requests/barcode_items_requests_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:6:6:1:1]" "spec/requests/users_requests_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:5:6:1:3]" "spec/system/dashboard_system_spec.rb[1:2:3:4:1:1]" "spec/system/dashboard_system_spec.rb[1:2:4:2:1:1]" "spec/system/dashboard_system_spec.rb[1:2:5:2:1:2]" "spec/system/dashboard_system_spec.rb[1:2:5:8:1:2]" "spec/requests/product_drive_participants_requests_spec.rb" "spec/system/admin/dashboard_system_spec.rb" "spec/requests/partners/requests_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:7:1]" "spec/requests/broadcast_announcements_spec.rb" "spec/requests/admin/questions_spec.rb" "spec/requests/donations_requests_spec.rb" "spec/requests/attachments_requests_spec.rb"
2024-03-02T16:42:04.3009420Z Run options: include {:ids=>{"./spec/system/dashboard_system_spec.rb"=>["1:2:5:2:1:3", "1:2:2:1:1", "1:2:6:6:1:1", "1:2:5:6:1:3", "1:2:3:4:1:1", "1:2:4:2:1:1", "1:2:5:2:1:2", "1:2:5:8:1:2", "1:2:7:1"]}}
2024-03-02T16:42:04.3040628Z 
2024-03-02T16:42:04.3041092Z Randomized with seed 50602
2024-03-02T16:42:05.3058242Z 
2024-03-02T16:42:05.3059021Z /partners/requests
2024-03-02T16:42:05.3060112Z   POST #create
2024-03-02T16:42:05.3060942Z     when given invalid parameters
2024-03-02T16:42:05.4232943Z       should not redirect
2024-03-02T16:42:05.4233706Z     when given valid parameters
2024-03-02T16:42:05.4851992Z       should redirect to the show page
2024-03-02T16:42:05.4852878Z   GET #index
2024-03-02T16:42:05.5335530Z     should render without any issues
2024-03-02T16:42:05.5958073Z     should display total count of items in partner request
2024-03-02T16:42:05.5958707Z   GET #show
2024-03-02T16:42:05.6461387Z     should render without any issues
2024-03-02T16:42:05.7167396Z     should give a 404 error if forbidden
2024-03-02T16:42:05.7647452Z     should give a 404 error if not found
2024-03-02T16:42:05.7648395Z   GET #new
2024-03-02T16:42:05.8158158Z     should render without any issues
2024-03-02T16:42:05.8158725Z 
2024-03-02T16:42:05.8159130Z Dashboard
2024-03-02T16:42:05.8160840Z   When the super admin user does not have an organization assigned
2024-03-02T16:42:12.1637704Z     DOES NOT have a link to the organization
2024-03-02T16:42:12.1638446Z   When the super admin user also has an organization assigned
2024-03-02T16:42:12.6402973Z     displays a link to return to their organization
2024-03-02T16:42:12.6403822Z 
2024-03-02T16:42:12.6404410Z ProductDriveParticipants
2024-03-02T16:42:12.6405504Z   While not signed in
2024-03-02T16:42:12.6557633Z     redirects the user to the sign-in page for CRUD actions
2024-03-02T16:42:12.6558551Z   While signed in
2024-03-02T16:42:12.6559370Z     GET #show
2024-03-02T16:42:12.6947466Z       returns http success
2024-03-02T16:42:12.6948411Z     GET #new
2024-03-02T16:42:12.7270884Z       returns http success
2024-03-02T16:42:12.7271364Z     POST #create
2024-03-02T16:42:12.7594443Z       flash error
2024-03-02T16:42:12.7733769Z       successful create
2024-03-02T16:42:12.7734426Z     XHR #create
2024-03-02T16:42:12.8027224Z       successful create
2024-03-02T16:42:12.8336783Z       flash error
2024-03-02T16:42:12.8337349Z     GET #index
2024-03-02T16:42:12.8338084Z       html
2024-03-02T16:42:12.8661543Z         is expected to be successful
2024-03-02T16:42:12.8662522Z       csv
2024-03-02T16:42:12.8820476Z         is expected to be successful
2024-03-02T16:42:12.8821181Z     GET #edit
2024-03-02T16:42:12.9135276Z       returns http success
2024-03-02T16:42:12.9136017Z     Looking at a different organization
2024-03-02T16:42:13.0830273Z       redirects the user to the sign-in page for CRUD actions
2024-03-02T16:42:13.0831235Z     POST #import_csv
2024-03-02T16:42:13.0831867Z       csv file with wrong headers
2024-03-02T16:42:13.1005116Z         presents a flash error message
2024-03-02T16:42:13.1131983Z         redirects
2024-03-02T16:42:13.1132629Z       with a csv file
2024-03-02T16:42:13.1311633Z         redirects
2024-03-02T16:42:13.1361172Z         invokes .import_csv
2024-03-02T16:42:13.1538704Z         presents a flash notice message
2024-03-02T16:42:13.1539690Z       without a csv file
2024-03-02T16:42:13.1653620Z         presents a flash error message
2024-03-02T16:42:13.1767044Z         redirects to :index
2024-03-02T16:42:13.1769191Z 
2024-03-02T16:42:13.1769607Z Users
2024-03-02T16:42:13.1771029Z   POST #send_partner_user_reset_password
2024-03-02T16:42:13.2958966Z     should return send a password even if case-insensitive spelling of email
2024-03-02T16:42:13.3387972Z     should send a password
2024-03-02T16:42:13.3792018Z     should return an error if it cannot find the user
2024-03-02T16:42:13.5830694Z     should return an error if organization does not own the partner
2024-03-02T16:42:13.5832137Z   GET #switch_to_partner_role
2024-03-02T16:42:13.5833338Z     with a partner role
2024-03-02T16:42:13.6197331Z       should redirect to the partner path
2024-03-02T16:42:13.6198308Z     without a partner role
2024-03-02T16:42:13.8152431Z       should redirect to the root path with an error
2024-03-02T16:42:13.8153344Z   GET #index
2024-03-02T16:42:13.8461393Z     returns http success
2024-03-02T16:42:13.8461981Z   GET #new
2024-03-02T16:42:13.8746468Z     returns http success
2024-03-02T16:42:13.8747051Z 
2024-03-02T16:42:13.8747260Z Attachments
2024-03-02T16:42:13.8748352Z   DELETE #destroy
2024-03-02T16:42:13.9219794Z     redirects to referrer
2024-03-02T16:42:13.9222833Z 
2024-03-02T16:42:13.9223112Z Dashboard
2024-03-02T16:42:13.9224722Z   With an existing essentials bank
2024-03-02T16:42:13.9225980Z     Manufacturer Donations
2024-03-02T16:42:13.9229911Z       given 1 Manufacturer donating on 2024-02-29  (unless 'All Time'), 1 during 2024-03-01..2024-03-31, and 1 on 2024-04-01
2024-03-02T16:42:13.9231229Z         filtering to 'This Month'
2024-03-02T16:42:15.7142284Z           shows the correct total and 3 Top Manufacturer Donation link(s)
2024-03-02T16:42:15.7144365Z     Donations
2024-03-02T16:42:15.7148472Z       given 1 Donation on 2024-02-29 (only if a valid date), 3 during 2024-03-01..2024-03-01, and 1 on 2024-03-02
2024-03-02T16:42:15.7149728Z         filtering to 'Yesterday'
2024-03-02T16:42:17.1814753Z           shows the correct total and 3 Recent Donation link(s)
2024-03-02T16:42:17.1815903Z     Inventory Totals
2024-03-02T16:42:17.1816905Z       Summary
2024-03-02T16:42:17.8884549Z         displays the on-hand totals
2024-03-02T16:42:17.8885527Z     Purchases
2024-03-02T16:42:17.8891519Z       given 1 Purchase on 2024-03-01  (unless 'All Time'), 1 during 2024-03-02..2024-03-02, and 1 on 2024-03-03
2024-03-02T16:42:17.8892752Z         filtering to 'Today'
2024-03-02T16:42:19.2751361Z           shows correct 1 Recent Purchase link(s)
2024-03-02T16:42:19.2752573Z     Product Drives
2024-03-02T16:42:19.2755295Z       given 1 Product Drive Donation on 2024-02-29 (unless 'All Time'), 0 during 2024-03-01..2024-03-31, and 1 on 2024-04-01
2024-03-02T16:42:19.2756500Z         filtering to 'This Month'
2024-03-02T16:42:22.6033124Z           shows 0 Recent Donation link(s)
2024-03-02T16:42:22.6034935Z       given 1 Product Drive Donation on 2024-03-01 (unless 'All Time'), 2 during 2024-03-02..2024-03-02, and 1 on 2024-03-03
2024-03-02T16:42:22.6035942Z         filtering to 'Today'
2024-03-02T16:42:24.0359058Z           shows the correct total money raised
2024-03-02T16:42:25.5710028Z           shows 2 Recent Donation link(s)
2024-03-02T16:42:25.5712390Z       given 1 Product Drive Donation on 2023-12-31 (unless 'All Time'), 1 during 2024-01-01..2024-12-31, and 1 on 2025-01-01
2024-03-02T16:42:25.5713643Z         filtering to 'This Year'
2024-03-02T16:42:26.9636950Z           shows the correct total money raised
2024-03-02T16:42:26.9638012Z     Distributions
2024-03-02T16:42:27.9139994Z       has a link to create a new distribution
2024-03-02T16:42:27.9144957Z 
2024-03-02T16:42:27.9145315Z Purchases
2024-03-02T16:42:27.9146622Z   While signed in as a user >
2024-03-02T16:42:27.9148121Z     PUT#update
2024-03-02T16:42:28.0395992Z       updates storage quantity correctly
2024-03-02T16:42:28.0779826Z       redirects to index after update
2024-03-02T16:42:28.0780443Z       when changing storage location
2024-03-02T16:42:28.1954746Z         updates storage quantity correctly
2024-03-02T16:42:28.1992981Z         rollsback updates if quantity would go below 0
2024-03-02T16:42:28.1993706Z       when removing a line item
2024-03-02T16:42:28.3223024Z         updates storage invetory item quantity correctly
2024-03-02T16:42:28.3223656Z     DELETE #destroy
2024-03-02T16:42:28.3468775Z       does not delete a purchase
2024-03-02T16:42:28.3688441Z       redirects to the dashboard
2024-03-02T16:42:28.3689070Z     GET #show
2024-03-02T16:42:28.4080772Z       returns http success
2024-03-02T16:42:28.4081662Z     POST#create
2024-03-02T16:42:28.4082116Z       on failure
2024-03-02T16:42:28.4593808Z         renders GET#new with error
2024-03-02T16:42:28.4594550Z       on success
2024-03-02T16:42:28.5018258Z         accepts :amount_spent_in_cents with dollar signs, commas, and periods
2024-03-02T16:42:28.5436426Z         redirects to GET#edit
2024-03-02T16:42:28.6022493Z         storage location defaults to organizations storage location
2024-03-02T16:42:28.6023986Z     GET #index
2024-03-02T16:42:28.6024624Z       csv
2024-03-02T16:42:28.6320753Z         is expected to be successful
2024-03-02T16:42:28.6321912Z       html
2024-03-02T16:42:28.6749131Z         is expected to be successful
2024-03-02T16:42:28.6750055Z     GET #new
2024-03-02T16:42:28.7153858Z       is expected to be successful
2024-03-02T16:42:28.7154656Z     GET #edit
2024-03-02T16:42:28.7677416Z       storage location is correct
2024-03-02T16:42:28.8193478Z       returns http success
2024-03-02T16:42:28.8194780Z       when non-finalized audit has been performed on the purchased items
2024-03-02T16:42:28.9575811Z         does not show a warning
2024-03-02T16:42:28.9577035Z       when an finalized audit has been performed on the purchased items
2024-03-02T16:42:29.0906896Z         shows a warning
2024-03-02T16:42:29.0907570Z       when no audit has been performed
2024-03-02T16:42:29.1927486Z         does not show a warning
2024-03-02T16:42:29.1928710Z   While signed in as an organizational admin
2024-03-02T16:42:29.1929506Z     DELETE #destroy
2024-03-02T16:42:29.2900612Z       decreases storage location inventory
2024-03-02T16:42:29.3239640Z       displays the proper flash notice
2024-03-02T16:42:29.3583438Z       deletes a purchase
2024-03-02T16:42:29.3916644Z       redirects to the index
2024-03-02T16:42:29.3917760Z 
2024-03-02T16:42:29.3918117Z Admin::Questions
2024-03-02T16:42:29.3919412Z   while signed in as a super admin
2024-03-02T16:42:29.3920878Z     DELETE #destroy
2024-03-02T16:42:29.4291463Z       lets the user delete questions
2024-03-02T16:42:29.4292531Z     GET #new
2024-03-02T16:42:29.4710943Z       lets the user load the new question page
2024-03-02T16:42:29.4711823Z     PATCH #update
2024-03-02T16:42:29.4927281Z       lets the user update questions
2024-03-02T16:42:29.4928401Z     POST #create
2024-03-02T16:42:29.5116687Z       lets the user create questions
2024-03-02T16:42:29.5117448Z     GET #edit
2024-03-02T16:42:29.5490390Z       lets the user load the edit question page
2024-03-02T16:42:29.5491643Z     GET #index
2024-03-02T16:42:29.5783559Z       lets the user load the page
2024-03-02T16:42:29.5784288Z 
2024-03-02T16:42:29.5784838Z BroadcastAnnouncements
2024-03-02T16:42:29.5786404Z   GET /new
2024-03-02T16:42:29.6123099Z     renders a successful response
2024-03-02T16:42:29.6125267Z   GET /index
2024-03-02T16:42:29.6434238Z     renders a successful response
2024-03-02T16:42:29.6435037Z   PATCH /update
2024-03-02T16:42:29.6436039Z     with invalid parameters
2024-03-02T16:42:29.6758427Z       does not render a successful response
2024-03-02T16:42:29.6759617Z     with valid parameters
2024-03-02T16:42:29.6938138Z       updates the requested announcement and redirects
2024-03-02T16:42:29.6943437Z   GET /edit
2024-03-02T16:42:29.7258880Z     render a successful response
2024-03-02T16:42:29.7259754Z   DELETE /destroy
2024-03-02T16:42:29.7433315Z     destroys the requested announcement then redirects
2024-03-02T16:42:29.7434429Z   POST /create
2024-03-02T16:42:29.7435034Z     with invalid parameters
2024-03-02T16:42:29.7734277Z       does not create a new BroadcastAnnouncement
2024-03-02T16:42:29.8015772Z       does not render a successful response
2024-03-02T16:42:29.8016670Z     with valid parameters
2024-03-02T16:42:29.8171625Z       creates a new BroadcastAnnouncement then redirects
2024-03-02T16:42:29.8172277Z 
2024-03-02T16:42:29.8172600Z Family requests
2024-03-02T16:42:29.8174091Z   for children with different items, from different families
2024-03-02T16:42:31.4503315Z     it creates family requests
2024-03-02T16:42:31.4504249Z   filtering children
2024-03-02T16:42:32.4187319Z     user can see a list of children filtered by guardian name
2024-03-02T16:42:33.3589155Z     user can see a list of children filtered by first_name
2024-03-02T16:42:33.3589854Z 
2024-03-02T16:42:33.3590211Z Base Item Admin
2024-03-02T16:42:33.3592156Z   While signed in as an Administrative User with no organization (super admin no org)
2024-03-02T16:42:33.8783299Z     can view a listing of all Base Items that shows a summary of its sub-items
2024-03-02T16:42:33.9891369Z     can view a single Base Item (FAILED - 1)
2024-03-02T16:42:33.9892627Z     when updating an existing base item
2024-03-02T16:42:34.7876211Z       should succeed when changing the name
2024-03-02T16:42:35.4944732Z       should fail when updating the name to empty
2024-03-02T16:42:35.4945661Z     when creating a new base item
2024-03-02T16:42:36.2148598Z       should fail when creating a new base item with empty attributes
2024-03-02T16:42:37.0308944Z       should succeed when creating a new base item with good data
2024-03-02T16:42:37.0310170Z   While signed in as a normal user
2024-03-02T16:42:38.4486779Z     should have a normal user not see anything
2024-03-02T16:42:38.4487837Z   While signed in as an Administrative User (super admin)
2024-03-02T16:42:38.5544910Z     can view a single Base Item (FAILED - 2)
2024-03-02T16:42:39.0586562Z     can view a listing of all Base Items that shows a summary of its sub-items
2024-03-02T16:42:39.0587677Z     when creating a new base item
2024-03-02T16:42:39.8758130Z       should succeed when creating a new base item with good data
2024-03-02T16:42:40.6295918Z       should fail when creating a new base item with empty attributes
2024-03-02T16:42:40.6302576Z     when updating an existing base item
2024-03-02T16:42:41.4328829Z       should fail when updating the name to empty
2024-03-02T16:42:42.2198733Z       should succeed when changing the name
2024-03-02T16:42:42.2199534Z 
2024-03-02T16:42:42.2200153Z User account management
2024-03-02T16:42:42.2201567Z   when not in staging
2024-03-02T16:42:43.0764355Z     should change an user name
2024-03-02T16:42:43.9444236Z     should change the email
2024-03-02T16:42:44.6886172Z     should fail when the email is invalid
2024-03-02T16:42:44.6886911Z   when in staging
2024-03-02T16:42:45.1373618Z     should display staging warning
2024-03-02T16:42:45.5713848Z     should not allow the user to change staging credentials
2024-03-02T16:42:45.5714608Z 
2024-03-02T16:42:45.5715008Z Donations
2024-03-02T16:42:45.5716112Z   while signed in
2024-03-02T16:42:45.5717933Z     when an non-finalized audit has been performed on the donated items
2024-03-02T16:42:45.7099352Z       does not shows a warning
2024-03-02T16:42:45.7100602Z     GET #index
2024-03-02T16:42:45.7101469Z       csv
2024-03-02T16:42:45.7456322Z         is expected to be successful
2024-03-02T16:42:45.7457390Z       html
2024-03-02T16:42:45.7941443Z         should have the columns source and details
2024-03-02T16:42:45.8365732Z         is expected to be successful
2024-03-02T16:42:45.8366742Z         when given a manufacturer
2024-03-02T16:42:45.8860880Z           should display Manufacturer and the manufacturer name
2024-03-02T16:42:45.8862219Z         when given a misc donation
2024-03-02T16:42:45.9356401Z           should display Misc Donation and a truncated comment
2024-03-02T16:42:45.9357777Z         when given a product drive
2024-03-02T16:42:45.9850554Z           should display Product Drive and the name of the drive
2024-03-02T16:42:45.9851727Z         when given a donation site
2024-03-02T16:42:46.0356333Z           should display Donation Site and the name of the site
2024-03-02T16:42:46.0357325Z     when no audit has been performed
2024-03-02T16:42:46.1366309Z       doesn't show a warning
2024-03-02T16:42:46.1367258Z     GET #edit
2024-03-02T16:42:46.1368502Z       when an finalized audit has been performed on the donated items
2024-03-02T16:42:46.2595285Z         shows a warning
2024-03-02T16:42:46.2596343Z 
2024-03-02T16:42:46.2596744Z BarcodeItems
2024-03-02T16:42:46.2597745Z   While signed in
2024-03-02T16:42:46.2599445Z     GET #show
2024-03-02T16:42:46.2601267Z       with a global barcode item
2024-03-02T16:42:46.2679715Z         returns a 404 (FAILED - 3)
2024-03-02T16:42:46.2680496Z       with a normal barcode item
2024-03-02T16:42:46.3028092Z         returns http success
2024-03-02T16:42:46.3028993Z     GET #edit
2024-03-02T16:42:46.3030029Z       with a normal barcode item
2024-03-02T16:42:46.3488998Z         returns http success
2024-03-02T16:42:46.3489795Z       with a global barcode item
2024-03-02T16:42:46.3563865Z         returns a 404 (FAILED - 4)
2024-03-02T16:42:46.3565096Z     GET #new
2024-03-02T16:42:46.3888392Z       returns http success
2024-03-02T16:42:46.3889194Z     GET #index
2024-03-02T16:42:46.3889956Z       html
2024-03-02T16:42:46.4304633Z         is expected to be successful
2024-03-02T16:42:46.4305648Z       csv
2024-03-02T16:42:46.4529684Z         is expected to be successful
2024-03-02T16:42:46.4530496Z     GET #find
2024-03-02T16:42:46.4531178Z       via ajax
2024-03-02T16:42:46.4600722Z         can find a barcode that's universally available (FAILED - 5)
2024-03-02T16:42:46.4685838Z         can find a barcode that is scoped to just this organization (FAILED - 6)
2024-03-02T16:42:46.4687133Z         when it's missing
2024-03-02T16:42:46.4755115Z           returns a 404 (FAILED - 7)
2024-03-02T16:42:46.4756118Z     DELETE #destroy
2024-03-02T16:42:46.4861069Z       disallows a non-superadmin to delete a global barcode (FAILED - 8)
2024-03-02T16:42:46.6804992Z       disallows a user to delete someone else's barcode
2024-03-02T16:42:46.7148126Z       redirects to the index
2024-03-02T16:42:46.7148877Z     Looking at a different organization
2024-03-02T16:42:46.8999978Z       redirects the user to the sign-in page for CRUD actions
2024-03-02T16:42:46.9000694Z 
2024-03-02T16:42:46.9000946Z Manufacturer
2024-03-02T16:42:47.6818931Z   allows a user to create a new manufacturer instance
2024-03-02T16:42:48.4233989Z   allows a user to update the contact info for a manufacturer
2024-03-02T16:42:49.1621538Z   allows a user to update a manufacturer with empty attributes
2024-03-02T16:42:49.8710220Z   allows a user to add a new manufacturer instance with empty attributes
2024-03-02T16:42:49.8711715Z   When the Manufacturers have donations associated with them already
2024-03-02T16:42:50.5352435Z     allows single Manufacturers to show semi-detailed stats about donations from that manufacturer
2024-03-02T16:42:51.2140227Z     shows existing Manufacturers in the #index with some summary stats
2024-03-02T16:42:51.2141366Z   When a user views the index page
2024-03-02T16:42:51.6710242Z     alphabetizes the manufacturer names
2024-03-02T16:42:51.6710908Z 
2024-03-02T16:42:51.6711148Z Managing requests
2024-03-02T16:42:51.6712581Z   creating a new quantity request
2024-03-02T16:42:51.6713497Z     GIVEN a partner user is permitted to make a request
2024-03-02T16:42:51.6714656Z       Select Input Tests
2024-03-02T16:42:51.6715326Z         WHEN they reach the page
2024-03-02T16:42:52.5256192Z           should show the proper items in the select box
2024-03-02T16:42:52.5257205Z           WHEN they create a request inproperly
2024-03-02T16:42:53.8288210Z             should show the proper items in the select box
2024-03-02T16:42:53.8289269Z       WHEN they create a request with only a comment
2024-03-02T16:42:54.7764087Z         should be created without any issue
2024-03-02T16:42:54.7765062Z       WHEN they create a request properly
2024-03-02T16:42:54.7766373Z         THEN a request records will be created and the partner will be notified via flash message on the dashboard
2024-03-02T16:42:56.9704688Z           AND the partner_user can view the details of the created request in a seperate page
2024-03-02T16:42:56.9705813Z       WHEN they create a request inproperly by not inputting anything
2024-03-02T16:42:57.8561643Z         should show an error message with the instructions
2024-03-02T16:42:57.8562638Z   creating a # individuals request
2024-03-02T16:42:57.8563577Z     GIVEN a partner user is permitted to make a request
2024-03-02T16:42:57.8564685Z       Select Input Tests
2024-03-02T16:42:57.8565555Z         WHEN they reach the page
2024-03-02T16:42:58.6978092Z           should show the proper items in the select box
2024-03-02T16:42:58.6978741Z           WHEN they create a request inproperly
2024-03-02T16:42:59.9989674Z             should show the proper items in the select box
2024-03-02T16:42:59.9990659Z       WHEN they create a request inproperly
2024-03-02T16:43:00.8938808Z         should show an error message with the instructions
2024-03-02T16:43:00.8940195Z       WHEN they create a request properly
2024-03-02T16:43:00.8941645Z         THEN a request records will be created and the partner will be notified via flash message on the dashboard
2024-03-02T16:43:03.0969973Z           AND the partner_user can view the details of the created individuals request in a seperate page
2024-03-02T16:43:03.0971228Z 
2024-03-02T16:43:03.0971549Z Adjustment management
2024-03-02T16:43:03.9127505Z   can filter the #index by user
2024-03-02T16:43:04.7471742Z   can filter the #index by storage location
2024-03-02T16:43:05.2462016Z   should not display inactive storage locations in dropdown
2024-03-02T16:43:05.2462717Z   behaves like Date Range Picker
2024-03-02T16:43:05.2463406Z     when choosing a date range that only includes the previous week
2024-03-02T16:43:06.2113827Z       shows only 1 record
2024-03-02T16:43:06.2115063Z     when choosing 'Last Month'
2024-03-02T16:43:07.1636247Z       shows only 2 of the records
2024-03-02T16:43:07.1637373Z     when choosing 'All Time'
2024-03-02T16:43:08.1431629Z       shows all the records
2024-03-02T16:43:08.1432392Z   With a new adjustment
2024-03-02T16:43:08.6276552Z     should not display inactive storage locations in dropdown
2024-03-02T16:43:08.6277289Z     with a storage location that has inventory
2024-03-02T16:43:10.3220791Z       politely informs the user that they're adjusting way too hard
2024-03-02T16:43:11.4439973Z       can add an inventory adjustment at a storage location
2024-03-02T16:43:12.5890024Z       can subtract an inventory adjustment at a storage location
2024-03-02T16:43:14.4637863Z       politely informs the user if they try to adjust down below zero, even if they use multiple adjustments to do so
2024-03-02T16:43:15.8507432Z       Does not include inactive items in the line item fields
2024-03-02T16:43:15.8508588Z     with a storage location that is bare
2024-03-02T16:43:17.1800029Z       allows you to choose items that do not yet exist
2024-03-02T16:43:17.1800859Z 
2024-03-02T16:43:17.1801477Z User sign-in handling
2024-03-02T16:43:17.1803114Z   when users are invalid
2024-03-02T16:43:17.8699276Z     shows invalid credentials alert
2024-03-02T16:43:17.8701787Z   when users are valid and belong to an organization
2024-03-02T16:43:18.7155280Z     redirects to user's dashboard
2024-03-02T16:43:18.7156184Z   when a partner user logs in
2024-03-02T16:43:19.6128430Z     redirects to the partner page
2024-03-02T16:43:19.6131336Z   when users are valid and don't belong to an organization
2024-03-02T16:43:20.3122990Z     redirects to 403
2024-03-02T16:43:20.3124050Z 
2024-03-02T16:43:20.3124512Z Requests
2024-03-02T16:43:20.3125966Z   #show
2024-03-02T16:43:20.8772466Z     should show the number of items on-hand
2024-03-02T16:43:21.3780036Z     should show the request without a request sender if a partner user is not set
2024-03-02T16:43:21.8919937Z     should show the request with a request sender if a partner user is set
2024-03-02T16:43:21.8921015Z     change status request
2024-03-02T16:43:22.9262903Z       should change to started
2024-03-02T16:43:22.9263749Z       when save the distribution
2024-03-02T16:43:24.1231390Z         should change request to fulfilled
2024-03-02T16:43:24.1232477Z   #index
2024-03-02T16:43:24.6987665Z     lists requests
2024-03-02T16:43:25.4620852Z     can be exported in CSV
2024-03-02T16:43:25.4621709Z     behaves like Date Range Picker
2024-03-02T16:43:25.4622706Z       when choosing 'All Time'
2024-03-02T16:43:26.5422235Z         shows all the records
2024-03-02T16:43:26.5423316Z       when choosing 'Last Month'
2024-03-02T16:43:27.5938870Z         shows only 2 of the records
2024-03-02T16:43:27.5939633Z       when choosing a date range that only includes the previous week
2024-03-02T16:43:28.6013006Z         shows only 1 record
2024-03-02T16:43:28.6013896Z     when filtering on the index page
2024-03-02T16:43:28.6015403Z       when filtering by status
2024-03-02T16:43:29.5184629Z         constrains the list
2024-03-02T16:43:29.5185480Z       when filtering by item
2024-03-02T16:43:30.4356178Z         constrains the list
2024-03-02T16:43:30.4357164Z       with filters cleared
2024-03-02T16:43:31.4713122Z         displays all requests
2024-03-02T16:43:31.4714064Z       when exporting as CSV
2024-03-02T16:43:32.5517182Z         respects the applied filters
2024-03-02T16:43:32.5518086Z       when filtering by partner
2024-03-02T16:43:33.4479693Z         constrains the list
2024-03-02T16:43:33.4480704Z   canceling a request as a bank user
2024-03-02T16:43:33.4481753Z     when a bank user cancels a request
2024-03-02T16:43:34.5001069Z       should set the request as canceled/discarded and contain the reason
2024-03-02T16:43:34.9761493Z 
2024-03-02T16:43:34.9761884Z Failures:
2024-03-02T16:43:34.9762251Z 
2024-03-02T16:43:34.9765498Z   1) Base Item Admin While signed in as an Administrative User with no organization (super admin no org) can view a single Base Item
2024-03-02T16:43:34.9767509Z      Failure/Error: <h3 class="card-title">Size: <%= @base_item.size || "no size provided" %></h3>
2024-03-02T16:43:34.9768674Z 
2024-03-02T16:43:34.9768997Z      ActionView::Template::Error:
2024-03-02T16:43:34.9771385Z        undefined method `size' for #<BaseItem id: 1, name: "Adult Briefs (Large/X-Large)", category: "Diapers - Adult Briefs", created_at: "2024-03-02 08:42:04.565072000 -0800", updated_at: "2024-03-02 08:42:04.565059000 -0800", item_count: 1, partner_key: "adult_lxl">
2024-03-02T16:43:34.9775440Z      # ./app/views/admin/base_items/show.html.erb:33:in `_app_views_admin_base_items_show_html_erb__4529387319756740155_125880'
2024-03-02T16:43:34.9776903Z      # ------------------
2024-03-02T16:43:34.9777777Z      # --- Caused by: ---
2024-03-02T16:43:34.9778407Z      # NoMethodError:
2024-03-02T16:43:34.9781038Z      #   undefined method `size' for #<BaseItem id: 1, name: "Adult Briefs (Large/X-Large)", category: "Diapers - Adult Briefs", created_at: "2024-03-02 08:42:04.565072000 -0800", updated_at: "2024-03-02 08:42:04.565059000 -0800", item_count: 1, partner_key: "adult_lxl">
2024-03-02T16:43:34.9783915Z      #   ./app/views/admin/base_items/show.html.erb:33:in `_app_views_admin_base_items_show_html_erb__4529387319756740155_125880'
2024-03-02T16:43:34.9785032Z 
2024-03-02T16:43:34.9785718Z   2) Base Item Admin While signed in as an Administrative User (super admin) can view a single Base Item
2024-03-02T16:43:34.9787321Z      Failure/Error: <h3 class="card-title">Size: <%= @base_item.size || "no size provided" %></h3>
2024-03-02T16:43:34.9788162Z 
2024-03-02T16:43:34.9788426Z      ActionView::Template::Error:
2024-03-02T16:43:34.9791090Z        undefined method `size' for #<BaseItem id: 1, name: "Adult Briefs (Large/X-Large)", category: "Diapers - Adult Briefs", created_at: "2024-03-02 08:42:04.565072000 -0800", updated_at: "2024-03-02 08:42:04.565059000 -0800", item_count: 1, partner_key: "adult_lxl">
2024-03-02T16:43:34.9793766Z      # ./app/views/admin/base_items/show.html.erb:33:in `_app_views_admin_base_items_show_html_erb__4529387319756740155_125880'
2024-03-02T16:43:34.9795246Z      # ------------------
2024-03-02T16:43:34.9796030Z      # --- Caused by: ---
2024-03-02T16:43:34.9796669Z      # NoMethodError:
2024-03-02T16:43:34.9799167Z      #   undefined method `size' for #<BaseItem id: 1, name: "Adult Briefs (Large/X-Large)", category: "Diapers - Adult Briefs", created_at: "2024-03-02 08:42:04.565072000 -0800", updated_at: "2024-03-02 08:42:04.565059000 -0800", item_count: 1, partner_key: "adult_lxl">
2024-03-02T16:43:34.9802003Z      #   ./app/views/admin/base_items/show.html.erb:33:in `_app_views_admin_base_items_show_html_erb__4529387319756740155_125880'
2024-03-02T16:43:34.9803498Z 
2024-03-02T16:43:34.9804073Z   3) BarcodeItems While signed in GET #show with a global barcode item returns a 404
2024-03-02T16:43:34.9805663Z      Failure/Error: get barcode_item_path(default_params.merge(id: create(:global_barcode_item)))
2024-03-02T16:43:34.9806526Z 
2024-03-02T16:43:34.9806782Z      ActiveModel::MissingAttributeError:
2024-03-02T16:43:34.9807673Z        can't write unknown attribute `barcode_count`
2024-03-02T16:43:34.9809544Z      # ./spec/requests/barcode_items_requests_spec.rb:65:in `block (5 levels) in <top (required)>'
2024-03-02T16:43:34.9810475Z 
2024-03-02T16:43:34.9811037Z   4) BarcodeItems While signed in GET #edit with a global barcode item returns a 404
2024-03-02T16:43:34.9812735Z      Failure/Error: get edit_barcode_item_path(default_params.merge(id: create(:global_barcode_item)))
2024-03-02T16:43:34.9813682Z 
2024-03-02T16:43:34.9814012Z      ActiveModel::MissingAttributeError:
2024-03-02T16:43:34.9814980Z        can't write unknown attribute `barcode_count`
2024-03-02T16:43:34.9816316Z      # ./spec/requests/barcode_items_requests_spec.rb:49:in `block (5 levels) in <top (required)>'
2024-03-02T16:43:34.9817184Z 
2024-03-02T16:43:34.9818071Z   5) BarcodeItems While signed in GET #find via ajax can find a barcode that's universally available
2024-03-02T16:43:34.9819433Z      Failure/Error: let!(:global_barcode) { create(:global_barcode_item) }
2024-03-02T16:43:34.9820339Z 
2024-03-02T16:43:34.9820652Z      ActiveModel::MissingAttributeError:
2024-03-02T16:43:34.9821505Z        can't write unknown attribute `barcode_count`
2024-03-02T16:43:34.9822768Z      # ./spec/requests/barcode_items_requests_spec.rb:72:in `block (4 levels) in <top (required)>'
2024-03-02T16:43:34.9823770Z 
2024-03-02T16:43:34.9824529Z   6) BarcodeItems While signed in GET #find via ajax can find a barcode that is scoped to just this organization
2024-03-02T16:43:34.9826041Z      Failure/Error: let!(:global_barcode) { create(:global_barcode_item) }
2024-03-02T16:43:34.9826899Z 
2024-03-02T16:43:34.9827281Z      ActiveModel::MissingAttributeError:
2024-03-02T16:43:34.9828133Z        can't write unknown attribute `barcode_count`
2024-03-02T16:43:34.9829245Z      # ./spec/requests/barcode_items_requests_spec.rb:72:in `block (4 levels) in <top (required)>'
2024-03-02T16:43:34.9830020Z 
2024-03-02T16:43:34.9830856Z   7) BarcodeItems While signed in GET #find via ajax when it's missing returns a 404
2024-03-02T16:43:34.9832181Z      Failure/Error: let!(:global_barcode) { create(:global_barcode_item) }
2024-03-02T16:43:34.9832874Z 
2024-03-02T16:43:34.9833222Z      ActiveModel::MissingAttributeError:
2024-03-02T16:43:34.9834217Z        can't write unknown attribute `barcode_count`
2024-03-02T16:43:34.9835433Z      # ./spec/requests/barcode_items_requests_spec.rb:72:in `block (4 levels) in <top (required)>'
2024-03-02T16:43:34.9836372Z 
2024-03-02T16:43:34.9837240Z   8) BarcodeItems While signed in DELETE #destroy disallows a non-superadmin to delete a global barcode
2024-03-02T16:43:34.9838698Z      Failure/Error: global_barcode = create(:global_barcode_item)
2024-03-02T16:43:34.9839334Z 
2024-03-02T16:43:34.9839625Z      ActiveModel::MissingAttributeError:
2024-03-02T16:43:34.9840703Z        can't write unknown attribute `barcode_count`
2024-03-02T16:43:34.9841862Z      # ./spec/requests/barcode_items_requests_spec.rb:114:in `block (4 levels) in <top (required)>'
2024-03-02T16:43:34.9842703Z 
2024-03-02T16:43:34.9843187Z Finished in 1 minute 30.64 seconds (files took 8.06 seconds to load)
2024-03-02T16:43:34.9844178Z 179 examples, 8 failures
2024-03-02T16:43:34.9844514Z 
2024-03-02T16:43:34.9844706Z Failed examples:
2024-03-02T16:43:34.9845066Z 
2024-03-02T16:43:34.9846309Z rspec ./spec/system/admin/base_items_system_spec.rb:123 # Base Item Admin While signed in as an Administrative User with no organization (super admin no org) can view a single Base Item
2024-03-02T16:43:34.9849189Z rspec ./spec/system/admin/base_items_system_spec.rb:59 # Base Item Admin While signed in as an Administrative User (super admin) can view a single Base Item
2024-03-02T16:43:34.9851610Z rspec ./spec/requests/barcode_items_requests_spec.rb:64 # BarcodeItems While signed in GET #show with a global barcode item returns a 404
2024-03-02T16:43:34.9853612Z rspec ./spec/requests/barcode_items_requests_spec.rb:48 # BarcodeItems While signed in GET #edit with a global barcode item returns a 404
2024-03-02T16:43:34.9856110Z rspec ./spec/requests/barcode_items_requests_spec.rb:85 # BarcodeItems While signed in GET #find via ajax can find a barcode that's universally available
2024-03-02T16:43:34.9858895Z rspec ./spec/requests/barcode_items_requests_spec.rb:77 # BarcodeItems While signed in GET #find via ajax can find a barcode that is scoped to just this organization
2024-03-02T16:43:34.9861474Z rspec ./spec/requests/barcode_items_requests_spec.rb:94 # BarcodeItems While signed in GET #find via ajax when it's missing returns a 404
2024-03-02T16:43:34.9863913Z rspec ./spec/requests/barcode_items_requests_spec.rb:111 # BarcodeItems While signed in DELETE #destroy disallows a non-superadmin to delete a global barcode
2024-03-02T16:43:34.9865235Z 
2024-03-02T16:43:34.9865453Z Randomized with seed 50602
2024-03-02T16:43:34.9865799Z 
2024-03-02T16:43:35.2816850Z Stopped processing SimpleCov as a previous error not related to SimpleCov has been detected
2024-03-02T16:43:35.2818656Z Coverage report generated for RSpec to /home/runner/work/human-essentials/human-essentials/coverage. 3758 / 6427 LOC (58.47%) covered.
2024-03-02T16:43:35.3944138Z /opt/hostedtoolcache/Ruby/3.2.2/x64/bin/ruby -I/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/lib:/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-support-3.12.1/lib /home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/exe/rspec  --format documentation --format KnapsackPro::Formatters::TimeTracker --default-path spec "spec/system/adjustment_system_spec.rb" "spec/system/sign_in_system_spec.rb" "spec/system/request_system_spec.rb" "spec/system/admin/base_items_system_spec.rb" "spec/system/partners/managing_requests_system_spec.rb" "spec/system/partners/family_requests_system_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:5:2:1:3]" "spec/system/manufacturer_system_spec.rb" "spec/system/account_system_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:2:1:1]" "spec/requests/purchases_requests_spec.rb" "spec/requests/barcode_items_requests_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:6:6:1:1]" "spec/requests/users_requests_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:5:6:1:3]" "spec/system/dashboard_system_spec.rb[1:2:3:4:1:1]" "spec/system/dashboard_system_spec.rb[1:2:4:2:1:1]" "spec/system/dashboard_system_spec.rb[1:2:5:2:1:2]" "spec/system/dashboard_system_spec.rb[1:2:5:8:1:2]" "spec/requests/product_drive_participants_requests_spec.rb" "spec/system/admin/dashboard_system_spec.rb" "spec/requests/partners/requests_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:7:1]" "spec/requests/broadcast_announcements_spec.rb" "spec/requests/admin/questions_spec.rb" "spec/requests/donations_requests_spec.rb" "spec/requests/attachments_requests_spec.rb" failed
2024-03-02T16:43:35.7777678Z Stopped processing SimpleCov as a previous error not related to SimpleCov has been detected
2024-03-02T16:43:35.7780202Z Coverage report generated for RSpec to /home/runner/work/human-essentials/human-essentials/coverage. 38 / 10679 LOC (0.36%) covered.
2024-03-02T16:43:35.8057712Z ##[error]Process completed with exit code 1.
