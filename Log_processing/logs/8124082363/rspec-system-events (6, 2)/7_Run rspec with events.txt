2024-03-02T16:41:29.7523185Z ##[group]Run RUBYOPT='-W:no-deprecated -W:no-experimental' bin/knapsack_pro_rspec
2024-03-02T16:41:29.7524151Z [36;1mRUBYOPT='-W:no-deprecated -W:no-experimental' bin/knapsack_pro_rspec[0m
2024-03-02T16:41:29.7552917Z shell: /usr/bin/bash -e {0}
2024-03-02T16:41:29.7553307Z env:
2024-03-02T16:41:29.7553650Z   POSTGRES_HOST: localhost
2024-03-02T16:41:29.7554115Z   DATABASE_HOST: localhost
2024-03-02T16:41:29.7554490Z   PG_USERNAME: postgres
2024-03-02T16:41:29.7554958Z   PG_PASSWORD: password
2024-03-02T16:41:29.7555326Z   POSTGRES_HOST_AUTH_METHOD: trust
2024-03-02T16:41:29.7555738Z   POSTGRES_PORT: 5432
2024-03-02T16:41:29.7556183Z   PGHOST: localhost
2024-03-02T16:41:29.7556533Z   PGUSER: postgres
2024-03-02T16:41:29.7556890Z   RAILS_ENV: test
2024-03-02T16:41:29.7557598Z   KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC: ***
2024-03-02T16:41:29.7558074Z   KNAPSACK_PRO_CI_NODE_TOTAL: 6
2024-03-02T16:41:29.7558459Z   KNAPSACK_PRO_CI_NODE_INDEX: 2
2024-03-02T16:41:29.7558990Z   KNAPSACK_PRO_RSPEC_SPLIT_BY_TEST_EXAMPLES: true
2024-03-02T16:41:29.7559593Z   KNAPSACK_PRO_LOG_LEVEL: info
2024-03-02T16:41:29.7560289Z   KNAPSACK_PRO_TEST_FILE_PATTERN: {spec/system/**{,/*/**}/*_spec.rb,spec/requests/**{,/*/**}/*_spec.rb}
2024-03-02T16:41:29.7560948Z   EVENTS_READ: true
2024-03-02T16:41:29.7561290Z ##[endgroup]
2024-03-02T16:41:35.9823260Z I, [2024-03-02T16:41:35.981808 #2327]  INFO -- : [knapsack_pro] Generating RSpec test examples JSON report for slow test files to prepare it to be split by test examples (by individual test cases). Thanks to that, a single slow test file can be split across parallel CI nodes. Analyzing 1 slow test files.
2024-03-02T16:41:44.9428643Z Coverage report generated for RSpec to /home/runner/work/human-essentials/human-essentials/coverage. 2526 / 6642 LOC (38.03%) covered.
2024-03-02T16:41:49.2755347Z /opt/hostedtoolcache/Ruby/3.2.2/x64/bin/ruby -I/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/lib:/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-support-3.12.1/lib /home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/exe/rspec  --format documentation --format KnapsackPro::Formatters::TimeTracker --default-path spec "spec/system/donation_system_spec.rb" "spec/system/item_system_spec.rb" "spec/system/transfer_system_spec.rb" "spec/system/profile_served_area_system_spec.rb" "spec/system/product_drive_system_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:4:9:1:1]" "spec/system/dashboard_system_spec.rb[1:2:7:3:1:1]" "spec/system/distributions_by_county_system_spec.rb" "spec/requests/distributions_requests_spec.rb" "spec/system/log_in_system_spec.rb" "spec/requests/storage_locations_requests_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:5:5:1:3]" "spec/system/dashboard_system_spec.rb[1:2:7:9:1:1]" "spec/system/dashboard_system_spec.rb[1:2:7:8:1:1]" "spec/system/dashboard_system_spec.rb[1:2:5:5:1:1]" "spec/system/dashboard_system_spec.rb[1:2:5:6:1:2]" "spec/system/dashboard_system_spec.rb[1:2:6:3:1:1]" "spec/system/dashboard_system_spec.rb[1:2:5:3:1:2]" "spec/system/dashboard_system_spec.rb[1:2:3:8:1:1]" "spec/system/dashboard_system_spec.rb[1:2:5:5:1:2]" "spec/requests/admin/barcode_items_requests_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:4:1]" "spec/requests/profiles_requests_spec.rb" "spec/requests/admin/broadcast_announcements_spec.rb" "spec/requests/partners/family_requests_spec.rb" "spec/requests/partners/children_requests_spec.rb" "spec/requests/users/omniauth_callbacks_requests_spec.rb"
2024-03-02T16:41:57.6130362Z Run options: include {:ids=>{"./spec/system/dashboard_system_spec.rb"=>["1:2:4:9:1:1", "1:2:7:3:1:1", "1:2:5:5:1:3", "1:2:7:9:1:1", "1:2:7:8:1:1", "1:2:5:5:1:1", "1:2:5:6:1:2", "1:2:6:3:1:1", "1:2:5:3:1:2", "1:2:3:8:1:1", "1:2:5:5:1:2", "1:2:4:1"]}}
2024-03-02T16:41:57.6158678Z 
2024-03-02T16:41:57.6159156Z Randomized with seed 32043
2024-03-02T16:41:58.6275899Z 
2024-03-02T16:41:58.6277049Z Partners profile served area behaviour when accessed as bank
2024-03-02T16:41:58.6278145Z   changing the client share
2024-03-02T16:42:09.7927613Z     handles deletion properly
2024-03-02T16:42:10.8716545Z     handles an invalid total client share properly
2024-03-02T16:42:11.6116538Z     handles addition properly
2024-03-02T16:42:12.7674070Z     handles a changed but correct total client share properly
2024-03-02T16:42:12.7675025Z 
2024-03-02T16:42:12.7675258Z Transfer management
2024-03-02T16:42:13.6289437Z   Does not include inactive items in the line item fields
2024-03-02T16:42:15.1028202Z   can transfer an inventory from a storage location to another as a user
2024-03-02T16:42:16.7415456Z   can delete a transfer to undo the inventory count changes
2024-03-02T16:42:17.1993355Z   should not include inactive storage locations in dropdowns when creating a new transfer
2024-03-02T16:42:18.7042706Z   shows a error when deleting a transfer that causes an insufficient inventory counts
2024-03-02T16:42:18.7043934Z   when there's insufficient inventory at the origin to cover the move
2024-03-02T16:42:19.8740564Z     User can transfer an inventory from a storage location to another
2024-03-02T16:42:19.8741534Z   when viewing the index page
2024-03-02T16:42:21.1510882Z     can filter the #index by storage location both from and to as a user
2024-03-02T16:42:21.1512100Z     behaves like Date Range Picker
2024-03-02T16:42:21.1513276Z       when choosing 'All Time'
2024-03-02T16:42:22.1898157Z         shows all the records
2024-03-02T16:42:22.1899279Z       when choosing 'Last Month'
2024-03-02T16:42:23.1204295Z         shows only 2 of the records
2024-03-02T16:42:23.1205210Z       when choosing a date range that only includes the previous week
2024-03-02T16:42:24.0486584Z         shows only 1 record
2024-03-02T16:42:24.0487995Z 
2024-03-02T16:42:24.0488265Z Authentication
2024-03-02T16:42:24.0490270Z   Deactivated user
2024-03-02T16:42:24.7213113Z     should not allow the user to log in
2024-03-02T16:42:24.7214031Z   Success
2024-03-02T16:42:25.3970561Z     should show dashboard upon signin
2024-03-02T16:42:25.3971549Z   Showing the modal warning in staging
2024-03-02T16:42:25.3972417Z     when accessing /users/password/new not in the staging environment
2024-03-02T16:42:25.8121371Z       should not render the modal
2024-03-02T16:42:25.8122207Z     when accessing /users/password/new in the staging environment
2024-03-02T16:42:26.2226260Z       should render the modal
2024-03-02T16:42:26.2227095Z     when accessing /users/sign_in in the staging environment
2024-03-02T16:42:26.6492905Z       should render the modal
2024-03-02T16:42:26.6497583Z     when accessing /users/sign_in not in the staging environment
2024-03-02T16:42:27.0577985Z       should not render the modal
2024-03-02T16:42:27.0578941Z 
2024-03-02T16:42:27.0579294Z Product Drives
2024-03-02T16:42:27.0581404Z   when showing a Product Drive with no end date
2024-03-02T16:42:27.5329953Z     must be able to show the product drive
2024-03-02T16:42:27.5330797Z   when creating a normal product drive
2024-03-02T16:42:28.3343104Z     must create a new product drive
2024-03-02T16:42:29.1284568Z     must have the success message
2024-03-02T16:42:29.9185103Z     must have correct attributes
2024-03-02T16:42:29.9185975Z   When visiting the index page without parameters
2024-03-02T16:42:30.4092967Z     shows the expected product drives
2024-03-02T16:42:30.8872775Z     shows only one non-virtual product drive
2024-03-02T16:42:31.3632725Z     shows only one virtual product drive
2024-03-02T16:42:31.8451061Z     shows in descending order of start date
2024-03-02T16:42:32.3376018Z     Shows the expected filters with the expected values
2024-03-02T16:42:32.3377165Z   when creating a Virtual Product Drive
2024-03-02T16:42:33.2510749Z     must have correct attributes
2024-03-02T16:42:34.1733319Z     must have the success message
2024-03-02T16:42:35.0661435Z     must create a new virtual Product Drive
2024-03-02T16:42:35.0662247Z 
2024-03-02T16:42:35.0662479Z /partners/family
2024-03-02T16:42:35.0663430Z   GET #index
2024-03-02T16:42:35.1372207Z     should export CSV
2024-03-02T16:42:35.1985933Z     should render without any issues and present all families
2024-03-02T16:42:35.2550470Z     should render without any issues and display unarchived families by default
2024-03-02T16:42:35.2551217Z 
2024-03-02T16:42:35.2551427Z Donations
2024-03-02T16:42:35.2553257Z   When signed in as a normal user
2024-03-02T16:42:35.2554527Z     When creating a new donation
2024-03-02T16:42:35.7576804Z       should not display inactive storage locations in dropdown
2024-03-02T16:42:35.7577745Z       Via manual entry
2024-03-02T16:42:36.6338216Z         Allows User to create a donation with a Miscellaneous source
2024-03-02T16:42:37.5491718Z         Allows User to create a donation for a ProductDrive Participant source
2024-03-02T16:42:38.4689840Z         Allows User to create a donation for a Manufacturer source
2024-03-02T16:42:39.2845217Z         Ensures Barcode Entry fields have unique ids
2024-03-02T16:42:40.1810037Z         Allows User to create a donation for Purchased Supplies
2024-03-02T16:42:40.9371711Z         Allows User to create a Product Drive Participant from donation
2024-03-02T16:42:41.7970376Z         Does not include inactive items in the line item fields
2024-03-02T16:42:42.5534920Z         Allows User to create a Product Drive from donation
2024-03-02T16:42:43.4691225Z         Allows User to create a donation for a Donation Site source
2024-03-02T16:42:44.3384664Z         Verifies unusually large donation quantities
2024-03-02T16:42:45.2670817Z         Strips extraneous data if the user adds both Donation Site and Product Drive Participant
2024-03-02T16:42:46.2451379Z         Repopulates items dropdown even if initial submission doesn't validate
2024-03-02T16:42:46.9853905Z         Allows User to create a Manufacturer from donation
2024-03-02T16:42:47.8425900Z         Displays nested errors
2024-03-02T16:42:48.7480061Z         User can create a donation using dollars decimal amount for its money raised
2024-03-02T16:42:49.6349112Z         Allows donations to be created IN THE PAST
2024-03-02T16:42:50.6855205Z         Accepts and combines multiple line items for the same item type
2024-03-02T16:42:50.6855863Z       Via barcode entry
2024-03-02T16:42:51.6466726Z         Allows User to add items that do not yet have a barcode
2024-03-02T16:42:52.5522116Z         Updates the line item when the same barcode is scanned twice
2024-03-02T16:42:53.3497816Z         Allows User to add items by barcode
2024-03-02T16:42:53.3498744Z         When the barcode is a global barcode
2024-03-02T16:42:54.0536082Z           Adds the oldest item it can find for the global barcode (FAILED - 1)
2024-03-02T16:42:54.0537936Z   [0;33mHTML screenshot: /home/runner/work/human-essentials/human-essentials/tmp/screenshots/screenshot_Adds-the-oldest-item-it-can-find-for-the-global-barcode_2024-03-02-08-42-53.910.html[0m
2024-03-02T16:42:54.0540901Z   [0;33mImage screenshot: /home/runner/work/human-essentials/human-essentials/tmp/screenshots/screenshot_Adds-the-oldest-item-it-can-find-for-the-global-barcode_2024-03-02-08-42-53.910.png[0m
2024-03-02T16:42:54.0543109Z     When filtering on the index page
2024-03-02T16:42:55.1762862Z       Filters by multiple attributes
2024-03-02T16:42:55.9913972Z       Filters by product drives
2024-03-02T16:42:56.8235716Z       Filters by the source
2024-03-02T16:42:57.6407160Z       Filters by product drive participant
2024-03-02T16:42:58.4595581Z       Filters by donation site
2024-03-02T16:42:59.2430101Z       Filters by storage location
2024-03-02T16:43:00.0671265Z       Filter by product drive participant sticks around
2024-03-02T16:43:00.8901514Z       Filters by manufacturer
2024-03-02T16:43:00.8903238Z       behaves like Date Range Picker
2024-03-02T16:43:00.8904408Z         when choosing 'Last Month'
2024-03-02T16:43:01.8301941Z           shows only 2 of the records
2024-03-02T16:43:01.8302866Z         when choosing a date range that only includes the previous week
2024-03-02T16:43:02.7455924Z           shows only 1 record
2024-03-02T16:43:02.7457497Z         when choosing 'All Time'
2024-03-02T16:43:03.6850077Z           shows all the records
2024-03-02T16:43:03.6851112Z     When donation items have value
2024-03-02T16:43:04.3805223Z       Displays the total value on the index page
2024-03-02T16:43:05.2961172Z       Displays the total value on the show page
2024-03-02T16:43:06.1629930Z       Displays the individual value on the index page
2024-03-02T16:43:06.1632742Z     When visiting the index page
2024-03-02T16:43:06.9005658Z       should not display inactive storage locations in dropdown
2024-03-02T16:43:07.6840602Z       Allows User to click to the new donation form
2024-03-02T16:43:08.1934835Z       Displays Total quantity on the index page
2024-03-02T16:43:08.9765930Z       doesn't die when an inactive item is in a donation
2024-03-02T16:43:08.9766739Z     When editing an existing donation
2024-03-02T16:43:10.4737424Z       Allows the user to edit a donation
2024-03-02T16:43:12.2995442Z       Does not default a selection if item lookup fails
2024-03-02T16:43:12.2996403Z     When viewing an existing donation
2024-03-02T16:43:12.8083335Z       displays donation comment
2024-03-02T16:43:13.3012507Z       does not allow deletion of a donation
2024-03-02T16:43:13.3013561Z       when there is no comment defined
2024-03-02T16:43:14.1041950Z         displays the None provided as the comment
2024-03-02T16:43:14.1043091Z   while signed in as an organization admin
2024-03-02T16:43:14.1044024Z     When viewing an existing donation
2024-03-02T16:43:14.9362994Z       allows deletion of a donation
2024-03-02T16:43:14.9364024Z 
2024-03-02T16:43:14.9364329Z Item management
2024-03-02T16:43:15.8128874Z   can create a new item with dollars decimal amount for value field
2024-03-02T16:43:16.7188776Z   can include inactive items in the results
2024-03-02T16:43:17.6376903Z   can update an existing item as a user
2024-03-02T16:43:18.4473785Z   can filter the #index by base item as a user
2024-03-02T16:43:19.6089647Z   can make the item invisible to partners
2024-03-02T16:43:20.4680897Z   can create a new item as a user
2024-03-02T16:43:21.2128670Z   can update an existing item with empty attributes as a user
2024-03-02T16:43:21.9611279Z   can create a new item with empty attributes as a user
2024-03-02T16:43:21.9611933Z   restoring items
2024-03-02T16:43:23.3397806Z     allows a user to restore the item
2024-03-02T16:43:23.3398582Z   Item Category Management
2024-03-02T16:43:23.3399534Z     creating a new item category and associating to a new item
2024-03-02T16:43:23.3400460Z       and associating to a new item
2024-03-02T16:43:25.2670773Z         should create the new item with the correct category
2024-03-02T16:43:25.2671779Z       and associating to a existing item
2024-03-02T16:43:27.5423300Z         should associate the item with the category
2024-03-02T16:43:27.5424514Z   destroying items
2024-03-02T16:43:27.5425726Z     when an item has history
2024-03-02T16:43:28.6360940Z       can be soft-deleted (deactivated) by the user
2024-03-02T16:43:28.6361560Z     when an item does not have history
2024-03-02T16:43:29.6072059Z       can be fully deleted by the user
2024-03-02T16:43:29.6072891Z   Item Table Tabs >
2024-03-02T16:43:32.3974876Z     should display an Item Inventory table
2024-03-02T16:43:33.2351382Z     should display items in separate tabs
2024-03-02T16:43:33.2352195Z 
2024-03-02T16:43:33.2354971Z Users - Omniauth Callbacks
2024-03-02T16:43:33.2355688Z   GET #google_oauth2
2024-03-02T16:43:33.2356444Z     without a valid user
2024-03-02T16:43:33.2472194Z       should redirect to new registration URL
2024-03-02T16:43:33.2473072Z     with a valid user
2024-03-02T16:43:33.2699433Z       redirects correctly
2024-03-02T16:43:33.2700937Z 
2024-03-02T16:43:33.2701303Z BroadcastAnnouncements
2024-03-02T16:43:33.2703773Z   When logged in as an organization_admin
2024-03-02T16:43:33.2704754Z     POST /create
2024-03-02T16:43:33.2854556Z       redirects
2024-03-02T16:43:33.2855337Z     GET /new
2024-03-02T16:43:33.3001850Z       redirects
2024-03-02T16:43:33.3002425Z   GET /new
2024-03-02T16:43:33.3381342Z     renders a successful response
2024-03-02T16:43:33.3382157Z   PATCH /update
2024-03-02T16:43:33.3382957Z     with invalid parameters
2024-03-02T16:43:33.3749013Z       does not render a successful response
2024-03-02T16:43:33.3749883Z     with valid parameters
2024-03-02T16:43:33.3935006Z       updates the requested announcement and redirects
2024-03-02T16:43:33.3935909Z   DELETE /destroy
2024-03-02T16:43:33.4107650Z     destroys the requested announcement then redirects
2024-03-02T16:43:33.4108587Z   POST /create
2024-03-02T16:43:33.4109196Z     with valid parameters
2024-03-02T16:43:33.4262303Z       creates a new BroadcastAnnouncement then redirects
2024-03-02T16:43:33.4263291Z     with invalid parameters
2024-03-02T16:43:33.4579805Z       does not render a successful response
2024-03-02T16:43:33.4903170Z       does not create a new BroadcastAnnouncement
2024-03-02T16:43:33.4904116Z   GET /edit
2024-03-02T16:43:33.5225487Z     render a successful response
2024-03-02T16:43:33.5226497Z   GET /index
2024-03-02T16:43:33.5565903Z     renders a successful response
2024-03-02T16:43:33.5568395Z 
2024-03-02T16:43:33.5568711Z Profiles
2024-03-02T16:43:33.5569800Z   POST #update
2024-03-02T16:43:33.5570860Z     successful save
2024-03-02T16:43:33.6023634Z       update partner
2024-03-02T16:43:33.6434144Z       redirects to #show
2024-03-02T16:43:33.6434972Z     when updating an existing value to a blank value
2024-03-02T16:43:33.6882409Z       update partner
2024-03-02T16:43:33.7327957Z       should have blank values
2024-03-02T16:43:33.7328622Z   GET #edit
2024-03-02T16:43:33.8184354Z     returns http success
2024-03-02T16:43:33.8184956Z 
2024-03-02T16:43:33.8186432Z /partners/children
2024-03-02T16:43:33.8187112Z   GET #index
2024-03-02T16:43:33.8803841Z     should export CSV
2024-03-02T16:43:33.9386493Z     should render without any issues
2024-03-02T16:43:33.9387233Z 
2024-03-02T16:43:33.9387508Z Distributions by County
2024-03-02T16:43:33.9390502Z   handles time ranges properly
2024-03-02T16:43:35.6571128Z     works for this year
2024-03-02T16:43:37.3776815Z     works for all time
2024-03-02T16:43:37.3777649Z 
2024-03-02T16:43:37.3778048Z Admin::BarcodeItemsController
2024-03-02T16:43:37.3779387Z   while signed in as a super admin
2024-03-02T16:43:37.3780730Z     GET #index
2024-03-02T16:43:37.4186029Z       returns success
2024-03-02T16:43:37.4187073Z     PATCH #update
2024-03-02T16:43:37.4187823Z       with invalid params
2024-03-02T16:43:37.4265014Z         returns a successful response (to show form with errors) (FAILED - 2)
2024-03-02T16:43:37.4265943Z       with valid params
2024-03-02T16:43:37.4338066Z         updates the barcode_item attributes accordingly (FAILED - 3)
2024-03-02T16:43:37.4409817Z         redirects to admin_barcode_items_path (FAILED - 4)
2024-03-02T16:43:37.4410734Z     DELETE #destroy
2024-03-02T16:43:37.4481495Z       allows deletion of a global barcode (FAILED - 5)
2024-03-02T16:43:37.6483248Z       allows deletion of barcode in another org
2024-03-02T16:43:37.6484190Z     GET #new
2024-03-02T16:43:37.6832301Z       returns success
2024-03-02T16:43:37.6833219Z     POST #create
2024-03-02T16:43:37.6833797Z       with invalid params
2024-03-02T16:43:37.7221695Z         returns a successful response (to show form with errors)
2024-03-02T16:43:37.7222866Z       with valid params
2024-03-02T16:43:37.7395244Z         creates a barcode item (FAILED - 6)
2024-03-02T16:43:37.7552404Z         redirects to admin_barcode_items_path (FAILED - 7)
2024-03-02T16:43:37.7554945Z 
2024-03-02T16:43:37.7555316Z StorageLocations
2024-03-02T16:43:37.7556439Z   While signed in
2024-03-02T16:43:37.7558343Z     GET #new
2024-03-02T16:43:38.3134929Z       returns http success
2024-03-02T16:43:38.3135539Z     GET #show
2024-03-02T16:43:38.3136018Z       html
2024-03-02T16:43:38.3883908Z         should return a correct response
2024-03-02T16:43:38.3884901Z         with version date set
2024-03-02T16:43:38.3885557Z           with no version found
2024-03-02T16:43:38.4715088Z             should show N/A
2024-03-02T16:43:38.4716552Z           with a version found
2024-03-02T16:43:38.5553142Z             should show the version specified
2024-03-02T16:43:38.5553954Z       csv
2024-03-02T16:43:38.6072106Z         should be successful
2024-03-02T16:43:38.6072933Z     GET #edit
2024-03-02T16:43:38.6419130Z       returns http success
2024-03-02T16:43:38.6419988Z     PUT #reactivate
2024-03-02T16:43:38.6591846Z       undiscards
2024-03-02T16:43:38.6592455Z     GET #inventory
2024-03-02T16:43:38.6593470Z       when also including inactive items
2024-03-02T16:43:38.7254552Z         returns a collection that also includes items that have been deactivated
2024-03-02T16:43:38.7255437Z       without any overrides
2024-03-02T16:43:38.7779899Z         returns a collection that only includes items at the storage location
2024-03-02T16:43:38.7781057Z       when also including omitted items
2024-03-02T16:43:38.8264990Z         contains a collection of ducktyped entries that respond the same
2024-03-02T16:43:38.8762458Z         returns a collection that also includes all items, but with zeroed quantities
2024-03-02T16:43:38.8763586Z     Looking at a different organization
2024-03-02T16:43:39.0541932Z       redirects the user to the sign-in page for CRUD actions
2024-03-02T16:43:39.0542979Z     POST #import_csv
2024-03-02T16:43:39.0543599Z       csv file with wrong headers
2024-03-02T16:43:39.0685191Z         presents a flash error message
2024-03-02T16:43:39.0813096Z         redirects
2024-03-02T16:43:39.0813757Z       without a csv file
2024-03-02T16:43:39.0931978Z         presents a flash error message
2024-03-02T16:43:39.1046996Z         redirects to :index
2024-03-02T16:43:39.1047879Z       with a csv file
2024-03-02T16:43:39.1195620Z         redirects
2024-03-02T16:43:39.1341015Z         presents a flash notice message
2024-03-02T16:43:39.1378458Z         invokes .import_csv
2024-03-02T16:43:39.1379108Z     GET #destroy
2024-03-02T16:43:39.1649111Z       redirects to #index
2024-03-02T16:43:39.1650111Z     GET #index
2024-03-02T16:43:39.1650724Z       csv
2024-03-02T16:43:39.1841476Z         succeeds
2024-03-02T16:43:39.2822885Z         includes headers followed by alphabetized item names
2024-03-02T16:43:39.2824085Z       html
2024-03-02T16:43:39.3180648Z         succeeds
2024-03-02T16:43:39.3181361Z         with inactive locations
2024-03-02T16:43:39.3541533Z           does not includes the inactive location
2024-03-02T16:43:39.3542424Z           with include_inactive_locations
2024-03-02T16:43:39.3900157Z             includes the inactive location
2024-03-02T16:43:39.3901576Z     PUT #deactivate
2024-03-02T16:43:39.4094345Z       discards
2024-03-02T16:43:39.4094938Z       with inventory
2024-03-02T16:43:39.4564816Z         does not discard
2024-03-02T16:43:39.4565946Z   While not signed in
2024-03-02T16:43:39.4639167Z     redirects the user to the sign-in page for CRUD actions
2024-03-02T16:43:39.4639968Z 
2024-03-02T16:43:39.4640411Z Distributions
2024-03-02T16:43:39.4641637Z   While signed in
2024-03-02T16:43:39.4644001Z     GET #reclaim
2024-03-02T16:43:39.5474221Z       returns http success
2024-03-02T16:43:39.5474975Z     GET #schedule
2024-03-02T16:43:39.5802334Z       returns http success
2024-03-02T16:43:39.5803091Z     POST #update
2024-03-02T16:43:39.6565592Z       returns a 200
2024-03-02T16:43:39.6566318Z       when changing storage location
2024-03-02T16:43:39.8536257Z         updates storage quantity correctly
2024-03-02T16:43:39.8588504Z         rollsback updates if quantity would go below 0
2024-03-02T16:43:39.8590152Z       mail follow up
2024-03-02T16:43:39.9260234Z         does not send an e-mail
2024-03-02T16:43:39.9261242Z         partner reminder sending switched off
2024-03-02T16:43:39.9950146Z           does not send the e-mail
2024-03-02T16:43:39.9950949Z         sending
2024-03-02T16:43:40.0760266Z           does send an e-mail
2024-03-02T16:43:40.0761031Z     GET #print
2024-03-02T16:43:40.1168011Z       returns http success
2024-03-02T16:43:40.1169014Z       with non-UTF8 characters
2024-03-02T16:43:40.1581729Z         returns http success
2024-03-02T16:43:40.1582484Z     GET #itemized_breakdown
2024-03-02T16:43:40.1741325Z       returns http success
2024-03-02T16:43:40.1742275Z     PATCH #picked_up
2024-03-02T16:43:40.1742955Z       when the distribution is successfully updated
2024-03-02T16:43:40.2164900Z         updates the state to 'complete'
2024-03-02T16:43:40.2566081Z         redirects the user back to the distributions page
2024-03-02T16:43:40.2567112Z     GET #edit
2024-03-02T16:43:40.3565940Z       should show a warning if there is an inteverning audit
2024-03-02T16:43:40.4520472Z       should not show a warning if the audit is for another location
2024-03-02T16:43:40.5237100Z       should show the distribution
2024-03-02T16:43:40.5238185Z     GET #index
2024-03-02T16:43:40.5569376Z       returns http success
2024-03-02T16:43:40.7584033Z       sums distribution totals accurately
2024-03-02T16:43:40.7588231Z     POST #create
2024-03-02T16:43:40.8175921Z       renders #new again on failure, with notice
2024-03-02T16:43:40.8738298Z       redirects to #show on success
2024-03-02T16:43:40.8738962Z     GET #new
2024-03-02T16:43:40.9642776Z       returns http success
2024-03-02T16:43:40.9643510Z       with partner default
2024-03-02T16:43:41.1337820Z         selects partner default
2024-03-02T16:43:41.1338842Z       with org default but no partner default
2024-03-02T16:43:41.2547661Z         selects org default
2024-03-02T16:43:41.2548739Z     Looking at a different organization
2024-03-02T16:43:41.4515138Z       redirects the user to the sign-in page for CRUD actions
2024-03-02T16:43:41.4515782Z     GET #show
2024-03-02T16:43:41.5065227Z       returns http success
2024-03-02T16:43:41.6085267Z       sums distribution totals accurately
2024-03-02T16:43:41.6086215Z     GET #pickup_day
2024-03-02T16:43:41.7095536Z       correctly sums the item package counts from distributions
2024-03-02T16:43:41.7390928Z       returns http success
2024-03-02T16:43:41.8467546Z       correctly sums the item counts from distributions
2024-03-02T16:43:41.8468571Z   While not signed in
2024-03-02T16:43:41.8763890Z     redirects the user to the sign-in page for CRUD actions
2024-03-02T16:43:41.8764860Z     GET #calendar
2024-03-02T16:43:41.8765457Z       with a correct hash id
2024-03-02T16:43:41.8856872Z         should render the calendar
2024-03-02T16:43:41.8857748Z       without a correct hash id
2024-03-02T16:43:41.8928329Z         should error unauthorized
2024-03-02T16:43:41.8932796Z 
2024-03-02T16:43:41.8933311Z Dashboard
2024-03-02T16:43:41.8934754Z   With an existing essentials bank
2024-03-02T16:43:41.8936913Z     Purchases
2024-03-02T16:43:42.8177899Z       has a link to create a new purchase
2024-03-02T16:43:42.8181021Z       given 1 Purchase on 2022-03-01  (unless 'All Time'), 0 during 2022-03-02..2023-12-23, and 1 on 2023-12-24
2024-03-02T16:43:42.8182471Z         filtering to '' (March 2, 2022 - December 23, 2023)
2024-03-02T16:43:46.1934541Z           shows correct 0 Recent Purchase link(s)
2024-03-02T16:43:46.1936987Z     Manufacturer Donations
2024-03-02T16:43:46.1940568Z       given 1 Manufacturer donating on 2024-02-29  (unless 'All Time'), 9 during 2024-03-01..2024-03-01, and 1 on 2024-03-02
2024-03-02T16:43:46.1942251Z         filtering to 'Yesterday'
2024-03-02T16:43:48.8345964Z           shows the correct total and 10 Top Manufacturer Donation link(s)
2024-03-02T16:43:48.8348960Z     Donations
2024-03-02T16:43:48.8352932Z       given 1 Donation on 2024-01-31 (only if a valid date), 0 during 2024-02-01..2024-02-29, and 1 on 2024-03-01
2024-03-02T16:43:48.8354201Z         filtering to 'Last Month'
2024-03-02T16:43:52.1721823Z           shows the correct total and 0 Recent Donation link(s)
2024-03-02T16:43:52.1723063Z     Product Drives
2024-03-02T16:43:52.1726333Z       given 1 Product Drive Donation on 2024-02-29 (unless 'All Time'), 1 during 2024-03-01..2024-03-01, and 1 on 2024-03-02
2024-03-02T16:43:52.1727252Z         filtering to 'Yesterday'
2024-03-02T16:43:53.5683518Z           shows the correct total money raised
2024-03-02T16:43:53.5685681Z       given 1 Product Drive Donation on 2024-02-01 (unless 'All Time'), 0 during 2024-02-02..2024-03-02, and 1 on 2024-03-03
2024-03-02T16:43:53.5686979Z         filtering to 'Last 30 Days'
2024-03-02T16:43:54.9351758Z           shows the correct total money raised
2024-03-02T16:43:58.2798505Z           shows 0 Recent Donation link(s)
2024-03-02T16:43:59.6392558Z           shows the correct total donations
2024-03-02T16:43:59.6394416Z       given 1 Product Drive Donation on 2024-02-29 (unless 'All Time'), 2 during 2024-03-01..2024-03-31, and 1 on 2024-04-01
2024-03-02T16:43:59.6395487Z         filtering to 'This Month'
2024-03-02T16:44:01.0722383Z           shows the correct total money raised
2024-03-02T16:44:01.0723203Z     Distributions
2024-03-02T16:44:01.0725914Z       given 1 Distribution on 1999-12-31  (unless 'All Time'), 4 during 2000-01-01..2024-03-02, and 1 on 2024-03-03
2024-03-02T16:44:01.0726975Z         filtering to 'All Time'
2024-03-02T16:44:02.5193600Z           shows the correct total and 3 Recent Distribution link(s)
2024-03-02T16:44:02.5195737Z       given 1 Distribution on 2023-12-31  (unless 'All Time'), 3 during 2024-01-01..2024-12-31, and 1 on 2025-01-01
2024-03-02T16:44:02.5196875Z         filtering to 'This Year'
2024-03-02T16:44:03.9516394Z           shows the correct total and 3 Recent Distribution link(s)
2024-03-02T16:44:03.9518281Z       given 1 Distribution on 2024-02-29  (unless 'All Time'), 4 during 2024-03-01..2024-03-01, and 1 on 2024-03-02
2024-03-02T16:44:03.9519827Z         filtering to 'Yesterday'
2024-03-02T16:44:05.4253788Z           shows the correct total and 3 Recent Distribution link(s)
2024-03-02T16:44:05.9427268Z 
2024-03-02T16:44:05.9428073Z Failures:
2024-03-02T16:44:05.9428507Z 
2024-03-02T16:44:05.9430288Z   1) Donations When signed in as a normal user When creating a new donation Via barcode entry When the barcode is a global barcode Adds the oldest item it can find for the global barcode
2024-03-02T16:44:05.9434185Z      Failure/Error: @global_barcode = create(:global_barcode_item, barcodeable: base_item)
2024-03-02T16:44:05.9435161Z 
2024-03-02T16:44:05.9435614Z      ActiveModel::MissingAttributeError:
2024-03-02T16:44:05.9436886Z        can't write unknown attribute `barcode_count`
2024-03-02T16:44:05.9437468Z 
2024-03-02T16:44:05.9440355Z      [Screenshot Image]: /home/runner/work/human-essentials/human-essentials/tmp/capybara/failures_r_spec_example_groups_donations_when_signed_in_as_a_normal_user_when_creating_a_new_donation_via_barcode_entry_when_the_barcode_is_a_global_barcode_adds_the_oldest_item_it_can_find_for_the_global_barc_983.png
2024-03-02T16:44:05.9444218Z 
2024-03-02T16:44:05.9444231Z 
2024-03-02T16:44:05.9444911Z      # ./spec/system/donation_system_spec.rb:487:in `block (6 levels) in <top (required)>'
2024-03-02T16:44:05.9447523Z 
2024-03-02T16:44:05.9448729Z   2) Admin::BarcodeItemsController while signed in as a super admin PATCH #update with invalid params returns a successful response (to show form with errors)
2024-03-02T16:44:05.9450563Z      Failure/Error: let!(:barcode_item) { create(:global_barcode_item) }
2024-03-02T16:44:05.9451288Z 
2024-03-02T16:44:05.9451642Z      ActiveModel::MissingAttributeError:
2024-03-02T16:44:05.9452565Z        can't write unknown attribute `barcode_count`
2024-03-02T16:44:05.9453921Z      # ./spec/requests/admin/barcode_items_requests_spec.rb:58:in `block (4 levels) in <top (required)>'
2024-03-02T16:44:05.9455158Z 
2024-03-02T16:44:05.9456229Z   3) Admin::BarcodeItemsController while signed in as a super admin PATCH #update with valid params updates the barcode_item attributes accordingly
2024-03-02T16:44:05.9457865Z      Failure/Error: let!(:barcode_item) { create(:global_barcode_item) }
2024-03-02T16:44:05.9458673Z 
2024-03-02T16:44:05.9458926Z      ActiveModel::MissingAttributeError:
2024-03-02T16:44:05.9459801Z        can't write unknown attribute `barcode_count`
2024-03-02T16:44:05.9461348Z      # ./spec/requests/admin/barcode_items_requests_spec.rb:58:in `block (4 levels) in <top (required)>'
2024-03-02T16:44:05.9462629Z 
2024-03-02T16:44:05.9463572Z   4) Admin::BarcodeItemsController while signed in as a super admin PATCH #update with valid params redirects to admin_barcode_items_path
2024-03-02T16:44:05.9465196Z      Failure/Error: let!(:barcode_item) { create(:global_barcode_item) }
2024-03-02T16:44:05.9465881Z 
2024-03-02T16:44:05.9466212Z      ActiveModel::MissingAttributeError:
2024-03-02T16:44:05.9467087Z        can't write unknown attribute `barcode_count`
2024-03-02T16:44:05.9468301Z      # ./spec/requests/admin/barcode_items_requests_spec.rb:58:in `block (4 levels) in <top (required)>'
2024-03-02T16:44:05.9469179Z 
2024-03-02T16:44:05.9470107Z   5) Admin::BarcodeItemsController while signed in as a super admin DELETE #destroy allows deletion of a global barcode
2024-03-02T16:44:05.9471554Z      Failure/Error: other_barcode = create(:global_barcode_item)
2024-03-02T16:44:05.9472146Z 
2024-03-02T16:44:05.9472434Z      ActiveModel::MissingAttributeError:
2024-03-02T16:44:05.9473333Z        can't write unknown attribute `barcode_count`
2024-03-02T16:44:05.9474567Z      # ./spec/requests/admin/barcode_items_requests_spec.rb:101:in `block (4 levels) in <top (required)>'
2024-03-02T16:44:05.9475497Z 
2024-03-02T16:44:05.9476313Z   6) Admin::BarcodeItemsController while signed in as a super admin POST #create with valid params creates a barcode item
2024-03-02T16:44:05.9478171Z      Failure/Error: @barcode_item = BarcodeItem.create(barcode_item_params.merge(barcodeable_type: "BaseItem"))
2024-03-02T16:44:05.9479177Z 
2024-03-02T16:44:05.9479425Z      ActiveModel::MissingAttributeError:
2024-03-02T16:44:05.9480351Z        can't write unknown attribute `barcode_count`
2024-03-02T16:44:05.9481351Z      # ./app/controllers/admin/barcode_items_controller.rb:28:in `create'
2024-03-02T16:44:05.9482698Z      # ./spec/requests/admin/barcode_items_requests_spec.rb:40:in `block (6 levels) in <top (required)>'
2024-03-02T16:44:05.9484334Z      # ./spec/requests/admin/barcode_items_requests_spec.rb:39:in `block (5 levels) in <top (required)>'
2024-03-02T16:44:05.9485230Z 
2024-03-02T16:44:05.9486193Z   7) Admin::BarcodeItemsController while signed in as a super admin POST #create with valid params redirects to admin_barcode_items_path
2024-03-02T16:44:05.9488076Z      Failure/Error: @barcode_item = BarcodeItem.create(barcode_item_params.merge(barcodeable_type: "BaseItem"))
2024-03-02T16:44:05.9489092Z 
2024-03-02T16:44:05.9489415Z      ActiveModel::MissingAttributeError:
2024-03-02T16:44:05.9490224Z        can't write unknown attribute `barcode_count`
2024-03-02T16:44:05.9491274Z      # ./app/controllers/admin/barcode_items_controller.rb:28:in `create'
2024-03-02T16:44:05.9492640Z      # ./spec/requests/admin/barcode_items_requests_spec.rb:32:in `block (5 levels) in <top (required)>'
2024-03-02T16:44:05.9493555Z 
2024-03-02T16:44:05.9493992Z Finished in 2 minutes 8.2 seconds (files took 8.12 seconds to load)
2024-03-02T16:44:05.9494999Z 200 examples, 7 failures
2024-03-02T16:44:05.9495381Z 
2024-03-02T16:44:05.9495603Z Failed examples:
2024-03-02T16:44:05.9495793Z 
2024-03-02T16:44:05.9496849Z rspec ./spec/system/donation_system_spec.rb:494 # Donations When signed in as a normal user When creating a new donation Via barcode entry When the barcode is a global barcode Adds the oldest item it can find for the global barcode
2024-03-02T16:44:05.9498829Z rspec ./spec/requests/admin/barcode_items_requests_spec.rb:83 # Admin::BarcodeItemsController while signed in as a super admin PATCH #update with invalid params returns a successful response (to show form with errors)
2024-03-02T16:44:05.9501197Z rspec ./spec/requests/admin/barcode_items_requests_spec.rb:72 # Admin::BarcodeItemsController while signed in as a super admin PATCH #update with valid params updates the barcode_item attributes accordingly
2024-03-02T16:44:05.9503095Z rspec ./spec/requests/admin/barcode_items_requests_spec.rb:65 # Admin::BarcodeItemsController while signed in as a super admin PATCH #update with valid params redirects to admin_barcode_items_path
2024-03-02T16:44:05.9504907Z rspec ./spec/requests/admin/barcode_items_requests_spec.rb:100 # Admin::BarcodeItemsController while signed in as a super admin DELETE #destroy allows deletion of a global barcode
2024-03-02T16:44:05.9506619Z rspec ./spec/requests/admin/barcode_items_requests_spec.rb:38 # Admin::BarcodeItemsController while signed in as a super admin POST #create with valid params creates a barcode item
2024-03-02T16:44:05.9508304Z rspec ./spec/requests/admin/barcode_items_requests_spec.rb:31 # Admin::BarcodeItemsController while signed in as a super admin POST #create with valid params redirects to admin_barcode_items_path
2024-03-02T16:44:05.9509197Z 
2024-03-02T16:44:05.9509366Z Randomized with seed 32043
2024-03-02T16:44:05.9703983Z 
2024-03-02T16:44:06.2485879Z Stopped processing SimpleCov as a previous error not related to SimpleCov has been detected
2024-03-02T16:44:06.2487994Z Coverage report generated for RSpec to /home/runner/work/human-essentials/human-essentials/coverage. 3886 / 6427 LOC (60.46%) covered.
2024-03-02T16:44:06.3788750Z /opt/hostedtoolcache/Ruby/3.2.2/x64/bin/ruby -I/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/lib:/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-support-3.12.1/lib /home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/exe/rspec  --format documentation --format KnapsackPro::Formatters::TimeTracker --default-path spec "spec/system/donation_system_spec.rb" "spec/system/item_system_spec.rb" "spec/system/transfer_system_spec.rb" "spec/system/profile_served_area_system_spec.rb" "spec/system/product_drive_system_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:4:9:1:1]" "spec/system/dashboard_system_spec.rb[1:2:7:3:1:1]" "spec/system/distributions_by_county_system_spec.rb" "spec/requests/distributions_requests_spec.rb" "spec/system/log_in_system_spec.rb" "spec/requests/storage_locations_requests_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:5:5:1:3]" "spec/system/dashboard_system_spec.rb[1:2:7:9:1:1]" "spec/system/dashboard_system_spec.rb[1:2:7:8:1:1]" "spec/system/dashboard_system_spec.rb[1:2:5:5:1:1]" "spec/system/dashboard_system_spec.rb[1:2:5:6:1:2]" "spec/system/dashboard_system_spec.rb[1:2:6:3:1:1]" "spec/system/dashboard_system_spec.rb[1:2:5:3:1:2]" "spec/system/dashboard_system_spec.rb[1:2:3:8:1:1]" "spec/system/dashboard_system_spec.rb[1:2:5:5:1:2]" "spec/requests/admin/barcode_items_requests_spec.rb" "spec/system/dashboard_system_spec.rb[1:2:4:1]" "spec/requests/profiles_requests_spec.rb" "spec/requests/admin/broadcast_announcements_spec.rb" "spec/requests/partners/family_requests_spec.rb" "spec/requests/partners/children_requests_spec.rb" "spec/requests/users/omniauth_callbacks_requests_spec.rb" failed
2024-03-02T16:44:06.7674882Z Stopped processing SimpleCov as a previous error not related to SimpleCov has been detected
2024-03-02T16:44:06.7676877Z Coverage report generated for RSpec to /home/runner/work/human-essentials/human-essentials/coverage. 38 / 10679 LOC (0.36%) covered.
2024-03-02T16:44:06.7963105Z ##[error]Process completed with exit code 1.
