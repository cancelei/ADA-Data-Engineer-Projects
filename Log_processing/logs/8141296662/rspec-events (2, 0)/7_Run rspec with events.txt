2024-03-04T13:51:40.9999019Z ##[group]Run RUBYOPT='-W:no-deprecated -W:no-experimental' bin/knapsack_pro_rspec
2024-03-04T13:51:40.9999909Z [36;1mRUBYOPT='-W:no-deprecated -W:no-experimental' bin/knapsack_pro_rspec[0m
2024-03-04T13:51:41.0027934Z shell: /usr/bin/bash -e {0}
2024-03-04T13:51:41.0028434Z env:
2024-03-04T13:51:41.0028772Z   POSTGRES_HOST: localhost
2024-03-04T13:51:41.0029173Z   DATABASE_HOST: localhost
2024-03-04T13:51:41.0029574Z   PG_USERNAME: postgres
2024-03-04T13:51:41.0029940Z   PG_PASSWORD: password
2024-03-04T13:51:41.0030341Z   POSTGRES_HOST_AUTH_METHOD: trust
2024-03-04T13:51:41.0030815Z   POSTGRES_PORT: 5432
2024-03-04T13:51:41.0031135Z   PGHOST: localhost
2024-03-04T13:51:41.0031748Z   PGUSER: postgres
2024-03-04T13:51:41.0032156Z   RAILS_ENV: test
2024-03-04T13:51:41.0032534Z   KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC: 
2024-03-04T13:51:41.0032969Z   KNAPSACK_PRO_CI_NODE_TOTAL: 2
2024-03-04T13:51:41.0033398Z   KNAPSACK_PRO_CI_NODE_INDEX: 0
2024-03-04T13:51:41.0033849Z   KNAPSACK_PRO_RSPEC_SPLIT_BY_TEST_EXAMPLES: true
2024-03-04T13:51:41.0034469Z   KNAPSACK_PRO_LOG_LEVEL: info
2024-03-04T13:51:41.0035137Z   KNAPSACK_PRO_TEST_FILE_EXCLUDE_PATTERN: {spec/system/**{,/*/**}/*_spec.rb,spec/requests/**{,/*/**}/*_spec.rb}
2024-03-04T13:51:41.0035801Z   EVENTS_READ: true
2024-03-04T13:51:41.0036170Z ##[endgroup]
2024-03-04T13:51:46.6076916Z W, [2024-03-04T13:51:46.607371 #2265]  WARN -- : [knapsack_pro] GET https://api-disabled-for-fork.knapsackpro.com/v1/build_distributions/last
2024-03-04T13:51:46.6078881Z W, [2024-03-04T13:51:46.607426 #2265]  WARN -- : [knapsack_pro] Request failed due to:
2024-03-04T13:51:46.6080375Z W, [2024-03-04T13:51:46.607449 #2265]  WARN -- : [knapsack_pro] #<SocketError: Failed to open TCP connection to api-disabled-for-fork.knapsackpro.com:443 (getaddrinfo: Name or service not known)>
2024-03-04T13:51:46.6083558Z W, [2024-03-04T13:51:46.607479 #2265]  WARN -- : [knapsack_pro] Slow test files fallback behaviour started. We could not connect with Knapsack Pro API to fetch last CI build test files that are needed to determine slow test files. No test files will be split by test cases. It means all test files will be split by the whole test files as if split by test cases would be disabled https://knapsackpro.com/perma/ruby/split-by-test-examples
2024-03-04T13:51:49.2818560Z W, [2024-03-04T13:51:49.281525 #2265]  WARN -- : [knapsack_pro] POST https://api-disabled-for-fork.knapsackpro.com/v1/build_distributions/subset
2024-03-04T13:51:49.2821011Z W, [2024-03-04T13:51:49.281562 #2265]  WARN -- : [knapsack_pro] Request failed due to:
2024-03-04T13:51:49.2824090Z W, [2024-03-04T13:51:49.281575 #2265]  WARN -- : [knapsack_pro] #<SocketError: Failed to open TCP connection to api-disabled-for-fork.knapsackpro.com:443 (getaddrinfo: Name or service not known)>
2024-03-04T13:51:49.2828294Z W, [2024-03-04T13:51:49.281616 #2265]  WARN -- : [knapsack_pro] Fallback mode started. We could not connect with Knapsack Pro API. Your tests will be executed based on directory names. Read more about fallback mode at https://knapsackpro.com/perma/ruby/fallback-mode
2024-03-04T13:51:49.2894336Z /opt/hostedtoolcache/Ruby/3.2.2/x64/bin/ruby -I/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/lib:/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-support-3.12.1/lib /home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/exe/rspec  --format documentation --format KnapsackPro::Formatters::TimeTracker --default-path spec "spec/models/account_request_spec.rb" "spec/models/audit_spec.rb" "spec/models/base_item_spec.rb" "spec/models/concerns/deadlinable_spec.rb" "spec/models/distribution_spec.rb" "spec/models/donation_spec.rb" "spec/models/inventory_item_spec.rb" "spec/models/item_spec.rb" "spec/models/kit_spec.rb" "spec/models/manufacturer_spec.rb" "spec/models/organization_spec.rb" "spec/models/partner_group_spec.rb" "spec/models/partners/authorized_family_member_spec.rb" "spec/models/partners/child_spec.rb" "spec/models/partners/item_request_spec.rb" "spec/models/partners/served_area_spec.rb" "spec/models/product_drive_spec.rb" "spec/models/question_spec.rb" "spec/models/request_spec.rb" "spec/models/storage_location_spec.rb" "spec/models/user_spec.rb" "spec/models/vendor_spec.rb" "spec/controllers/admins_controller_spec.rb" "spec/controllers/distributions_controller_spec.rb" "spec/controllers/donations_controller_spec.rb" "spec/controllers/items_controller_spec.rb" "spec/events/event_differ_spec.rb" "spec/helpers/application_helper_spec.rb" "spec/helpers/product_drive_helper_spec.rb" "spec/jobs/historical_data_cache_job_spec.rb" "spec/jobs/partner_mailer_job_spec.rb" "spec/lib/dispersed_past_dates_generator_spec.rb" "spec/mailers/custom_devise_mailer_spec.rb" "spec/mailers/organization_mailer_spec.rb" "spec/mailers/reminder_deadline_mailer_spec.rb" "spec/mailers/requests_confirmation_mailer_spec.rb" "spec/pdfs/distribution_pdf_spec.rb" "spec/queries/items_in_total_query_spec.rb" "spec/queries/items_out_total_query_spec.rb" "spec/services/add_role_service_spec.rb" "spec/services/allocate_kit_inventory_service_spec.rb" "spec/services/deadline_service_spec.rb" "spec/services/distribution_content_change_service_spec.rb" "spec/services/distribution_destroy_service_spec.rb" "spec/services/distribution_reminder_spec.rb" "spec/services/distributions_by_county_report_service_spec.rb" "spec/services/donation_destroy_service_spec.rb" "spec/services/exports/export_distributions_csv_service_spec.rb" "spec/services/exports/export_purchases_csv_service_spec.rb" "spec/services/exports/export_request_service_spec.rb" "spec/services/inventory_check_service_spec.rb" "spec/services/itemizable_update_service_spec.rb" "spec/services/organization_update_service_spec.rb" "spec/services/partner_create_service_spec.rb" "spec/services/partner_invite_service_spec.rb" "spec/services/partner_request_recertification_service_spec.rb" "spec/services/partners/fetch_partners_to_remind_now_service_spec.rb" "spec/services/partners/request_create_service_spec.rb" "spec/services/profile_update_service_spec.rb" "spec/services/reports/acquisition_report_service_spec.rb" "spec/services/reports/children_served_report_service_spec.rb" "spec/services/reports/partner_info_report_service_spec.rb" "spec/services/reports/summary_report_service_spec.rb" "spec/services/request_destroy_service_spec.rb" "spec/services/service_object_errors_mixin_spec.rb" "spec/services/text_interpolator_service_spec.rb" "spec/services/user_invite_service_spec.rb"
2024-03-04T13:51:57.8327783Z 
2024-03-04T13:51:57.8328425Z Randomized with seed 29987
2024-03-04T13:51:58.6946020Z 
2024-03-04T13:51:58.6946921Z Audit
2024-03-04T13:51:58.6948283Z   Scopes >
2024-03-04T13:51:58.7678465Z     `at_location` can filter out audits to a specific location
2024-03-04T13:51:58.7679099Z   behaves like itemizable
2024-03-04T13:51:58.7680098Z     .to_a
2024-03-04T13:51:58.7681599Z       with Flipper flag :deprecate_to_a disabled
2024-03-04T13:51:58.8359025Z         calls line_item_values
2024-03-04T13:51:58.8359895Z       with Flipper flag :deprecate_to_a enabled
2024-03-04T13:51:58.8841899Z         raises an error
2024-03-04T13:51:58.8842866Z     .line_items
2024-03-04T13:51:58.8843582Z       sorted
2024-03-04T13:51:58.9912138Z         displays the items, sorted by name
2024-03-04T13:51:58.9912878Z       combine!
2024-03-04T13:51:59.0455042Z         combines multiple line_items with the same item_id into a single record
2024-03-04T13:51:59.0816849Z         incrementally combines line_items on donations that have already been created
2024-03-04T13:51:59.0817746Z       total
2024-03-04T13:51:59.1606429Z         has an item total
2024-03-04T13:51:59.1607051Z       quantities_by_name
2024-03-04T13:51:59.2368452Z         returns a hash of items with id, name, and quantity
2024-03-04T13:51:59.3136158Z         leaves out zero-quantitied items if requested
2024-03-04T13:51:59.3136799Z   Validations >
2024-03-04T13:51:59.3654637Z     cannot have duplicate line items
2024-03-04T13:51:59.4181998Z     can have line items that has quantity as a positive integer
2024-03-04T13:51:59.4706391Z     can not have line items that has quantity as negative integer
2024-03-04T13:51:59.4803060Z     must belong to an organization admin of its organization
2024-03-04T13:51:59.5328725Z     can not have line items that has quantity as a string that cannot be reduced to an integer
2024-03-04T13:51:59.6132192Z     can have line items that has quantity as zero
2024-03-04T13:51:59.6418587Z     must belong to an organization
2024-03-04T13:51:59.6419105Z   versioning
2024-03-04T13:51:59.6457814Z     is expected to be versioned
2024-03-04T13:51:59.6458259Z   Methods >
2024-03-04T13:51:59.8809713Z     `self.storage_locations_audited_for` returns only storage_locations that are used for one org
2024-03-04T13:52:00.2140656Z     `self.finalized_since?` returns true iff some finalized audit occurred after itemizable created_at that shares item for location(s)
2024-03-04T13:52:00.2141835Z 
2024-03-04T13:52:00.2142015Z Vendor
2024-03-04T13:52:00.2142684Z   versioning
2024-03-04T13:52:00.2239360Z     is expected to be versioned
2024-03-04T13:52:00.2240233Z   behaves like provideable
2024-03-04T13:52:00.2241136Z     geocode
2024-03-04T13:52:00.2306659Z       adds coordinates to the database
2024-03-04T13:52:00.2307349Z     import_csv
2024-03-04T13:52:00.4069586Z       imports from a csv file
2024-03-04T13:52:00.4070275Z     Validations
2024-03-04T13:52:00.4132405Z       is invalid unless it has either a contact name or a business name
2024-03-04T13:52:00.4167473Z       is invalid without an organization
2024-03-04T13:52:00.4168282Z   Methods
2024-03-04T13:52:00.4168771Z     volume
2024-03-04T13:52:00.4906105Z       retrieves the amount of product that has been bought from this vendor
2024-03-04T13:52:00.4906824Z 
2024-03-04T13:52:00.4907206Z DeadlineService
2024-03-04T13:52:00.4907915Z   #next_deadline
2024-03-04T13:52:00.4908737Z     from the organization
2024-03-04T13:52:00.4909815Z       when the deadline is before today
2024-03-04T13:52:00.5011680Z         returns a date in the next month
2024-03-04T13:52:00.5012356Z       when the deadline is today
2024-03-04T13:52:00.5064039Z         returns a date in the next month
2024-03-04T13:52:00.5065483Z       when the deadline is after today
2024-03-04T13:52:00.5117554Z         returns a date within the current month
2024-03-04T13:52:00.5118952Z     do from the partner group
2024-03-04T13:52:00.5119638Z       when the deadline is today
2024-03-04T13:52:00.5170067Z         returns a date in the next month
2024-03-04T13:52:00.5170983Z       when the deadline is before today
2024-03-04T13:52:00.5223106Z         returns a date in the next month
2024-03-04T13:52:00.5224108Z       when the deadline is after today
2024-03-04T13:52:00.5275566Z         returns a date within the current month
2024-03-04T13:52:00.5276406Z 
2024-03-04T13:52:00.5276756Z DonationDestroyService
2024-03-04T13:52:00.5277725Z   #call
2024-03-04T13:52:00.5279806Z     when the donation_id matches no Donation owned by the organization
2024-03-04T13:52:00.5335499Z       to not be a success
2024-03-04T13:52:00.5336341Z     when the donation destroy fails
2024-03-04T13:52:00.5466679Z       to not be a success
2024-03-04T13:52:00.5467623Z     when storage_location fails to decrease the inventory of the donation
2024-03-04T13:52:00.5521163Z       to not be a success
2024-03-04T13:52:00.5522030Z     when the organization_id matches no Organization
2024-03-04T13:52:00.5559093Z       to not be a success
2024-03-04T13:52:00.5559828Z     when the donation succesfully gets destroyed
2024-03-04T13:52:00.5823961Z       to be a success
2024-03-04T13:52:00.5824596Z 
2024-03-04T13:52:00.5825077Z InventoryItem
2024-03-04T13:52:00.5860161Z   initializes the quantity to 0 if it was not specified
2024-03-04T13:52:00.5860965Z   Filtering >
2024-03-04T13:52:00.5861858Z     ->by_partner_key
2024-03-04T13:52:00.5991872Z       shows the Base Items by partner_key
2024-03-04T13:52:00.5992578Z   versioning
2024-03-04T13:52:00.6027223Z     is expected to be versioned
2024-03-04T13:52:00.6028185Z   Validations >
2024-03-04T13:52:00.6076716Z     requires an inventory association
2024-03-04T13:52:00.6117540Z     requires an item
2024-03-04T13:52:00.6118048Z     quantity >
2024-03-04T13:52:00.6172942Z       is numerical
2024-03-04T13:52:00.6227227Z       is less than the max integer
2024-03-04T13:52:00.6281576Z       is required
2024-03-04T13:52:00.6416095Z       is gte 0
2024-03-04T13:52:00.6417009Z 
2024-03-04T13:52:00.6417249Z Kit
2024-03-04T13:52:00.8445101Z   deactivate and reactivate
2024-03-04T13:52:00.8445853Z   #can_deactivate?
2024-03-04T13:52:00.8446813Z     with inventory items
2024-03-04T13:52:01.0540452Z       should return false
2024-03-04T13:52:01.0541021Z     without inventory items
2024-03-04T13:52:01.2576091Z       should return true
2024-03-04T13:52:01.2576715Z   Value >
2024-03-04T13:52:01.2746260Z     converts cents to dollars
2024-03-04T13:52:01.2904561Z     converts dollars to cents
2024-03-04T13:52:01.2905221Z     .value_per_itemizable
2024-03-04T13:52:01.3285565Z       calculates values from associated items
2024-03-04T13:52:01.3288280Z   Validations >
2024-03-04T13:52:01.3452853Z     requires a name
2024-03-04T13:52:01.3622899Z     can't have negative value
2024-03-04T13:52:01.3782927Z     is valid as built
2024-03-04T13:52:01.5750265Z     requires a unique name
2024-03-04T13:52:01.5927544Z     requires at least one item
2024-03-04T13:52:01.6092326Z     must belong to an organization
2024-03-04T13:52:01.6092933Z   versioning
2024-03-04T13:52:01.6130360Z     is expected to be versioned
2024-03-04T13:52:01.6130977Z   Filtering >
2024-03-04T13:52:02.1670415Z     ->alphabetized retrieves items in alphabetical order
2024-03-04T13:52:02.1723824Z     can filter
2024-03-04T13:52:02.1724766Z     ->by_partner_key
2024-03-04T13:52:02.4058001Z       shows the kits for a particular item
2024-03-04T13:52:02.4058780Z 
2024-03-04T13:52:02.4059203Z Partners::Child
2024-03-04T13:52:02.4060262Z   associations
2024-03-04T13:52:02.4197643Z     is expected to have many child_item_requests dependent => destroy
2024-03-04T13:52:02.4242161Z     is expected to belong to family required: true
2024-03-04T13:52:02.4243061Z   versioning
2024-03-04T13:52:02.4277212Z     is expected to be versioned
2024-03-04T13:52:02.4277852Z   #display_name
2024-03-04T13:52:02.4704774Z     should return a child's first and last name
2024-03-04T13:52:02.4705436Z 
2024-03-04T13:52:02.4705739Z Exports::ExportPurchasesCSVService
2024-03-04T13:52:02.4706800Z   #generate_csv_data
2024-03-04T13:52:02.5788865Z     should match the expected content for the csv
2024-03-04T13:52:02.5789617Z 
2024-03-04T13:52:02.5790042Z AccountRequest
2024-03-04T13:52:02.6010876Z   #confirm!
2024-03-04T13:52:02.6132123Z   #reject!
2024-03-04T13:52:02.6133034Z   validations
2024-03-04T13:52:02.6268091Z     is expected to validate that :email is case-sensitively unique
2024-03-04T13:52:02.6370126Z     is expected to allow :email to be â€¹"gilbert@oberbrunner.test"â€º
2024-03-04T13:52:02.6488597Z     is expected to validate that the length of :request_details is at least 50
2024-03-04T13:52:02.6588135Z     is expected not to allow :email to be â€¹"not_email"â€º
2024-03-04T13:52:02.6707794Z     is expected to validate that :request_details cannot be empty/falsy
2024-03-04T13:52:02.6844752Z     is expected to validate that :name cannot be empty/falsy
2024-03-04T13:52:02.6990204Z     is expected to validate that :email cannot be empty/falsy
2024-03-04T13:52:02.6991765Z     when the email provided is already used by an existing user
2024-03-04T13:52:02.7270611Z       should not allow the email
2024-03-04T13:52:02.7271812Z     when the email provided is already used by an existing organization
2024-03-04T13:52:02.9085113Z       should not allow the email
2024-03-04T13:52:02.9085875Z   associations
2024-03-04T13:52:02.9124814Z     is expected to have one organization class_name => Organization
2024-03-04T13:52:02.9178963Z     is expected to belong to ndbn_member class_name => NDBNMember optional: true
2024-03-04T13:52:02.9179707Z   .get_by_identity_token
2024-03-04T13:52:02.9180758Z     when the identity_token provided does not match any AccountRequest
2024-03-04T13:52:02.9213360Z       should return nil
2024-03-04T13:52:02.9214129Z     when the identity_token corresponds to an existing AccountRequest
2024-03-04T13:52:02.9310359Z       should return the corresponding AccountRequest
2024-03-04T13:52:02.9311023Z   #processed?
2024-03-04T13:52:02.9312107Z     when the account request has a associated organization
2024-03-04T13:52:03.1096693Z       should return true
2024-03-04T13:52:03.1097601Z     when the account request has no associated organization
2024-03-04T13:52:03.1202778Z       should return false
2024-03-04T13:52:03.1203447Z   #identity_token
2024-03-04T13:52:03.1284909Z     should return a JWT token that contains the id of the account_request_id
2024-03-04T13:52:03.1286287Z     when the account_request is not persisted
2024-03-04T13:52:03.1370283Z       should raise an error
2024-03-04T13:52:03.1371005Z   versioning
2024-03-04T13:52:03.1404661Z     is expected to be versioned
2024-03-04T13:52:03.1405157Z 
2024-03-04T13:52:03.1405446Z ProfileUpdateService
2024-03-04T13:52:03.1406539Z   #update
2024-03-04T13:52:03.1682875Z     updates the profile with the filtered and prepared params
2024-03-04T13:52:03.1683630Z 
2024-03-04T13:52:03.1683841Z EventDiffer
2024-03-04T13:52:03.3676772Z   should return a full diff
2024-03-04T13:52:03.3677320Z 
2024-03-04T13:52:03.3677473Z PartnerMailerJob
2024-03-04T13:52:03.3678192Z   conditionally sending the emails
2024-03-04T13:52:03.6730794Z     sends mail for future distributions immediately
2024-03-04T13:52:03.8702637Z     does not send mail for past distributions
2024-03-04T13:52:03.8703333Z     when the distribution is for a deactivated partner
2024-03-04T13:52:04.0775252Z       does not send the email
2024-03-04T13:52:04.0775800Z 
2024-03-04T13:52:04.0776033Z PartnerInviteService
2024-03-04T13:52:04.1093095Z   should create invite
2024-03-04T13:52:04.1378220Z   should update the status of the partner to invited
2024-03-04T13:52:04.1378812Z   with force: true
2024-03-04T13:52:04.1664462Z     should send the force setting forward
2024-03-04T13:52:04.1664954Z 
2024-03-04T13:52:04.1665361Z AddRoleService
2024-03-04T13:52:04.1667474Z   #call
2024-03-04T13:52:04.1668228Z     when the role does not yet exist
2024-03-04T13:52:04.3563180Z       works with super admin
2024-03-04T13:52:04.5495504Z       should add the user role when asked to add admin
2024-03-04T13:52:04.7469851Z       should add the role
2024-03-04T13:52:04.9525091Z       works with a partner
2024-03-04T13:52:04.9525987Z     when the role already exists
2024-03-04T13:52:05.1400833Z       should raise an error
2024-03-04T13:52:05.3251477Z       should raise an error for super admin
2024-03-04T13:52:05.3252319Z 
2024-03-04T13:52:05.3252751Z DistributionsController
2024-03-04T13:52:05.3253971Z   While signed in
2024-03-04T13:52:05.3254988Z     POST #create
2024-03-04T13:52:05.3256449Z       when line item quantity is not positive
2024-03-04T13:52:05.3919231Z         flashes an error
2024-03-04T13:52:05.3920411Z       multiple line_items that have inventory quantity below minimum quantity
2024-03-04T13:52:05.4870071Z         redirects with a flash notice and a flash error
2024-03-04T13:52:05.4871646Z       multiple line_items that have inventory quantity below recommended quantity
2024-03-04T13:52:05.5708227Z         redirects with a flash notice and a flash alert
2024-03-04T13:52:05.5709063Z       when distribution causes inventory quantity to be below minimum quantity
2024-03-04T13:52:05.6440574Z         redirects with a flash notice and a flash error
2024-03-04T13:52:05.6441498Z     PUT #update
2024-03-04T13:52:05.6442218Z       when distribution has items updated for minimum quantity
2024-03-04T13:52:05.7730165Z         redirects with a flash notice and send send_notification
2024-03-04T13:52:05.7731413Z       when distribution causes inventory quantity to be below minimum quantity
2024-03-04T13:52:05.8834045Z         redirects with a flash notice and a flash error
2024-03-04T13:52:05.8835215Z       when distribution causes inventory quantity to be below recommended quantity
2024-03-04T13:52:05.9874721Z         redirects with a flash notice and a flash error
2024-03-04T13:52:05.9875274Z 
2024-03-04T13:52:05.9875552Z ServiceObjectErrorsMixin
2024-03-04T13:52:05.9876315Z   self.included
2024-03-04T13:52:05.9916348Z     should add class methods to the class that include ServiceObjectErrorsMixin
2024-03-04T13:52:05.9917226Z 
2024-03-04T13:52:05.9917546Z Reports::ChildrenServedReportService
2024-03-04T13:52:05.9918264Z   #report
2024-03-04T13:52:06.4755900Z     should report normal values
2024-03-04T13:52:06.9581522Z     should work with no distribution_quantity
2024-03-04T13:52:07.1353009Z     should report zero values
2024-03-04T13:52:07.1353589Z 
2024-03-04T13:52:07.1354235Z Question
2024-03-04T13:52:07.1355347Z   scope for_partners
2024-03-04T13:52:07.1705399Z     should filter out questions that aren't meant for partners
2024-03-04T13:52:07.1706321Z   scope for_banks
2024-03-04T13:52:07.1932724Z     should filter out questions that aren't meant for banks
2024-03-04T13:52:07.1933904Z   validations
2024-03-04T13:52:07.2024804Z     question for_banks and for_partners attributes can't both be false
2024-03-04T13:52:07.2087312Z     is expected to validate that :title cannot be empty/falsy
2024-03-04T13:52:07.2141817Z     is expected to validate that :answer cannot be empty/falsy
2024-03-04T13:52:07.2142720Z   remove_redundant_error
2024-03-04T13:52:07.2180436Z     should return an array with only one error message related to the checkboxes.
2024-03-04T13:52:07.2181523Z   versioning
2024-03-04T13:52:07.2216127Z     is expected to be versioned
2024-03-04T13:52:07.2217033Z   punctuate
2024-03-04T13:52:07.2254815Z     should punctuate each string in a given array
2024-03-04T13:52:07.2255511Z 
2024-03-04T13:52:07.2255901Z Partners::RequestCreateService
2024-03-04T13:52:07.2256637Z   #call
2024-03-04T13:52:07.2257644Z     when the arguments are correct
2024-03-04T13:52:07.2761441Z       should notify the Partner via email
2024-03-04T13:52:07.3115839Z       should have no errors
2024-03-04T13:52:07.3475452Z       should create a Request record
2024-03-04T13:52:07.3476061Z       but a unexpected error occured during the save
2024-03-04T13:52:07.3476728Z         for the Request record
2024-03-04T13:52:07.3816872Z           should NOT notify the Partner via email
2024-03-04T13:52:07.4158285Z           should NOT create a Request record
2024-03-04T13:52:07.4490595Z           should have an error with the raised error
2024-03-04T13:52:07.4491725Z     when the arguments are incorrect
2024-03-04T13:52:07.4492707Z       because no item_requests_attributes and comments were defined
2024-03-04T13:52:07.4755468Z         should return the Request object with an error
2024-03-04T13:52:07.4756663Z       because a unrecogonized item_id was provided
2024-03-04T13:52:07.5042866Z         should return the Request object with an error
2024-03-04T13:52:07.5044838Z 
2024-03-04T13:52:07.5045160Z Organization
2024-03-04T13:52:07.5047642Z   #ordered_requests
2024-03-04T13:52:07.6926830Z     puts active requests before fulfilled requests
2024-03-04T13:52:07.6927742Z     ordering of requests with matching status
2024-03-04T13:52:07.8823107Z       puts the most recently updated request before older requests
2024-03-04T13:52:07.8824348Z   total_inventory
2024-03-04T13:52:08.1278370Z     returns a sum total of all inventory at all storage locations
2024-03-04T13:52:08.3047156Z     returns 0 if there is nothing
2024-03-04T13:52:08.3047971Z   Associations >
2024-03-04T13:52:08.3099716Z     is expected to belong to ndbn_member class_name => NDBNMember optional: true
2024-03-04T13:52:08.3134436Z     is expected to have many users through roles
2024-03-04T13:52:08.3182550Z     is expected to have many item_categories
2024-03-04T13:52:08.3183391Z     users
2024-03-04T13:52:08.3184235Z       when a organizaton has a user that has two roles
2024-03-04T13:52:08.5121149Z         should returns users without duplications
2024-03-04T13:52:08.5122013Z     distributions
2024-03-04T13:52:08.5123270Z       upcoming
2024-03-04T13:52:08.5849733Z         retrieves the distributions scheduled for this week that have not yet happened
2024-03-04T13:52:08.5850803Z     barcode_items
2024-03-04T13:52:08.7802634Z       returns only this organization's barcodes, no globals
2024-03-04T13:52:08.7803542Z       .all
2024-03-04T13:52:08.9698083Z         includes global barcode items also
2024-03-04T13:52:08.9698947Z     items
2024-03-04T13:52:08.9699740Z       .during
2024-03-04T13:52:10.9308401Z         return ranking of all items
2024-03-04T13:52:10.9309365Z       .other
2024-03-04T13:52:12.8635213Z         returns all items for this organization designated 'other'
2024-03-04T13:52:12.8636408Z       .during.top
2024-03-04T13:52:15.0001047Z         return 3 most used items
2024-03-04T13:52:16.9471577Z         return just 3 elements
2024-03-04T13:52:16.9472292Z       .during.bottom
2024-03-04T13:52:18.8673185Z         return just 3 elements
2024-03-04T13:52:20.8406396Z         return 3 least used items
2024-03-04T13:52:20.8407395Z   #seed_items
2024-03-04T13:52:21.0230840Z     allows a single base item to be seeded
2024-03-04T13:52:21.2082896Z     allows a collection of items to be seeded
2024-03-04T13:52:21.2084679Z     when given an item name that already exists, but with an 'other' partner key
2024-03-04T13:52:21.3994013Z       updates the old item to use the new base item as its base
2024-03-04T13:52:21.3994926Z     when given an item that already exists
2024-03-04T13:52:21.5752122Z       gracefully skips the item
2024-03-04T13:52:21.5752839Z   is_active
2024-03-04T13:52:21.9368122Z     returns active organizations
2024-03-04T13:52:21.9368983Z   #assign_attributes_from_account_request
2024-03-04T13:52:21.9461555Z     should assign the proper attributes to the organization
2024-03-04T13:52:21.9462362Z   geocode
2024-03-04T13:52:22.1239899Z     adds coordinates to the database
2024-03-04T13:52:22.1240994Z   #short_name
2024-03-04T13:52:22.1318433Z     can only contain valid characters
2024-03-04T13:52:22.1319208Z   after_create
2024-03-04T13:52:22.1533744Z     should update the state of the account request
2024-03-04T13:52:22.1534638Z   versioning
2024-03-04T13:52:22.1573659Z     is expected to be versioned
2024-03-04T13:52:22.1574503Z   default storage location
2024-03-04T13:52:22.1617301Z     associates the default storage location with a storage location
2024-03-04T13:52:22.1654086Z     returns nil when not set
2024-03-04T13:52:22.1654737Z   valid_items
2024-03-04T13:52:22.3480961Z     returns an array of item partner keys
2024-03-04T13:52:22.5264375Z     only shows active valid items
2024-03-04T13:52:22.5265253Z     with invisible items
2024-03-04T13:52:22.5561028Z       only shows active and visible items
2024-03-04T13:52:22.5561760Z   deadline_day
2024-03-04T13:52:22.5663093Z     can only contain numbers 1-28
2024-03-04T13:52:22.5663822Z   .seed_items
2024-03-04T13:52:22.5664390Z     when no organization is provided
2024-03-04T13:52:23.1880916Z       updates all organizations
2024-03-04T13:52:23.1881544Z     when provided with an organization to seed
2024-03-04T13:52:23.5132603Z       loads the base items into Item records
2024-03-04T13:52:23.5133494Z   earliest reporting year
2024-03-04T13:52:23.6900044Z     is the organization created year if no associated data
2024-03-04T13:52:23.9210958Z     is the year of the earliest of donation, purchase, or distribution if they are earlier
2024-03-04T13:52:23.9212113Z   from_email
2024-03-04T13:52:24.0924076Z     returns email when present
2024-03-04T13:52:24.2842384Z     returns admin email when it's empty space
2024-03-04T13:52:24.4697730Z     returns admin email when it's empty
2024-03-04T13:52:24.6707723Z     returns admin email when not present
2024-03-04T13:52:24.6708536Z   validations
2024-03-04T13:52:24.6780392Z     validates that attachment file size is not higher than 1 MB
2024-03-04T13:52:24.6850514Z     validates that attachments are png or jpgs
2024-03-04T13:52:24.8949651Z     validates that short names are unique
2024-03-04T13:52:24.9051240Z     validates that at least one distribution type is enabled
2024-03-04T13:52:24.9051852Z   address
2024-03-04T13:52:24.9089130Z     does not add any separators after street when city, state, and zip are missing
2024-03-04T13:52:24.9121126Z     does not add a trailing space when the zip code is missing
2024-03-04T13:52:24.9156212Z     does not add any separators before the city when street is missing
2024-03-04T13:52:24.9189491Z     returns an empty string when the org has no address components
2024-03-04T13:52:24.9221708Z     correctly formats an address string with commas and spaces
2024-03-04T13:52:24.9222842Z   reminder_day
2024-03-04T13:52:24.9334421Z     can only contain numbers 1-28
2024-03-04T13:52:24.9334953Z 
2024-03-04T13:52:24.9335297Z DistributionContentChangeService
2024-03-04T13:52:24.9338803Z   #any_change?
2024-03-04T13:52:24.9340453Z     when there are line items updated
2024-03-04T13:52:24.9374551Z       returns true
2024-03-04T13:52:24.9375205Z     when there are no changes in the line items
2024-03-04T13:52:24.9410214Z       returns true
2024-03-04T13:52:24.9410978Z     when there are line items removed and updated
2024-03-04T13:52:24.9445738Z       returns true
2024-03-04T13:52:24.9478715Z     when there are line items removed
2024-03-04T13:52:24.9479606Z       returns true
2024-03-04T13:52:24.9480536Z   #changes
2024-03-04T13:52:24.9481210Z     when there are line items removed and updated
2024-03-04T13:52:24.9515381Z       returns true
2024-03-04T13:52:24.9516004Z 
2024-03-04T13:52:24.9516476Z DispersedPastDatesGenerator
2024-03-04T13:52:24.9517543Z   constants
2024-03-04T13:52:24.9553133Z     has 4 day ranges for generation of past dates
2024-03-04T13:52:24.9553941Z   #next
2024-03-04T13:52:24.9605609Z     returns equally dispersed dates between all time ranges
2024-03-04T13:52:24.9606501Z 
2024-03-04T13:52:24.9606726Z DistributionPdf
2024-03-04T13:52:25.0227251Z   #non_request_data
2024-03-04T13:52:25.0893446Z   #request_data
2024-03-04T13:52:25.0894118Z 
2024-03-04T13:52:25.0894501Z Item
2024-03-04T13:52:25.0896117Z   distribution_quantity and package size
2024-03-04T13:52:25.1024647Z     have nil values if an empty string is passed
2024-03-04T13:52:25.1025433Z   versioning
2024-03-04T13:52:25.1061180Z     is expected to be versioned
2024-03-04T13:52:25.1062083Z   Assocations >
2024-03-04T13:52:25.1107422Z     is expected to belong to item_category optional: true
2024-03-04T13:52:25.1108351Z   Validations >
2024-03-04T13:52:25.1244855Z     requires a unique name
2024-03-04T13:52:25.1358745Z     requires that items quantity are not a negative number
2024-03-04T13:52:25.1407285Z     requires a Base Item base
2024-03-04T13:52:25.1461031Z     must belong to an organization
2024-03-04T13:52:25.1461598Z   Filtering >
2024-03-04T13:52:25.1496497Z     can filter
2024-03-04T13:52:25.1703893Z     ->by_size returns all items with the same size, per their BaseItem parent
2024-03-04T13:52:25.1974431Z     ->active shows items that are still active
2024-03-04T13:52:25.2159009Z     ->alphabetized retrieves items in alphabetical order
2024-03-04T13:52:25.2160122Z     ->disposable
2024-03-04T13:52:25.2436602Z       returns records associated with disposable diapers
2024-03-04T13:52:25.2437763Z     ->cloth_diapers
2024-03-04T13:52:25.2719448Z       returns records associated with disposable diapers
2024-03-04T13:52:25.2720652Z     ->by_base_item
2024-03-04T13:52:25.2881076Z       shows the items for a particular base_item
2024-03-04T13:52:25.4821225Z       can be chained to organization to constrain it to just 1 org's items
2024-03-04T13:52:25.4822401Z     ->by_partner_key
2024-03-04T13:52:25.4974541Z       filters by partner key
2024-03-04T13:52:25.4975394Z   Methods >
2024-03-04T13:52:25.4976620Z     has_history?
2024-03-04T13:52:25.5695139Z       identifies items that have been used previously
2024-03-04T13:52:25.5696167Z     barcodes_for
2024-03-04T13:52:25.5891643Z       retrieves all BarcodeItems associated with an item
2024-03-04T13:52:25.5892453Z     barcoded_items >
2024-03-04T13:52:25.6242471Z       returns a collection of items that have barcodes associated with them
2024-03-04T13:52:25.6243431Z     destroy
2024-03-04T13:52:25.6419566Z       actually destroys an item that doesn't have history
2024-03-04T13:52:25.6654121Z       only hides an item that has history
2024-03-04T13:52:25.8691401Z       deactivates the kit if it exists
2024-03-04T13:52:25.8692219Z     other?
2024-03-04T13:52:25.8814300Z       is true for items that are partner_key 'other'
2024-03-04T13:52:25.8815331Z     #reactivate!
2024-03-04T13:52:25.8815948Z       given an array of item ids
2024-03-04T13:52:25.9033458Z         sets the active trait to true for all of them
2024-03-04T13:52:25.9034451Z       given a single item id
2024-03-04T13:52:25.9162250Z         sets the active trait to true for that item
2024-03-04T13:52:25.9163189Z     storage_locations_containing
2024-03-04T13:52:25.9526017Z       retrieves all storage locations that contain an item
2024-03-04T13:52:25.9526899Z   after update
2024-03-04T13:52:25.9527763Z     when item does not have kit
2024-03-04T13:52:25.9651721Z       does not raise any errors
2024-03-04T13:52:25.9652354Z     when item has the kit
2024-03-04T13:52:26.1725311Z       updates kit name
2024-03-04T13:52:26.1726045Z   default_quantity
2024-03-04T13:52:26.1809719Z     should return the value of on_hand_minimum_quantity if it is set
2024-03-04T13:52:26.1888116Z     should return 50 if column is not set
2024-03-04T13:52:26.1968233Z     should return 0 if on_hand_minimum_quantity is not set
2024-03-04T13:52:26.2048323Z     should return the value of distribution_quantity if it is set
2024-03-04T13:52:26.2049067Z 
2024-03-04T13:52:26.2049330Z Exports::ExportRequestService
2024-03-04T13:52:26.2049965Z   .generate_csv_data
2024-03-04T13:52:26.4045735Z     includes rows for each request with correct columns of item quantity
2024-03-04T13:52:26.6078320Z     includes headers as the first row with ordered item names alphabetically with deleted item included at the end
2024-03-04T13:52:26.6079750Z 
2024-03-04T13:52:26.6080013Z ProductDriveHelper
2024-03-04T13:52:26.6080590Z   #is_virtual
2024-03-04T13:52:26.6081324Z     when the product drive was held virtually
2024-03-04T13:52:26.6203800Z       is expected to eq "Yes"
2024-03-04T13:52:26.6204769Z     when a product drive was not provided
2024-03-04T13:52:26.6252142Z       without argument
2024-03-04T13:52:26.6295878Z       with blank argument
2024-03-04T13:52:26.6297062Z     when the product drive wasn't held virtually
2024-03-04T13:52:26.6348514Z       is expected to eq "No"
2024-03-04T13:52:26.6349159Z 
2024-03-04T13:52:26.6349552Z Reports::PartnerInfoReportService
2024-03-04T13:52:26.6350377Z   #report
2024-03-04T13:52:26.8094268Z     should report zero values
2024-03-04T13:52:27.0520363Z     should report normal values
2024-03-04T13:52:27.0521101Z 
2024-03-04T13:52:27.0521398Z ApplicationHelper
2024-03-04T13:52:27.0523477Z   can_administrate?
2024-03-04T13:52:27.0524587Z     User is org admin and part of org
2024-03-04T13:52:27.0738645Z       can administrate
2024-03-04T13:52:27.0739409Z     User is org admin and not part of org
2024-03-04T13:52:27.2665205Z       cannot administrate
2024-03-04T13:52:27.2666043Z     User is part of org but not org admin
2024-03-04T13:52:27.2809001Z       cannot administrate
2024-03-04T13:52:27.2809874Z   confirm_delete_msg
2024-03-04T13:52:27.2854666Z     subs in string
2024-03-04T13:52:27.2855304Z   flash_class
2024-03-04T13:52:27.2909661Z     returns appropriate class for error
2024-03-04T13:52:27.2951386Z     returns appropriate class for alert
2024-03-04T13:52:27.2992852Z     returns appropriate class for success
2024-03-04T13:52:27.3034122Z     returns appropriate class for notice
2024-03-04T13:52:27.3034902Z   active_class
2024-03-04T13:52:27.3077616Z     Returns the controller name
2024-03-04T13:52:27.3078305Z   default_title_content
2024-03-04T13:52:27.3079144Z     Organization does not exist
2024-03-04T13:52:27.3124993Z       returns a default name
2024-03-04T13:52:27.3125709Z     Organization exists
2024-03-04T13:52:27.5176650Z       returns the organization's name
2024-03-04T13:52:27.5177954Z   step_container_helper
2024-03-04T13:52:27.5178815Z     active_index is greater than index
2024-03-04T13:52:27.5230796Z       returns done
2024-03-04T13:52:27.5232037Z     active_index is less than index
2024-03-04T13:52:27.5292827Z       returns empty string
2024-03-04T13:52:27.5293628Z     active_index is equal to index
2024-03-04T13:52:27.5348160Z       returns active
2024-03-04T13:52:27.5350440Z 
2024-03-04T13:52:27.5350754Z HistoricalDataCacheJob
2024-03-04T13:52:27.7192479Z   queues the job
2024-03-04T13:52:27.9121632Z   caches the historical data
2024-03-04T13:52:27.9122549Z 
2024-03-04T13:52:27.9122777Z Deadlinable
2024-03-04T13:52:27.9123321Z   validations
2024-03-04T13:52:27.9223970Z     is expected to validate that :deadline_day looks like an integer greater than or equal to 1 and less than or equal to 28 as long as it is not nil
2024-03-04T13:52:27.9295950Z     is expected to validate that :reminder_day looks like an integer greater than or equal to 1 and less than or equal to 28 as long as it is not nil
2024-03-04T13:52:27.9336147Z     validates that reminder day is not the same as deadline day
2024-03-04T13:52:27.9336944Z 
2024-03-04T13:52:27.9337258Z Partners::ItemRequest
2024-03-04T13:52:27.9338181Z   validations
2024-03-04T13:52:27.9397644Z     is expected to validate that :quantity looks like an integer greater than or equal to 1
2024-03-04T13:52:27.9456019Z     is expected to validate that :partner_key cannot be empty/falsy
2024-03-04T13:52:27.9516811Z     is expected to validate that :quantity cannot be empty/falsy
2024-03-04T13:52:27.9574953Z     is expected to validate that :name cannot be empty/falsy
2024-03-04T13:52:27.9575986Z   versioning
2024-03-04T13:52:27.9609720Z     is expected to be versioned
2024-03-04T13:52:27.9610191Z   associations
2024-03-04T13:52:27.9646900Z     is expected to have many children through child_item_requests
2024-03-04T13:52:27.9681729Z     is expected to have many child_item_requests dependent => destroy
2024-03-04T13:52:27.9721910Z     is expected to belong to request class_name => ::Request required: true
2024-03-04T13:52:27.9722611Z 
2024-03-04T13:52:27.9722841Z Partners::AuthorizedFamilyMember
2024-03-04T13:52:27.9723827Z   #display_name
2024-03-04T13:52:27.9994805Z     should return the family member's first and last name
2024-03-04T13:52:27.9995656Z   associations
2024-03-04T13:52:28.0030137Z     is expected to have many child_item_requests dependent => nullify
2024-03-04T13:52:28.0070139Z     is expected to belong to family required: true
2024-03-04T13:52:28.0071019Z   versioning
2024-03-04T13:52:28.0106311Z     is expected to be versioned
2024-03-04T13:52:28.0106980Z 
2024-03-04T13:52:28.0107320Z BaseItem
2024-03-04T13:52:28.0108382Z   Associations >
2024-03-04T13:52:28.0243227Z     keeps count of its associated items
2024-03-04T13:52:28.0244234Z   versioning
2024-03-04T13:52:28.0281924Z     is expected to be versioned
2024-03-04T13:52:28.0282593Z   Validations >
2024-03-04T13:52:28.0353352Z     is invalid without a unique name
2024-03-04T13:52:28.0403591Z     is invalid without a partner key
2024-03-04T13:52:28.0477489Z     is invalid without a uniqueness key
2024-03-04T13:52:28.0523781Z     is invalid without a name
2024-03-04T13:52:28.0524524Z   Filtering >
2024-03-04T13:52:28.0525413Z     ->without_kit
2024-03-04T13:52:28.0576093Z       should not include the Kit BaseItem
2024-03-04T13:52:28.0577021Z     ->by_partner_key
2024-03-04T13:52:28.0630218Z       shows the Base Items by partner_key
2024-03-04T13:52:28.0630769Z 
2024-03-04T13:52:28.0631060Z RequestsConfirmationMailer
2024-03-04T13:52:28.0939359Z   pairs the right quantities with the right item names
2024-03-04T13:52:28.1110571Z   handles duplicates
2024-03-04T13:52:28.1111455Z   #confirmation_email
2024-03-04T13:52:28.1238574Z     renders the headers
2024-03-04T13:52:28.1409926Z     renders the body
2024-03-04T13:52:28.1410279Z 
2024-03-04T13:52:28.1410548Z TextInterpolatorService
2024-03-04T13:52:28.1411043Z   #call
2024-03-04T13:52:28.1445577Z     returns interpolated text
2024-03-04T13:52:28.1446277Z     when interpolations are not present
2024-03-04T13:52:28.1480752Z       returns text
2024-03-04T13:52:28.1481376Z     when interpolations are empty
2024-03-04T13:52:28.1512856Z       returns text
2024-03-04T13:52:28.1513515Z     when text is nil
2024-03-04T13:52:28.1546807Z       returns nil
2024-03-04T13:52:28.1547356Z     when text is empty
2024-03-04T13:52:28.1579261Z       returns empty string
2024-03-04T13:52:28.1579930Z     when interpolations are nil
2024-03-04T13:52:28.1614057Z       returns text
2024-03-04T13:52:28.1614730Z 
2024-03-04T13:52:28.1615078Z Exports::ExportDistributionsCSVService
2024-03-04T13:52:28.1615803Z   #generate_csv_data
2024-03-04T13:52:28.3357985Z     should match the expected content for the csv
2024-03-04T13:52:28.3358864Z     when a new item is added
2024-03-04T13:52:28.5132427Z       should add it to the end of the row
2024-03-04T13:52:28.7003999Z       should show up with a 0 quantity if there are none of this item in any distribution
2024-03-04T13:52:28.7004997Z     when there are no distributions but the report is requested
2024-03-04T13:52:28.8657087Z       returns a csv with only headers and no rows
2024-03-04T13:52:28.8657934Z 
2024-03-04T13:52:28.8658195Z Manufacturer
2024-03-04T13:52:28.8659915Z   versioning
2024-03-04T13:52:28.8735743Z     is expected to be versioned
2024-03-04T13:52:28.8736641Z   Validations
2024-03-04T13:52:28.8834345Z     must have a unique name within organization
2024-03-04T13:52:29.0611481Z     must belong to an organization
2024-03-04T13:52:29.0612529Z   Methods
2024-03-04T13:52:29.0613015Z     volume
2024-03-04T13:52:29.1938730Z       retrieves the amount of product that has been donated by manufacturer from multiple donations
2024-03-04T13:52:29.2582147Z       retrieves the amount of product that has been donated by manufacturer
2024-03-04T13:52:29.3903199Z       ignores the amount of product from other manufacturers
2024-03-04T13:52:29.3904419Z   Private Methods
2024-03-04T13:52:29.3904841Z     #exists_in_org?
2024-03-04T13:52:29.5621986Z       returns true if manufacturer exists in an organization
2024-03-04T13:52:29.5623094Z 
2024-03-04T13:52:29.5623375Z Distribution
2024-03-04T13:52:29.5624969Z   CSV export >
2024-03-04T13:52:29.5625525Z     for_csv_export >
2024-03-04T13:52:30.0628559Z       filters only to the given issue time range
2024-03-04T13:52:30.3858555Z       filters only to the given filter
2024-03-04T13:52:30.7147653Z       filters only to the given organization
2024-03-04T13:52:30.7148546Z     csv_export_attributes
2024-03-04T13:52:31.1115868Z       returns the set of attributes which define a row in case of distribution export
2024-03-04T13:52:31.1117051Z   behaves like itemizable
2024-03-04T13:52:31.1117999Z     .line_items
2024-03-04T13:52:31.1118477Z       sorted
2024-03-04T13:52:31.2284375Z         displays the items, sorted by name
2024-03-04T13:52:31.2285384Z       total
2024-03-04T13:52:31.3172415Z         has an item total
2024-03-04T13:52:31.3173377Z       quantities_by_name
2024-03-04T13:52:31.4059756Z         leaves out zero-quantitied items if requested
2024-03-04T13:52:31.4941454Z         returns a hash of items with id, name, and quantity
2024-03-04T13:52:31.4942615Z       combine!
2024-03-04T13:52:31.5499543Z         incrementally combines line_items on donations that have already been created
2024-03-04T13:52:31.5941933Z         combines multiple line_items with the same item_id into a single record
2024-03-04T13:52:31.5942867Z     .to_a
2024-03-04T13:52:31.5943508Z       with Flipper flag :deprecate_to_a enabled
2024-03-04T13:52:31.6292842Z         raises an error
2024-03-04T13:52:31.6293557Z       with Flipper flag :deprecate_to_a disabled
2024-03-04T13:52:31.6639789Z         calls line_item_values
2024-03-04T13:52:31.6640696Z   Callbacks >
2024-03-04T13:52:31.7164258Z     initializes the issued_at field to default to midnight if it wasn't explicitly set
2024-03-04T13:52:31.7165560Z     #before_save
2024-03-04T13:52:31.7166121Z       #reset_shipping_cost
2024-03-04T13:52:31.7167163Z         when delivery_method is other then shipped
2024-03-04T13:52:31.7431803Z           distribution will be created successfully and the shipping_cost will be zero
2024-03-04T13:52:31.7432865Z   Scopes >
2024-03-04T13:52:31.7433368Z     by_item_id >
2024-03-04T13:52:31.8753905Z       only returns distributions with given item id
2024-03-04T13:52:31.8754815Z     this_week >
2024-03-04T13:52:31.8755979Z       When it's Sunday (end of the week)
2024-03-04T13:52:31.9234492Z         doesn't include distributions past Sunday
2024-03-04T13:52:31.9235612Z       When it's Tuesday (mid-week)
2024-03-04T13:52:31.9953203Z         includes distributions as early as Monday and as late as upcoming Sunday
2024-03-04T13:52:31.9954279Z     by_location >
2024-03-04T13:52:32.0444014Z       only returns distributions with given location id
2024-03-04T13:52:32.0444795Z     by_partner >
2024-03-04T13:52:32.0952496Z       only returns distributions with given partner id
2024-03-04T13:52:32.0953360Z     during >
2024-03-04T13:52:32.1660954Z       returns all distributions created between two dates
2024-03-04T13:52:32.1661858Z   Methods >
2024-03-04T13:52:32.1662723Z     #copy_from_request
2024-03-04T13:52:32.1899824Z       copy over relevant request information into the distrubution
2024-03-04T13:52:32.1902081Z     #combine_duplicates
2024-03-04T13:52:32.2316265Z       condenses duplicate line_items if the item_ids match
2024-03-04T13:52:32.2317137Z     #copy_line_items
2024-03-04T13:52:32.2734729Z       replicates line_items from a donation into a distribution
2024-03-04T13:52:32.2735583Z     #distributed_at
2024-03-04T13:52:32.3191855Z       displays explicit issued_at date
2024-03-04T13:52:32.3446531Z       shows the hour and minutes if it has been provided
2024-03-04T13:52:32.3447383Z     #future?
2024-03-04T13:52:32.3448043Z       when issued_at has not passed
2024-03-04T13:52:32.3702608Z         returns true
2024-03-04T13:52:32.3703218Z       when issued_at has passed
2024-03-04T13:52:32.3958752Z         returns false
2024-03-04T13:52:32.3959326Z   versioning
2024-03-04T13:52:32.3994842Z     is expected to be versioned
2024-03-04T13:52:32.3995646Z   Validations >
2024-03-04T13:52:32.4047851Z     must belong to an organization
2024-03-04T13:52:32.4081753Z     ensures that any included items are found in the associated storage location
2024-03-04T13:52:32.4237310Z     ensures the associated line_items are invalid with a zero quantity
2024-03-04T13:52:32.4286931Z     requires a storage location
2024-03-04T13:52:32.4344547Z     ensures that the issued at is no earlier than 2000
2024-03-04T13:52:32.4498285Z     ensures the associated line_items are invalid with a nil quantity
2024-03-04T13:52:32.4548329Z     requires a partner
2024-03-04T13:52:32.4958629Z     ensures the associated line_items are valid
2024-03-04T13:52:32.4959440Z     when delivery method is other then shipped
2024-03-04T13:52:32.5220505Z       allows to save distribution
2024-03-04T13:52:32.5221384Z     when delivery method is shipped
2024-03-04T13:52:32.5222145Z       shipping cost is none negative
2024-03-04T13:52:32.5480953Z         allows to save distribution
2024-03-04T13:52:32.5481872Z       shipping cost is negative
2024-03-04T13:52:32.5539897Z         will not allow to save distribution
2024-03-04T13:52:32.5540980Z 
2024-03-04T13:52:32.5541273Z ProductDrive
2024-03-04T13:52:32.7032604Z   calculates donation quantity
2024-03-04T13:52:32.9250656Z   calculates and returns all donated organization item quantities by name and date
2024-03-04T13:52:33.4297288Z   calculates and returns all donated organization item quantities by category and date
2024-03-04T13:52:33.6445793Z   calculates donation quantity by date
2024-03-04T13:52:33.7835953Z   calculates in-kind value
2024-03-04T13:52:33.7836878Z   donation_source_view
2024-03-04T13:52:33.9194736Z     returns formatted text
2024-03-04T13:52:34.0589768Z   versioning
2024-03-04T13:52:34.0590710Z     is expected to be versioned
2024-03-04T13:52:34.0591652Z   scopes
2024-03-04T13:52:34.0592601Z     .by_item_category_id
2024-03-04T13:52:34.3870832Z       returns the product_drive with name some_name
2024-03-04T13:52:34.7118543Z       does not return other_name
2024-03-04T13:52:34.7119610Z     .by_name
2024-03-04T13:52:34.8552140Z       returns the product_drive with name some_name
2024-03-04T13:52:35.0011368Z       does not return other_name
2024-03-04T13:52:35.0012169Z     .within_date_range
2024-03-04T13:52:35.1380263Z       returns the product drive 1
2024-03-04T13:52:35.2827747Z       does not include product drive 2
2024-03-04T13:52:35.2828565Z   distinct_items
2024-03-04T13:52:35.6243169Z     counts the distinct items correctly by given category
2024-03-04T13:52:35.9732119Z     doesn't double_count the items if there are two donations for the same item
2024-03-04T13:52:36.3136627Z     counts the items correctly for 1 donation with multiple items
2024-03-04T13:52:36.6587315Z     counts the distinct items correctly by given date
2024-03-04T13:52:37.0135102Z     counts the distinct items correctly in overlapping donations
2024-03-04T13:52:37.0135868Z   .search_date_range
2024-03-04T13:52:37.1525367Z     is expected to eq {:end_date=>"2019-12-19", :start_date=>"2019-12-17"}
2024-03-04T13:52:37.1526150Z   associations
2024-03-04T13:52:37.2451267Z     has_many donations
2024-03-04T13:52:37.3292739Z     has_many product_drive_participants through donations
2024-03-04T13:52:37.3293337Z   validations
2024-03-04T13:52:37.4689069Z     is expected not to be valid
2024-03-04T13:52:37.6006085Z     is expected not to be valid
2024-03-04T13:52:37.7359422Z     is expected not to be valid
2024-03-04T13:52:37.7360044Z 
2024-03-04T13:52:37.7360874Z PartnerCreateService
2024-03-04T13:52:37.7362212Z   #call
2024-03-04T13:52:37.9251108Z     should return an instance of itself
2024-03-04T13:52:37.9252333Z     when the arguments are incorrect
2024-03-04T13:52:37.9253061Z       beacuse the partner_attrs are invalid
2024-03-04T13:52:38.1011574Z         should contain errors related to invalid partner attributes
2024-03-04T13:52:38.1012922Z     when the arguments are valid
2024-03-04T13:52:38.2899700Z       should create the associated partner profile data
2024-03-04T13:52:38.4700393Z       should create a new partner record with the organization provided
2024-03-04T13:52:38.4701278Z       but there was an unexpected issue with saving the
2024-03-04T13:52:38.4702061Z         Partners::Profile record
2024-03-04T13:52:38.6484205Z           should not create the partner record for the organization
2024-03-04T13:52:38.8264094Z           should not create the associated partner records
2024-03-04T13:52:38.8265213Z         Partner record
2024-03-04T13:52:39.0084400Z           should not create the associated partner records
2024-03-04T13:52:39.1899342Z           should not create the partner record for the organization
2024-03-04T13:52:39.1900075Z 
2024-03-04T13:52:39.1900290Z ItemsOutTotalQuery
2024-03-04T13:52:39.1900855Z   items_out_total_query
2024-03-04T13:52:39.3132920Z     returns a sum total of all out-flows
2024-03-04T13:52:39.3133482Z 
2024-03-04T13:52:39.3133701Z InventoryCheckService
2024-03-04T13:52:39.3134609Z   call
2024-03-04T13:52:39.3135198Z     alert
2024-03-04T13:52:39.3868485Z       should set the alert
2024-03-04T13:52:39.3869153Z     error
2024-03-04T13:52:39.4610602Z       should set the error
2024-03-04T13:52:39.4611165Z 
2024-03-04T13:52:39.4611654Z DistributionDestroyService
2024-03-04T13:52:39.4612718Z   #call
2024-03-04T13:52:39.4613894Z     when the distribution_id matches no Distribution
2024-03-04T13:52:39.4655131Z       to not be a success
2024-03-04T13:52:39.4655958Z     when the distribution_id does match a Distribution
2024-03-04T13:52:39.4656818Z       and the operations succeed
2024-03-04T13:52:39.6780065Z         should be successful
2024-03-04T13:52:39.8851716Z         should increase the inventory of the storage location
2024-03-04T13:52:40.0991527Z         should destroy the Distribution
2024-03-04T13:52:40.0992277Z       and the destroy! operation fails
2024-03-04T13:52:40.3108673Z         should not be successful and have the error message
2024-03-04T13:52:40.5061013Z         should not delete the Distribution
2024-03-04T13:52:40.5061917Z       and the increase inventory operations fails
2024-03-04T13:52:40.7166294Z         should not delete the Distribution
2024-03-04T13:52:40.9195355Z         should not be successful and have the error message
2024-03-04T13:52:40.9196362Z 
2024-03-04T13:52:40.9196676Z Reports::AcquisitionReportService
2024-03-04T13:52:40.9197438Z   acquisition report
2024-03-04T13:52:41.9064699Z     should return the proper results on #report
2024-03-04T13:52:41.9065376Z 
2024-03-04T13:52:41.9065764Z CustomDeviseMailer
2024-03-04T13:52:41.9066481Z   #invitation_instructions
2024-03-04T13:52:41.9067639Z     when partner is invited
2024-03-04T13:52:41.9541992Z       invites to primary user
2024-03-04T13:52:41.9542454Z     when user is invited
2024-03-04T13:52:41.9753034Z       invites to user
2024-03-04T13:52:41.9956411Z       has invite expiration message
2024-03-04T13:52:41.9957031Z     when other partner users invited
2024-03-04T13:52:42.0371651Z       invites to partner user
2024-03-04T13:52:42.0372437Z 
2024-03-04T13:52:42.0372752Z RequestDestroyService
2024-03-04T13:52:42.0373664Z   #call
2024-03-04T13:52:42.0496264Z     should return an instance of itself
2024-03-04T13:52:42.0497416Z     when there are no validation errors
2024-03-04T13:52:42.0627846Z       should update the status column on the request
2024-03-04T13:52:42.0744278Z       should send a email notification to the partner
2024-03-04T13:52:42.0868719Z       should update the discarded_at column on the request
2024-03-04T13:52:42.0869356Z     when the request_id matches no request
2024-03-04T13:52:42.1176947Z       should not be successful and have errors indicating request id is invalid
2024-03-04T13:52:42.1178006Z     when the request is already discarded
2024-03-04T13:52:42.1228373Z       should not be successful and have errors
2024-03-04T13:52:42.1229391Z     when the request's partner is deactivated
2024-03-04T13:52:42.1354737Z       should have errors
2024-03-04T13:52:42.1355771Z 
2024-03-04T13:52:42.1355974Z OrganizationMailer
2024-03-04T13:52:42.1357216Z   #partner_approval_request
2024-03-04T13:52:42.1637371Z     should be sent to the partner main email with the correct subject line
2024-03-04T13:52:42.1878047Z     renders the body with correct text with partner information
2024-03-04T13:52:42.2119687Z     includes a link to the relevant partner
2024-03-04T13:52:42.2120921Z 
2024-03-04T13:52:42.2121105Z StorageLocation
2024-03-04T13:52:42.2122746Z   Validations >
2024-03-04T13:52:42.2188753Z     is expected to validate that :name cannot be empty/falsy
2024-03-04T13:52:42.2244410Z     is expected to validate that :organization cannot be empty/falsy
2024-03-04T13:52:42.2305629Z     is expected to validate that :address cannot be empty/falsy
2024-03-04T13:52:42.2306166Z   Methods >
2024-03-04T13:52:42.2307647Z     item_total
2024-03-04T13:52:42.2715011Z       retrieves the total for a single item
2024-03-04T13:52:42.2715505Z     increase_inventory
2024-03-04T13:52:42.2716368Z       With existing inventory
2024-03-04T13:52:42.3783427Z         increases inventory quantities from an itemizable object
2024-03-04T13:52:42.3784326Z       when providing a new item that does not yet exist
2024-03-04T13:52:42.4843470Z         creates those new inventory items in the storage location
2024-03-04T13:52:42.4844251Z     geocode
2024-03-04T13:52:42.4955424Z       adds coordinates to the database
2024-03-04T13:52:42.4956050Z     import_csv
2024-03-04T13:52:42.5072161Z       imports storage locations from a csv file
2024-03-04T13:52:42.5072674Z     import_inventory
2024-03-04T13:52:42.9713316Z       imports storage locations from a csv file
2024-03-04T13:52:42.9714042Z     decrease_inventory
2024-03-04T13:52:43.0772042Z       decreases inventory quantities from an itemizable object
2024-03-04T13:52:43.0772629Z       when there is insufficient inventory available
2024-03-04T13:52:43.0859060Z         gives informative errors
2024-03-04T13:52:43.0937374Z         does not change inventory quantities if there is an error
2024-03-04T13:52:43.0938014Z     inventory_total_value_in_dollars
2024-03-04T13:52:43.1051765Z       returns 0 when there are no items in this storage location
2024-03-04T13:52:43.1437619Z       returns a value including cents if the total isn't an even dollar amount
2024-03-04T13:52:43.1947433Z       returns total value of all items in this storage location
2024-03-04T13:52:43.1948200Z     StorageLocation.items_inventoried
2024-03-04T13:52:43.2759667Z       returns a collection of items that are stored within inventories
2024-03-04T13:52:43.2760464Z     size
2024-03-04T13:52:43.3234018Z       returns total quantity of all items in this storage location
2024-03-04T13:52:43.3234791Z     csv_export_attributes
2024-03-04T13:52:43.3884681Z       returns an array of storage location attributes, followed by inventory item quantities that are sorted by alphabetized item names
2024-03-04T13:52:43.3885957Z   Callbacks >
2024-03-04T13:52:43.3886353Z     before_destroy
2024-03-04T13:52:43.4533693Z       deletes storage locations with no inventory items on it
2024-03-04T13:52:43.4918065Z       does not delete storage locations with inventory items on it
2024-03-04T13:52:43.4919474Z   Filtering >
2024-03-04T13:52:43.5629803Z     ->containing yields only inventories that have that item
2024-03-04T13:52:43.5716555Z     ->active_locations yields only storage locations that haven't been discarded
2024-03-04T13:52:43.5717325Z   versioning
2024-03-04T13:52:43.5751853Z     is expected to be versioned
2024-03-04T13:52:43.5752654Z 
2024-03-04T13:52:43.5753259Z AllocateKitInventoryService
2024-03-04T13:52:43.5754003Z   #allocate
2024-03-04T13:52:43.5754870Z     when more than one kit is requested
2024-03-04T13:52:43.5755522Z       but one of the items is out of stock
2024-03-04T13:52:43.8473904Z         returns error and does not change kit or item quantity
2024-03-04T13:52:43.8474707Z     when inventory items are available
2024-03-04T13:52:44.1081906Z       allocates items, increases the quantity of the Kit Item and inventory in, and decreases inventory out
2024-03-04T13:52:44.1083152Z       when there are more then one line items
2024-03-04T13:52:44.1083783Z         when there kit is allocated once
2024-03-04T13:52:44.3825154Z           inventory out for that kit contains both line_items with their respective quantity
2024-03-04T13:52:44.3826232Z         when same kit is allocated multiple times
2024-03-04T13:52:44.6798848Z           inventory out for that kit contains both line_items with their respective quantity
2024-03-04T13:52:44.6799904Z       When kit is allocated more then once
2024-03-04T13:52:44.9716771Z         increases the already existed inventory in and decreases the already existed inventory out
2024-03-04T13:52:44.9718199Z   #error
2024-03-04T13:52:44.9719158Z     when the Store location organization doesn't match
2024-03-04T13:52:45.1899014Z       returns error
2024-03-04T13:52:45.1899601Z 
2024-03-04T13:52:45.1899972Z ReminderDeadlineMailer
2024-03-04T13:52:45.1901099Z   notify deadline
2024-03-04T13:52:45.2200832Z     renders the sender email
2024-03-04T13:52:45.2473077Z     renders the subject
2024-03-04T13:52:45.2743629Z     renders the receiver email
2024-03-04T13:52:45.3014315Z     renders the body
2024-03-04T13:52:45.3015050Z 
2024-03-04T13:52:45.3016484Z Reports::SummaryReportService
2024-03-04T13:52:45.3016895Z   #report
2024-03-04T13:52:45.7723900Z     should report positive values
2024-03-04T13:52:45.9523000Z     should report zero values
2024-03-04T13:52:46.4121588Z     should report negative values
2024-03-04T13:52:46.4122187Z 
2024-03-04T13:52:46.4122438Z PartnerGroup
2024-03-04T13:52:46.4123932Z   Validations >
2024-03-04T13:52:46.4226195Z     requires a unique name within an organization
2024-03-04T13:52:46.4266730Z     must belong to an organization
2024-03-04T13:52:46.4497226Z     does not require a unique name between organizations
2024-03-04T13:52:46.4498195Z     deadline_day && reminder_day must be defined if send_reminders=true
2024-03-04T13:52:46.4545471Z       should not be valid
2024-03-04T13:52:46.4545996Z   versioning
2024-03-04T13:52:46.4579990Z     is expected to be versioned
2024-03-04T13:52:46.4580553Z   DB constraints
2024-03-04T13:52:46.4581281Z     send_reminders IS NOT NULL
2024-03-04T13:52:46.4649091Z       raises error if unmet
2024-03-04T13:52:46.4649616Z     reminder_day <= 28
2024-03-04T13:52:46.4715303Z       raises error if unmet
2024-03-04T13:52:46.4715830Z     deadline_day <= 28
2024-03-04T13:52:46.4781098Z       raises error if unmet
2024-03-04T13:52:46.4781608Z   associations
2024-03-04T13:52:46.4829403Z     is expected to belong to organization required: true
2024-03-04T13:52:46.4863118Z     is expected to have many partners
2024-03-04T13:52:46.4920266Z     is expected to have and belong to many item_categories
2024-03-04T13:52:46.4920832Z 
2024-03-04T13:52:46.4921041Z UserInviteService
2024-03-04T13:52:46.5873753Z   should invite a user with the partner role
2024-03-04T13:52:46.7801109Z   should create the user without a name with default role
2024-03-04T13:52:46.7801873Z   with a new user
2024-03-04T13:52:46.8079095Z     should create the user without name with role
2024-03-04T13:52:47.0032050Z     should create the user with roles
2024-03-04T13:52:47.0032539Z   with existing user
2024-03-04T13:52:47.2034687Z     should add roles to existing user
2024-03-04T13:52:47.2128739Z     should raise an error when reinviting an existing user with the same role
2024-03-04T13:52:47.2129616Z     with force: true
2024-03-04T13:52:47.2335808Z       should reinvite the user
2024-03-04T13:52:47.2336758Z 
2024-03-04T13:52:47.2337104Z PartnerRequestRecertificationService
2024-03-04T13:52:47.2338062Z   #call
2024-03-04T13:52:47.2341410Z     when the arguments are incorrect
2024-03-04T13:52:47.2342202Z       because the partner has already been requested to recertify
2024-03-04T13:52:47.2628962Z         should return the PartnerRequestRecertificationService object with an error
2024-03-04T13:52:47.2629978Z     when the partner is deactivated
2024-03-04T13:52:47.2911452Z       does not send an email
2024-03-04T13:52:47.2912041Z     when the arguments are correct
2024-03-04T13:52:47.3193442Z       should queue sending the notice to the partner
2024-03-04T13:52:47.3492851Z       should change the partner status to approved
2024-03-04T13:52:47.3772979Z       should have no errors
2024-03-04T13:52:47.3773544Z       but a unexpected error occurred during the save
2024-03-04T13:52:47.3774196Z         for partner approval
2024-03-04T13:52:47.4030614Z           should not change the partner status to recertification_required
2024-03-04T13:52:47.4273225Z           should NOT queue sending the notice to the partner
2024-03-04T13:52:47.4515334Z           should have an error with the raised error
2024-03-04T13:52:47.4516395Z 
2024-03-04T13:52:47.4516585Z ItemsInTotalQuery
2024-03-04T13:52:47.4517520Z   items_in_total_query
2024-03-04T13:52:47.6685665Z     does not count transfers going in the negative direction
2024-03-04T13:52:47.8235855Z     returns a sum total of all in-flows
2024-03-04T13:52:48.0251216Z     does not count negative adjustments towards in-flow
2024-03-04T13:52:48.2908571Z     does not count donations, purchases, adjustments to other storage locations
2024-03-04T13:52:48.6306539Z     counts shared items together
2024-03-04T13:52:48.6307320Z 
2024-03-04T13:52:48.6307495Z DonationsController
2024-03-04T13:52:48.6309446Z   While signed in as an organization admin >
2024-03-04T13:52:48.6310023Z     DELETE #destroy
2024-03-04T13:52:48.6642831Z       redirects to the index
2024-03-04T13:52:48.6643372Z   calculating total value of multiple donations
2024-03-04T13:52:48.6682444Z     returns zero for an empty array of donations
2024-03-04T13:52:48.7936209Z     works correctly for multiple line items per donation
2024-03-04T13:52:48.7937084Z   calculating total money raised for all donations
2024-03-04T13:52:48.7976306Z     returns zero for an empty array of donations
2024-03-04T13:52:48.8100655Z     correctly calculates the total
2024-03-04T13:52:48.8101646Z   While signed in as a normal user >
2024-03-04T13:52:48.8102738Z     PUT#update
2024-03-04T13:52:48.9148681Z       updates storage quantity correctly
2024-03-04T13:52:48.9292966Z       redirects to index after update (FAILED - 1)
2024-03-04T13:52:48.9293536Z       when changing storage location
2024-03-04T13:52:48.9330635Z         rolls back updates if quantity would go below 0
2024-03-04T13:52:49.0304218Z         updates storage quantity correctly
2024-03-04T13:52:49.0304942Z       when removing a line item
2024-03-04T13:52:49.1275965Z         updates storage invetory item quantity correctly
2024-03-04T13:52:49.1276729Z     GET #new
2024-03-04T13:52:49.1417728Z       returns http success
2024-03-04T13:52:49.1418243Z     GET #edit
2024-03-04T13:52:49.1591667Z       returns http success
2024-03-04T13:52:49.1592148Z     DELETE #destroy
2024-03-04T13:52:49.1741339Z       redirects to the dashboard path
2024-03-04T13:52:49.1741813Z     POST#create
2024-03-04T13:52:49.1880328Z       redirects to GET#edit on success (FAILED - 2)
2024-03-04T13:52:49.1966223Z       renders GET#new with error on failure (FAILED - 3)
2024-03-04T13:52:49.1966729Z     GET #show
2024-03-04T13:52:49.2134778Z       returns http success
2024-03-04T13:52:49.2135163Z     GET #index
2024-03-04T13:52:49.2280083Z       returns http success
2024-03-04T13:52:49.2281088Z 
2024-03-04T13:52:49.2281318Z Request
2024-03-04T13:52:49.2282693Z   total_items
2024-03-04T13:52:49.2386256Z     adds the quantity of all items in the request
2024-03-04T13:52:49.2386937Z   item data
2024-03-04T13:52:49.2465534Z     coerces item quantity and id to always be an integer before saving
2024-03-04T13:52:49.2466044Z   versioning
2024-03-04T13:52:49.2504101Z     is expected to be versioned
2024-03-04T13:52:49.2504773Z   Enums >
2024-03-04T13:52:49.2505206Z     #status
2024-03-04T13:52:49.2703776Z       scopes
2024-03-04T13:52:49.2704514Z 
2024-03-04T13:52:49.2704703Z DistributionReminder
2024-03-04T13:52:49.2705622Z   conditionally sending the emails
2024-03-04T13:52:49.2996522Z     does not send mail for future distributions if the partner wants no reminders
2024-03-04T13:52:49.3266303Z     does not send mail for past distributions
2024-03-04T13:52:49.3543794Z     sends mail for future distributions where the partner wants reminders
2024-03-04T13:52:49.3823366Z     sends mail for future distributions
2024-03-04T13:52:49.3824231Z     when the partner is deactivated
2024-03-04T13:52:49.4112570Z       does not send mail
2024-03-04T13:52:49.4113230Z     when the distribution_id does not match any Distribution
2024-03-04T13:52:49.4159997Z       does not send mail for non existent distributions
2024-03-04T13:52:49.4161040Z 
2024-03-04T13:52:49.4161318Z Partners::FetchPartnersToRemindNowService
2024-03-04T13:52:49.4162096Z   .fetch
2024-03-04T13:52:49.4163079Z     when there is a partner
2024-03-04T13:52:49.4164022Z       that has an organization with a global reminder & deadline
2024-03-04T13:52:49.4165050Z         AND a partner group that does have them defined
2024-03-04T13:52:49.4547389Z           should remind based on the partner group instead of the organization level reminder
2024-03-04T13:52:49.4548375Z           but the partner is deactivated
2024-03-04T13:52:49.4952497Z             should NOT include that partner
2024-03-04T13:52:49.4953140Z         that is for today
2024-03-04T13:52:49.5250268Z           should include that partner
2024-03-04T13:52:49.5250868Z           and has send_reminder=false
2024-03-04T13:52:49.5598211Z             should NOT include that partner
2024-03-04T13:52:49.5598893Z           but the partner is deactivated
2024-03-04T13:52:49.5927241Z             should NOT include that partner
2024-03-04T13:52:49.5927809Z         that is not for today
2024-03-04T13:52:49.6226724Z           should NOT include that partner
2024-03-04T13:52:49.6227593Z       that does NOT have a organization with a global reminder & deadline
2024-03-04T13:52:49.6228597Z         and is a part of a partner group that does have them defined
2024-03-04T13:52:49.6229687Z           that is not for today
2024-03-04T13:52:49.6575454Z             should NOT include that partner
2024-03-04T13:52:49.6576095Z           that is for today
2024-03-04T13:52:49.6908206Z             should include that partner
2024-03-04T13:52:49.6908859Z             but the partner is deactivated
2024-03-04T13:52:49.7286611Z               should NOT include that partner
2024-03-04T13:52:49.7288112Z 
2024-03-04T13:52:49.7288351Z DistributionByCountyReportService
2024-03-04T13:52:49.7289276Z   get_breakdown
2024-03-04T13:52:49.8033142Z     will have 100% unspecified shows if no served_areas
2024-03-04T13:52:49.9841840Z     handles multiple partners with overlapping service areas properly
2024-03-04T13:52:50.0657786Z     divides the item numbers and values according to the partner profile
2024-03-04T13:52:50.0658469Z 
2024-03-04T13:52:50.0658682Z Partners::ServedArea
2024-03-04T13:52:50.0898910Z   must only allow valid client share values
2024-03-04T13:52:50.1034412Z   must only allow integer client shares
2024-03-04T13:52:50.1077885Z   is expected to belong to partner_profile required: true
2024-03-04T13:52:50.1117232Z   is expected to belong to county required: true
2024-03-04T13:52:50.1117708Z   versioning
2024-03-04T13:52:50.1150982Z     is expected to be versioned
2024-03-04T13:52:50.1152426Z 
2024-03-04T13:52:50.1152701Z ItemsController
2024-03-04T13:52:50.1153921Z   While not signed in
2024-03-04T13:52:50.1238047Z     redirects the user to the sign-in page for CRUD actions
2024-03-04T13:52:50.1238521Z   While signed in
2024-03-04T13:52:50.1240261Z     DELETE #destroy
2024-03-04T13:52:50.1477317Z       redirects to #index
2024-03-04T13:52:50.1477755Z     GET #show
2024-03-04T13:52:50.1666469Z       returns http success
2024-03-04T13:52:50.1667108Z     PATCH #remove_category
2024-03-04T13:52:50.3562953Z       should remove an item's category
2024-03-04T13:52:50.5596322Z       should redirect to the previous category page
2024-03-04T13:52:50.5596807Z     PATCH #restore
2024-03-04T13:52:50.5597776Z       with another organizations item
2024-03-04T13:52:50.7444083Z         does nothing
2024-03-04T13:52:50.7444475Z       with an active item
2024-03-04T13:52:50.7657128Z         does nothing
2024-03-04T13:52:50.7657852Z       with a soft-deleted item
2024-03-04T13:52:50.7868524Z         re-activates the item
2024-03-04T13:52:50.7869062Z     GET #new
2024-03-04T13:52:50.7985722Z       returns http success
2024-03-04T13:52:50.7986320Z     PUT #update
2024-03-04T13:52:50.7986850Z       invisible
2024-03-04T13:52:50.8185247Z         should update visible_to_partners to false
2024-03-04T13:52:50.8185902Z       visible
2024-03-04T13:52:50.8373966Z         should update visible_to_partners to true
2024-03-04T13:52:50.8374659Z     Looking at a different organization
2024-03-04T13:52:51.0104027Z       redirects the user to the sign-in page for CRUD actions
2024-03-04T13:52:51.0104646Z     GET #index
2024-03-04T13:52:51.0285904Z       returns http success
2024-03-04T13:52:51.0286404Z     POST #create
2024-03-04T13:52:51.0287144Z       with valid params
2024-03-04T13:52:51.0464944Z         should accept params with dollar signs, periods, and commas
2024-03-04T13:52:51.0648091Z         should create an item
2024-03-04T13:52:51.0824135Z         should redirect to the item page
2024-03-04T13:52:51.0824605Z       with invalid params
2024-03-04T13:52:51.0969791Z         should show an error
2024-03-04T13:52:51.0970315Z     GET #edit
2024-03-04T13:52:51.1127669Z       returns http success
2024-03-04T13:52:51.1129777Z 
2024-03-04T13:52:51.1129919Z Donation
2024-03-04T13:52:51.1131711Z   versioning
2024-03-04T13:52:51.1167976Z     is expected to be versioned
2024-03-04T13:52:51.1168544Z   SOURCES
2024-03-04T13:52:51.1203810Z     the hash values are immutable
2024-03-04T13:52:51.1236896Z     is a hash that is referenceable by key to avoid 'magic strings'
2024-03-04T13:52:51.1270345Z     the hash is immutable
2024-03-04T13:52:51.1270868Z   Validations >
2024-03-04T13:52:51.1419881Z     is invalid when the line items are invalid
2024-03-04T13:52:51.1544588Z     requires a product drive participant if the source is 'Product Drive'
2024-03-04T13:52:51.1589248Z     must belong to an organization
2024-03-04T13:52:51.1639186Z     ensures that the issued at is no earlier than 2000
2024-03-04T13:52:51.1749907Z     requires a donation_site if the source is 'Donation Site'
2024-03-04T13:52:51.1866222Z     requires a manufacturer if the source is 'Manufacturer'
2024-03-04T13:52:51.1928504Z     requires a source from the list of available sources
2024-03-04T13:52:51.1970772Z     requires an inventory (storage location)
2024-03-04T13:52:51.1971404Z   Scopes >
2024-03-04T13:52:51.1972085Z     by_source >
2024-03-04T13:52:51.1973069Z       when source is not a symbol
2024-03-04T13:52:51.1974044Z         when source comes from the SOURCES hash
2024-03-04T13:52:51.2146889Z           returns all donations with the provided source
2024-03-04T13:52:51.2147628Z         when source is invalid
2024-03-04T13:52:51.2315912Z           does not throw errors, returns no results
2024-03-04T13:52:51.2316502Z       when source is a symbol
2024-03-04T13:52:51.2317261Z         when source is invalid
2024-03-04T13:52:51.2488614Z           does not throw errors, returns no results
2024-03-04T13:52:51.2489315Z         when source is valid
2024-03-04T13:52:51.2664610Z           allows a symbol as an argument, referencing the SOURCES hash
2024-03-04T13:52:51.2665228Z     during >
2024-03-04T13:52:51.2844407Z       returns all donations created between two dates
2024-03-04T13:52:51.2845145Z   Associations >
2024-03-04T13:52:51.2845620Z     items >
2024-03-04T13:52:51.3010586Z       has_many
2024-03-04T13:52:51.3011028Z   Methods >
2024-03-04T13:52:51.3012525Z     money_raised
2024-03-04T13:52:51.3590722Z       tracks the money raised in a donation
2024-03-04T13:52:51.3591546Z     remove
2024-03-04T13:52:51.4152143Z       works with either an id or an object
2024-03-04T13:52:51.4764361Z       removes the item from the donation
2024-03-04T13:52:51.5410347Z       fails gracefully if the item doesn't exist
2024-03-04T13:52:51.5411025Z     source_view
2024-03-04T13:52:51.5411580Z       not from a drive
2024-03-04T13:52:51.5514617Z         returns source
2024-03-04T13:52:51.5515108Z       from a drive
2024-03-04T13:52:51.5515691Z         unknown participant
2024-03-04T13:52:51.5615784Z           returns drive display name
2024-03-04T13:52:51.5616398Z         participant known
2024-03-04T13:52:51.5617034Z           no contact name
2024-03-04T13:52:51.5737006Z             returns drive display name
2024-03-04T13:52:51.5737642Z           contact name present
2024-03-04T13:52:51.5857940Z             returns participant display name
2024-03-04T13:52:51.5858584Z       details
2024-03-04T13:52:51.5859799Z         misc
2024-03-04T13:52:51.6015121Z           returns a truncated comment
2024-03-04T13:52:51.6015726Z         manufacturer
2024-03-04T13:52:51.6129893Z           returns manufacturer name
2024-03-04T13:52:51.6130468Z         donation site
2024-03-04T13:52:51.6191662Z           returns donation_site name (FAILED - 4)
2024-03-04T13:52:51.6192471Z         product drive
2024-03-04T13:52:51.6294605Z           returns product_drive name
2024-03-04T13:52:51.6295499Z   behaves like itemizable
2024-03-04T13:52:51.6296660Z     .to_a
2024-03-04T13:52:51.6297758Z       with Flipper flag :deprecate_to_a disabled
2024-03-04T13:52:51.6643288Z         calls line_item_values
2024-03-04T13:52:51.6643962Z       with Flipper flag :deprecate_to_a enabled
2024-03-04T13:52:51.6974973Z         raises an error
2024-03-04T13:52:51.6975527Z     .line_items
2024-03-04T13:52:51.6979064Z       total
2024-03-04T13:52:51.7307992Z         has an item total
2024-03-04T13:52:51.7308503Z       sorted
2024-03-04T13:52:51.7793279Z         displays the items, sorted by name
2024-03-04T13:52:51.7793794Z       combine!
2024-03-04T13:52:51.8178067Z         combines multiple line_items with the same item_id into a single record
2024-03-04T13:52:51.8640613Z         incrementally combines line_items on donations that have already been created
2024-03-04T13:52:51.8641933Z       quantities_by_name
2024-03-04T13:52:51.8982022Z         returns a hash of items with id, name, and quantity
2024-03-04T13:52:51.9333221Z         leaves out zero-quantitied items if requested
2024-03-04T13:52:51.9333945Z   Callbacks >
2024-03-04T13:52:51.9465418Z     inititalizes the issued_at field to default to midnight if it wasn't explicitly set
2024-03-04T13:52:51.9628361Z     automatically combines duplicate line_item records when they're created
2024-03-04T13:52:51.9636674Z 
2024-03-04T13:52:51.9636963Z ItemizableUpdateService
2024-03-04T13:52:51.9638480Z   decreases
2024-03-04T13:52:52.0982406Z     should update quantity in different locations
2024-03-04T13:52:52.2085046Z     should raise an error if any item is inactive
2024-03-04T13:52:52.3423215Z     should update quantity in same storage location
2024-03-04T13:52:52.3423944Z   increases
2024-03-04T13:52:52.4819399Z     should update quantity in different locations
2024-03-04T13:52:52.5716980Z     should raise an error if any item is inactive
2024-03-04T13:52:52.7017079Z     should update quantity in same storage location
2024-03-04T13:52:52.7017686Z 
2024-03-04T13:52:52.7018132Z OrganizationUpdateService
2024-03-04T13:52:52.7019073Z   #update
2024-03-04T13:52:52.7020036Z     when organization has partners
2024-03-04T13:52:52.7021361Z       when all of a single partner's request flags will be disabled
2024-03-04T13:52:52.9250085Z         should NOT change request flags in organization or its partners
2024-03-04T13:52:53.1395214Z         should add an error message to the organization
2024-03-04T13:52:53.1396490Z       when all of a single partner's request flags WILL NOT be disabled
2024-03-04T13:52:53.3678590Z         should allow the disabling of request flags in organization and its partners
2024-03-04T13:52:53.3679390Z     when object is invalid
2024-03-04T13:52:53.5442413Z       should not update and return false
2024-03-04T13:52:53.5443073Z     when object is valid
2024-03-04T13:52:53.7228314Z       should update and return true
2024-03-04T13:52:53.7228983Z   #update_partner_flags
2024-03-04T13:52:53.7229888Z     when request flags have changed
2024-03-04T13:52:53.9421356Z       should NOT update partners' request flags when enabling request flags on the organization
2024-03-04T13:52:54.1676731Z       should update partners when disabling quantity-based request flags
2024-03-04T13:52:54.3919904Z       should update partners when disabling child and individual request flags
2024-03-04T13:52:54.3920898Z     when request flags haven't changed
2024-03-04T13:52:54.6052176Z       should not update partners
2024-03-04T13:52:54.6055160Z 
2024-03-04T13:52:54.6055302Z User
2024-03-04T13:52:54.6116072Z   has a valid factory
2024-03-04T13:52:54.6116623Z   omniauth
2024-03-04T13:52:54.6248609Z     retrieves the user from an omniauth context
2024-03-04T13:52:54.6249248Z   Methods >
2024-03-04T13:52:54.6712809Z     #kind
2024-03-04T13:52:54.6789533Z     #reinvitable?
2024-03-04T13:52:54.6840020Z     discarded?
2024-03-04T13:52:54.6917936Z     #invitation_status
2024-03-04T13:52:54.6918492Z   Scopes >
2024-03-04T13:52:54.6919260Z     ->alphabetized
2024-03-04T13:52:54.7308899Z       retrieves users in the correct order
2024-03-04T13:52:54.7309553Z   Validations >
2024-03-04T13:52:54.7493744Z     requires an email that is formatted correctly
2024-03-04T13:52:54.7580820Z     requires a name
2024-03-04T13:52:54.7581295Z   versioning
2024-03-04T13:52:54.7616010Z     is expected to be versioned
2024-03-04T13:52:54.7616583Z   Scopes >
2024-03-04T13:52:54.7617114Z     ->alphabetized
2024-03-04T13:52:54.7838406Z       retrieves users in the correct order
2024-03-04T13:52:54.8293095Z W, [2024-03-04T05:52:54.829059 #2315]  WARN -- : [knapsack_pro] POST https://api-disabled-for-fork.knapsackpro.com/v1/build_subsets
2024-03-04T13:52:54.8295198Z W, [2024-03-04T05:52:54.829105 #2315]  WARN -- : [knapsack_pro] Request failed due to:
2024-03-04T13:52:54.8297739Z W, [2024-03-04T05:52:54.829129 #2315]  WARN -- : [knapsack_pro] #<SocketError: Failed to open TCP connection to api-disabled-for-fork.knapsackpro.com:443 (getaddrinfo: Name or service not known)>
2024-03-04T13:52:54.8299942Z W, [2024-03-04T05:52:54.829159 #2315]  WARN -- : [knapsack_pro] Time execution report was not saved on Knapsack Pro API server due to connection problem.
2024-03-04T13:52:55.0606698Z 
2024-03-04T13:52:55.0608782Z Failures:
2024-03-04T13:52:55.0609744Z 
2024-03-04T13:52:55.0610630Z   1) DonationsController While signed in as a normal user > PUT#update redirects to index after update
2024-03-04T13:52:55.0611958Z      Failure/Error: donation = create(:donation_site_donation)
2024-03-04T13:52:55.0612672Z 
2024-03-04T13:52:55.0613073Z      ActiveRecord::RecordInvalid:
2024-03-04T13:52:55.0616913Z        Validation failed: Contact name can't be blank, Email can't be blank, Email is invalid, Phone can't be blank, Phone must be a valid phone number
2024-03-04T13:52:55.0620734Z      # ./spec/controllers/donations_controller_spec.rb:50:in `block (4 levels) in <top (required)>'
2024-03-04T13:52:55.0621584Z 
2024-03-04T13:52:55.0622237Z   2) DonationsController While signed in as a normal user > POST#create redirects to GET#edit on success
2024-03-04T13:52:55.0623526Z      Failure/Error: let!(:donation_site) { create(:donation_site) }
2024-03-04T13:52:55.0624513Z 
2024-03-04T13:52:55.0624721Z      ActiveRecord::RecordInvalid:
2024-03-04T13:52:55.0626254Z        Validation failed: Contact name can't be blank, Email can't be blank, Email is invalid, Phone can't be blank, Phone must be a valid phone number
2024-03-04T13:52:55.0628000Z      # ./spec/controllers/donations_controller_spec.rb:28:in `block (4 levels) in <top (required)>'
2024-03-04T13:52:55.0628807Z 
2024-03-04T13:52:55.0629489Z   3) DonationsController While signed in as a normal user > POST#create renders GET#new with error on failure
2024-03-04T13:52:55.0630742Z      Failure/Error: let!(:donation_site) { create(:donation_site) }
2024-03-04T13:52:55.0631520Z 
2024-03-04T13:52:55.0631722Z      ActiveRecord::RecordInvalid:
2024-03-04T13:52:55.0633209Z        Validation failed: Contact name can't be blank, Email can't be blank, Email is invalid, Phone can't be blank, Phone must be a valid phone number
2024-03-04T13:52:55.0634904Z      # ./spec/controllers/donations_controller_spec.rb:28:in `block (4 levels) in <top (required)>'
2024-03-04T13:52:55.0635713Z 
2024-03-04T13:52:55.0636182Z   4) Donation Methods > source_view details donation site returns donation_site name
2024-03-04T13:52:55.0637212Z      Failure/Error: let(:donation_site) { create(:donation_site) }
2024-03-04T13:52:55.0637775Z 
2024-03-04T13:52:55.0637965Z      ActiveRecord::RecordInvalid:
2024-03-04T13:52:55.0639423Z        Validation failed: Contact name can't be blank, Email can't be blank, Email is invalid, Phone can't be blank, Phone must be a valid phone number
2024-03-04T13:52:55.0641008Z      # ./spec/models/donation_spec.rb:247:in `block (6 levels) in <top (required)>'
2024-03-04T13:52:55.0642122Z      # ./spec/models/donation_spec.rb:248:in `block (6 levels) in <top (required)>'
2024-03-04T13:52:55.0643228Z      # ./spec/models/donation_spec.rb:251:in `block (6 levels) in <top (required)>'
2024-03-04T13:52:55.0643917Z 
2024-03-04T13:52:55.0644214Z Finished in 57 seconds (files took 8.31 seconds to load)
2024-03-04T13:52:55.0644888Z 579 examples, 4 failures
2024-03-04T13:52:55.0645196Z 
2024-03-04T13:52:55.0645346Z Failed examples:
2024-03-04T13:52:55.0645593Z 
2024-03-04T13:52:55.0646658Z rspec ./spec/controllers/donations_controller_spec.rb:49 # DonationsController While signed in as a normal user > PUT#update redirects to index after update
2024-03-04T13:52:55.0648988Z rspec ./spec/controllers/donations_controller_spec.rb:31 # DonationsController While signed in as a normal user > POST#create redirects to GET#edit on success
2024-03-04T13:52:55.0651342Z rspec ./spec/controllers/donations_controller_spec.rb:41 # DonationsController While signed in as a normal user > POST#create renders GET#new with error on failure
2024-03-04T13:52:55.0653647Z rspec ./spec/models/donation_spec.rb:250 # Donation Methods > source_view details donation site returns donation_site name
2024-03-04T13:52:55.0654652Z 
2024-03-04T13:52:55.0654826Z Randomized with seed 29987
2024-03-04T13:52:55.0655145Z 
2024-03-04T13:52:55.3881576Z Stopped processing SimpleCov as a previous error not related to SimpleCov has been detected
2024-03-04T13:52:55.3883889Z Coverage report generated for RSpec to /home/runner/work/human-essentials/human-essentials/coverage. 3975 / 6439 LOC (61.73%) covered.
2024-03-04T13:52:55.4472725Z /opt/hostedtoolcache/Ruby/3.2.2/x64/bin/ruby -I/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/lib:/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-support-3.12.1/lib /home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/exe/rspec  --format documentation --format KnapsackPro::Formatters::TimeTracker --default-path spec "spec/models/account_request_spec.rb" "spec/models/audit_spec.rb" "spec/models/base_item_spec.rb" "spec/models/concerns/deadlinable_spec.rb" "spec/models/distribution_spec.rb" "spec/models/donation_spec.rb" "spec/models/inventory_item_spec.rb" "spec/models/item_spec.rb" "spec/models/kit_spec.rb" "spec/models/manufacturer_spec.rb" "spec/models/organization_spec.rb" "spec/models/partner_group_spec.rb" "spec/models/partners/authorized_family_member_spec.rb" "spec/models/partners/child_spec.rb" "spec/models/partners/item_request_spec.rb" "spec/models/partners/served_area_spec.rb" "spec/models/product_drive_spec.rb" "spec/models/question_spec.rb" "spec/models/request_spec.rb" "spec/models/storage_location_spec.rb" "spec/models/user_spec.rb" "spec/models/vendor_spec.rb" "spec/controllers/admins_controller_spec.rb" "spec/controllers/distributions_controller_spec.rb" "spec/controllers/donations_controller_spec.rb" "spec/controllers/items_controller_spec.rb" "spec/events/event_differ_spec.rb" "spec/helpers/application_helper_spec.rb" "spec/helpers/product_drive_helper_spec.rb" "spec/jobs/historical_data_cache_job_spec.rb" "spec/jobs/partner_mailer_job_spec.rb" "spec/lib/dispersed_past_dates_generator_spec.rb" "spec/mailers/custom_devise_mailer_spec.rb" "spec/mailers/organization_mailer_spec.rb" "spec/mailers/reminder_deadline_mailer_spec.rb" "spec/mailers/requests_confirmation_mailer_spec.rb" "spec/pdfs/distribution_pdf_spec.rb" "spec/queries/items_in_total_query_spec.rb" "spec/queries/items_out_total_query_spec.rb" "spec/services/add_role_service_spec.rb" "spec/services/allocate_kit_inventory_service_spec.rb" "spec/services/deadline_service_spec.rb" "spec/services/distribution_content_change_service_spec.rb" "spec/services/distribution_destroy_service_spec.rb" "spec/services/distribution_reminder_spec.rb" "spec/services/distributions_by_county_report_service_spec.rb" "spec/services/donation_destroy_service_spec.rb" "spec/services/exports/export_distributions_csv_service_spec.rb" "spec/services/exports/export_purchases_csv_service_spec.rb" "spec/services/exports/export_request_service_spec.rb" "spec/services/inventory_check_service_spec.rb" "spec/services/itemizable_update_service_spec.rb" "spec/services/organization_update_service_spec.rb" "spec/services/partner_create_service_spec.rb" "spec/services/partner_invite_service_spec.rb" "spec/services/partner_request_recertification_service_spec.rb" "spec/services/partners/fetch_partners_to_remind_now_service_spec.rb" "spec/services/partners/request_create_service_spec.rb" "spec/services/profile_update_service_spec.rb" "spec/services/reports/acquisition_report_service_spec.rb" "spec/services/reports/children_served_report_service_spec.rb" "spec/services/reports/partner_info_report_service_spec.rb" "spec/services/reports/summary_report_service_spec.rb" "spec/services/request_destroy_service_spec.rb" "spec/services/service_object_errors_mixin_spec.rb" "spec/services/text_interpolator_service_spec.rb" "spec/services/user_invite_service_spec.rb" failed
2024-03-04T13:52:55.8354244Z Stopped processing SimpleCov as a previous error not related to SimpleCov has been detected
2024-03-04T13:52:55.8356440Z Coverage report generated for RSpec to /home/runner/work/human-essentials/human-essentials/coverage. 38 / 10703 LOC (0.36%) covered.
2024-03-04T13:52:55.8623723Z ##[error]Process completed with exit code 1.
