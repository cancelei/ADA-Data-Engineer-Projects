2024-02-25T15:12:55.0995890Z ##[group]Run RUBYOPT='-W:no-deprecated -W:no-experimental' bin/knapsack_pro_rspec
2024-02-25T15:12:55.0996812Z [36;1mRUBYOPT='-W:no-deprecated -W:no-experimental' bin/knapsack_pro_rspec[0m
2024-02-25T15:12:55.1024791Z shell: /usr/bin/bash -e {0}
2024-02-25T15:12:55.1025182Z env:
2024-02-25T15:12:55.1025698Z   POSTGRES_HOST: localhost
2024-02-25T15:12:55.1026110Z   DATABASE_HOST: localhost
2024-02-25T15:12:55.1026450Z   PG_USERNAME: postgres
2024-02-25T15:12:55.1026935Z   PG_PASSWORD: password
2024-02-25T15:12:55.1027331Z   POSTGRES_HOST_AUTH_METHOD: trust
2024-02-25T15:12:55.1027807Z   POSTGRES_PORT: 5432
2024-02-25T15:12:55.1028183Z   PGHOST: localhost
2024-02-25T15:12:55.1028520Z   PGUSER: postgres
2024-02-25T15:12:55.1028928Z   RAILS_ENV: test
2024-02-25T15:12:55.1029528Z   KNAPSACK_PRO_TEST_SUITE_TOKEN_RSPEC: ***
2024-02-25T15:12:55.1029947Z   KNAPSACK_PRO_CI_NODE_TOTAL: 2
2024-02-25T15:12:55.1030470Z   KNAPSACK_PRO_CI_NODE_INDEX: 1
2024-02-25T15:12:55.1030916Z   KNAPSACK_PRO_RSPEC_SPLIT_BY_TEST_EXAMPLES: true
2024-02-25T15:12:55.1031582Z   KNAPSACK_PRO_LOG_LEVEL: info
2024-02-25T15:12:55.1032468Z   KNAPSACK_PRO_TEST_FILE_EXCLUDE_PATTERN: {spec/system/**{,/*/**}/*_spec.rb,spec/requests/**{,/*/**}/*_spec.rb}
2024-02-25T15:12:55.1033151Z   EVENTS_READ: true
2024-02-25T15:12:55.1033544Z ##[endgroup]
2024-02-25T15:13:05.3515955Z /opt/hostedtoolcache/Ruby/3.2.2/x64/bin/ruby -I/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/lib:/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-support-3.12.1/lib /home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/exe/rspec  --format documentation --format KnapsackPro::Formatters::TimeTracker --default-path spec "spec/events/inventory_aggregate_spec.rb" "spec/models/product_drive_spec.rb" "spec/models/distribution_spec.rb" "spec/services/kit_create_service_spec.rb" "spec/services/organization_update_service_spec.rb" "spec/models/kit_spec.rb" "spec/services/allocate_kit_inventory_service_spec.rb" "spec/models/partner_spec.rb" "spec/services/deallocate_kit_inventory_service_spec.rb" "spec/services/distribution_destroy_service_spec.rb" "spec/queries/items_in_query_spec.rb" "spec/queries/items_in_total_query_spec.rb" "spec/services/remove_role_service_spec.rb" "spec/services/reports/children_served_report_service_spec.rb" "spec/services/reports/summary_report_service_spec.rb" "spec/models/request_item_spec.rb" "spec/models/transfer_spec.rb" "spec/services/reports/acquisition_report_service_spec.rb" "spec/services/item_create_service_spec.rb" "spec/services/distribution_create_service_spec.rb" "spec/services/reports/period_supply_report_service_spec.rb" "spec/models/purchase_spec.rb" "spec/services/exports/export_distributions_csv_service_spec.rb" "spec/mailers/distribution_mailer_spec.rb" "spec/jobs/partner_mailer_job_spec.rb" "spec/models/account_request_spec.rb" "spec/models/barcode_item_spec.rb" "spec/models/product_drive_participant_spec.rb" "spec/services/distributions_by_county_report_service_spec.rb" "spec/helpers/application_helper_spec.rb" "spec/services/exports/export_request_service_spec.rb" "spec/services/reports/partner_info_report_service_spec.rb" "spec/services/historical_trend_service_spec.rb" "spec/services/partners/request_create_service_spec.rb" "spec/services/calendar_service_spec.rb" "spec/models/partners/family_spec.rb" "spec/mailers/account_request_mailer_spec.rb" "spec/queries/items_out_query_spec.rb" "spec/events/event_differ_spec.rb" "spec/services/partner_approval_service_spec.rb" "spec/services/partners/request_approval_service_spec.rb" "spec/models/partners/profile_spec.rb" "spec/services/distribution_reminder_spec.rb" "spec/mailers/user_mailer_spec.rb" "spec/queries/items_out_total_query_spec.rb" "spec/services/exports/export_donations_csv_service_spec.rb" "spec/mailers/reminder_deadline_mailer_spec.rb" "spec/services/request_destroy_service_spec.rb" "spec/models/broadcast_announcement_spec.rb" "spec/models/question_spec.rb" "spec/services/partners/update_family_spec.rb" "spec/models/users_role_spec.rb" "spec/models/organization_stats_spec.rb" "spec/models/partners/authorized_family_member_spec.rb" "spec/services/requests_total_items_service_spec.rb" "spec/jobs/notify_partner_job_spec.rb" "spec/models/request_spec.rb" "spec/services/donation_destroy_service_spec.rb" "spec/models/partners/child_item_request_spec.rb" "spec/mailers/request_mailer_spec.rb" "spec/jobs/reminder_deadline_job_spec.rb" "spec/helpers/product_drive_helper_spec.rb" "spec/services/donation_create_service_spec.rb" "spec/models/concerns/deadlinable_spec.rb" "spec/helpers/historical_trends_helper_spec.rb" "spec/helpers/ui_helper_spec.rb" "spec/routing/account_requests_routing_spec.rb" "spec/services/exports/export_report_csv_service_spec.rb"
2024-02-25T15:13:13.8510145Z 
2024-02-25T15:13:13.8511462Z Randomized with seed 60855
2024-02-25T15:13:14.6478948Z 
2024-02-25T15:13:14.6479625Z RequestMailer
2024-02-25T15:13:14.6480881Z   #request_cancel_partner_notification
2024-02-25T15:13:14.6887059Z     should be sent to the partner main email with the correct subject line
2024-02-25T15:13:14.7051339Z     renders the body with correct text with partner information
2024-02-25T15:13:14.7052444Z 
2024-02-25T15:13:14.7052624Z KitCreateService
2024-02-25T15:13:14.7053301Z   #call
2024-02-25T15:13:14.9088419Z     should return an the instance
2024-02-25T15:13:14.9089162Z     when the parameters are valid
2024-02-25T15:13:15.1060428Z       should create the new Item associated with the Kit
2024-02-25T15:13:15.2964156Z       should create a new Item
2024-02-25T15:13:15.4882776Z       should create a new Kit
2024-02-25T15:13:15.4883454Z       but the ItemCreationService is unsuccesful
2024-02-25T15:13:15.6996099Z         should not create the Kit
2024-02-25T15:13:15.8871616Z         should have an error that includes the error
2024-02-25T15:13:16.0779166Z         should not create a Item
2024-02-25T15:13:16.0779843Z       but an unexpected error gets raised
2024-02-25T15:13:16.2669637Z         should have an error that includes the raised error
2024-02-25T15:13:16.4545426Z         should not create the Kit
2024-02-25T15:13:16.6404521Z         should not create a Item
2024-02-25T15:13:16.6405759Z     when the parameters provided are invalid
2024-02-25T15:13:16.6406894Z       because the organization_id does not match any Organization
2024-02-25T15:13:16.6458725Z         should have an error on organization_id saying it does not match any Organization
2024-02-25T15:13:16.6459965Z       because the kit_params is invalid for kit creation
2024-02-25T15:13:16.8203918Z         should have errors saying why the kit_params are invalid
2024-02-25T15:13:16.8204997Z 
2024-02-25T15:13:16.8205280Z DistributionByCountyReportService
2024-02-25T15:13:16.8206057Z   get_breakdown
2024-02-25T15:13:16.9314142Z     will have 100% unspecified shows if no served_areas
2024-02-25T15:13:17.1185263Z     handles multiple partners with overlapping service areas properly
2024-02-25T15:13:17.2086064Z     divides the item numbers and values according to the partner profile
2024-02-25T15:13:17.2087199Z 
2024-02-25T15:13:17.2087570Z Partner
2024-02-25T15:13:17.2089396Z   #profile
2024-02-25T15:13:17.2334411Z     should return the associated Partners::Profile record
2024-02-25T15:13:17.2335307Z   #impact_metrics
2024-02-25T15:13:17.2335895Z     when partner has related information
2024-02-25T15:13:17.3068185Z       is expected to eq {:children_served=>4, :families_served=>3, :family_zipcodes=>2, :family_zipcodes_list=>["45612-123", "45612-126"]}
2024-02-25T15:13:17.3069367Z     when partner don't have any related information
2024-02-25T15:13:17.3317116Z       is expected to eq {:children_served=>0, :families_served=>0, :family_zipcodes=>0, :family_zipcodes_list=>[]}
2024-02-25T15:13:17.3318137Z   Validations >
2024-02-25T15:13:17.3589478Z     requires a unique name within an organization
2024-02-25T15:13:17.3678891Z     validates the quota is a number but it is not required
2024-02-25T15:13:17.3978713Z     requires a unique email that is formatted correctly
2024-02-25T15:13:17.4241351Z     still requires a unique email between organizations
2024-02-25T15:13:17.4489171Z     does not require a unique name between organizations
2024-02-25T15:13:17.4539667Z     must belong to an organization
2024-02-25T15:13:17.4540378Z   ActiveStorage validation
2024-02-25T15:13:17.4651975Z     validates that attachments are pdf or docs
2024-02-25T15:13:17.4652720Z   #deactivated?
2024-02-25T15:13:17.4653573Z     when the status is not 'deactivated'
2024-02-25T15:13:17.4694972Z       should return false
2024-02-25T15:13:17.4695700Z     when the status is 'deactivated'
2024-02-25T15:13:17.4738878Z       should return true
2024-02-25T15:13:17.4739475Z   import_csv
2024-02-25T15:13:17.6858827Z     imports partners from a csv file and prevents multiple imports
2024-02-25T15:13:18.0046088Z     imports partners from a csv file with BOM encodings
2024-02-25T15:13:18.0047188Z   callbacks
2024-02-25T15:13:18.0273236Z     properly downcases email
2024-02-25T15:13:18.0274321Z   #deletable?
2024-02-25T15:13:18.0275162Z     when status is not uninvited
2024-02-25T15:13:18.0372489Z       should return false
2024-02-25T15:13:18.0373108Z     when status is uninvited
2024-02-25T15:13:18.0373924Z       when it has no other associations
2024-02-25T15:13:18.0491719Z         should return true
2024-02-25T15:13:18.0492557Z       when it has a profile and users
2024-02-25T15:13:18.0747279Z         should return false
2024-02-25T15:13:18.0747889Z       when it has a request
2024-02-25T15:13:18.0894749Z         should return false
2024-02-25T15:13:18.0895438Z       when it has a distribution
2024-02-25T15:13:18.1038336Z         should return false
2024-02-25T15:13:18.1039296Z       when it has a profile but no users
2024-02-25T15:13:18.1213679Z         should return true
2024-02-25T15:13:18.1214329Z   Filters
2024-02-25T15:13:18.1215001Z     by_status
2024-02-25T15:13:18.1628353Z       yields partners with the provided status
2024-02-25T15:13:18.2035267Z       yields deactivated partner when deactivated status provided
2024-02-25T15:13:18.2036461Z   changing emails
2024-02-25T15:13:18.2376055Z     should not call the UserInviteService.invite when the partner is changing email to previously used email
2024-02-25T15:13:18.2630648Z     should call the UserInviteService.invite when the partner has status approved and the email is changed
2024-02-25T15:13:18.2889133Z     should call the UserInviteService.invite when the partner has status invited and the email is changed
2024-02-25T15:13:18.3154816Z     should call the UserInviteService.invite when the partner has status awaiting_review and the email is changed
2024-02-25T15:13:18.3404101Z     should not call the UserInviteService.invite when the partner has status uninvited and the email is changed
2024-02-25T15:13:18.3643779Z     should not call the UserInviteService.invite when the partner has status deactivated and the email is changed
2024-02-25T15:13:18.3889198Z     should call the UserInviteService.invite when the partner has status recertification_required and the email is changed
2024-02-25T15:13:18.3890666Z   versioning
2024-02-25T15:13:18.3923850Z     is expected to be versioned
2024-02-25T15:13:18.3924825Z   #quantity_year_to_date
2024-02-25T15:13:18.5703671Z     does not include quantities from distributions issued during the previous year
2024-02-25T15:13:18.7494878Z     includes all item quantities from distributions issued during the current year
2024-02-25T15:13:18.7496740Z   #csv_export_attributes
2024-02-25T15:13:18.7767977Z     includes contact person information from parnerbase
2024-02-25T15:13:18.7768666Z   associations
2024-02-25T15:13:18.7809546Z     is expected to have many families dependent => destroy
2024-02-25T15:13:18.7842896Z     is expected to have many distributions
2024-02-25T15:13:18.7879661Z     is expected to have many users dependent => destroy
2024-02-25T15:13:18.7915616Z     is expected to have many requests
2024-02-25T15:13:18.7955605Z     is expected to have many requestable_items through item_categories source => items
2024-02-25T15:13:18.7989837Z     is expected to have many item_categories through partner_group
2024-02-25T15:13:18.8026248Z     is expected to have many requests
2024-02-25T15:13:18.8085174Z     is expected to belong to organization required: true
2024-02-25T15:13:18.8137997Z     is expected to belong to partner_group optional: true
2024-02-25T15:13:18.8177943Z     is expected to have many children through families
2024-02-25T15:13:18.8178622Z     primary_user
2024-02-25T15:13:18.8484382Z       should return the first user ever created for a partner
2024-02-25T15:13:18.8485421Z   #approvable?
2024-02-25T15:13:18.8485943Z     when status is awaiting_review
2024-02-25T15:13:18.8529583Z       should return true
2024-02-25T15:13:18.8530443Z     when status is not invited or awaiting_review
2024-02-25T15:13:18.8617715Z       should return false
2024-02-25T15:13:18.8618472Z     when status is invited
2024-02-25T15:13:18.8660488Z       should return true
2024-02-25T15:13:18.8662369Z 
2024-02-25T15:13:18.8662685Z Distribution
2024-02-25T15:13:18.8664471Z   Methods >
2024-02-25T15:13:18.8665420Z     #combine_duplicates
2024-02-25T15:13:18.9088481Z       condenses duplicate line_items if the item_ids match
2024-02-25T15:13:18.9089518Z     #copy_from_request
2024-02-25T15:13:18.9319291Z       copy over relevant request information into the distrubution
2024-02-25T15:13:18.9320851Z     #copy_line_items
2024-02-25T15:13:18.9742443Z       replicates line_items from a donation into a distribution
2024-02-25T15:13:18.9743364Z     #future?
2024-02-25T15:13:18.9744111Z       when issued_at has passed
2024-02-25T15:13:19.0029109Z         returns false
2024-02-25T15:13:19.0029785Z       when issued_at has not passed
2024-02-25T15:13:19.0322323Z         returns true
2024-02-25T15:13:19.0324336Z     #distributed_at
2024-02-25T15:13:19.0814899Z       displays explicit issued_at date
2024-02-25T15:13:19.1085258Z       shows the hour and minutes if it has been provided
2024-02-25T15:13:19.1088056Z   CSV export >
2024-02-25T15:13:19.1089972Z     csv_export_attributes
2024-02-25T15:13:19.5098160Z       returns the set of attributes which define a row in case of distribution export
2024-02-25T15:13:19.5099279Z     for_csv_export >
2024-02-25T15:13:19.8334585Z       filters only to the given issue time range
2024-02-25T15:13:20.1503325Z       filters only to the given organization
2024-02-25T15:13:20.4884799Z       filters only to the given filter
2024-02-25T15:13:20.4885991Z   behaves like itemizable
2024-02-25T15:13:20.4886573Z     .to_a
2024-02-25T15:13:20.4887141Z       with Flipper flag :deprecate_to_a disabled
2024-02-25T15:13:20.5238973Z         calls line_item_values
2024-02-25T15:13:20.5240026Z       with Flipper flag :deprecate_to_a enabled
2024-02-25T15:13:20.5598357Z         raises an error
2024-02-25T15:13:20.5598977Z     .line_items
2024-02-25T15:13:20.5600254Z       combine!
2024-02-25T15:13:20.6164280Z         incrementally combines line_items on donations that have already been created
2024-02-25T15:13:20.6609742Z         combines multiple line_items with the same item_id into a single record
2024-02-25T15:13:20.6611151Z       quantities_by_name
2024-02-25T15:13:20.7483000Z         returns a hash of items with id, name, and quantity
2024-02-25T15:13:20.8381853Z         leaves out zero-quantitied items if requested
2024-02-25T15:13:20.8383033Z       total
2024-02-25T15:13:20.9284508Z         has an item total
2024-02-25T15:13:20.9285567Z       sorted
2024-02-25T15:13:21.0534222Z         displays the items, sorted by name
2024-02-25T15:13:21.0535399Z   versioning
2024-02-25T15:13:21.0571147Z     is expected to be versioned
2024-02-25T15:13:21.0571838Z   Callbacks >
2024-02-25T15:13:21.1057023Z     initializes the issued_at field to default to midnight if it wasn't explicitly set
2024-02-25T15:13:21.1058158Z     #before_save
2024-02-25T15:13:21.1058728Z       #reset_shipping_cost
2024-02-25T15:13:21.1059708Z         when delivery_method is other then shipped
2024-02-25T15:13:21.1315023Z           distribution will be created successfully and the shipping_cost will be zero
2024-02-25T15:13:21.1316720Z   Validations >
2024-02-25T15:13:21.1374900Z     ensures that the issued at is no earlier than 2000
2024-02-25T15:13:21.1427020Z     must belong to an organization
2024-02-25T15:13:21.1857616Z     ensures the associated line_items are valid
2024-02-25T15:13:21.1895698Z     ensures that any included items are found in the associated storage location
2024-02-25T15:13:21.1945535Z     requires a partner
2024-02-25T15:13:21.2102807Z     ensures the associated line_items are invalid with a zero quantity
2024-02-25T15:13:21.2253343Z     ensures the associated line_items are invalid with a nil quantity
2024-02-25T15:13:21.2302987Z     requires a storage location
2024-02-25T15:13:21.2304046Z     when delivery method is other then shipped
2024-02-25T15:13:21.2569735Z       allows to save distribution
2024-02-25T15:13:21.2570722Z     when delivery method is shipped
2024-02-25T15:13:21.2571505Z       shipping cost is negative
2024-02-25T15:13:21.2631763Z         will not allow to save distribution
2024-02-25T15:13:21.2633181Z       shipping cost is none negative
2024-02-25T15:13:21.2892244Z         allows to save distribution
2024-02-25T15:13:21.2892945Z   Scopes >
2024-02-25T15:13:21.2894271Z     by_location >
2024-02-25T15:13:21.3399875Z       only returns distributions with given location id
2024-02-25T15:13:21.3400803Z     this_week >
2024-02-25T15:13:21.3402022Z       When it's Tuesday (mid-week)
2024-02-25T15:13:21.4113848Z         includes distributions as early as Monday and as late as upcoming Sunday
2024-02-25T15:13:21.4115386Z       When it's Sunday (end of the week)
2024-02-25T15:13:21.4601538Z         doesn't include distributions past Sunday
2024-02-25T15:13:21.4602384Z     during >
2024-02-25T15:13:21.5307157Z       returns all distributions created between two dates
2024-02-25T15:13:21.5308300Z     by_partner >
2024-02-25T15:13:21.5795152Z       only returns distributions with given partner id
2024-02-25T15:13:21.5796106Z     by_item_id >
2024-02-25T15:13:21.7168203Z       only returns distributions with given item id
2024-02-25T15:13:21.7168906Z 
2024-02-25T15:13:21.7169363Z Partners::Profile
2024-02-25T15:13:21.7210330Z   must allow deleting served_areas
2024-02-25T15:13:21.7211487Z   social media info validation for profile
2024-02-25T15:13:21.7212559Z     has social media presence and the checkbox is unchecked
2024-02-25T15:13:21.7291511Z       with just facebook it should be valid
2024-02-25T15:13:21.7368031Z       with just a website it should be valid
2024-02-25T15:13:21.7441491Z       with just instagram it should be valid
2024-02-25T15:13:21.7517136Z       with just twitter it should be valid
2024-02-25T15:13:21.7592698Z       with every social media option it should be valid
2024-02-25T15:13:21.7593645Z     no social media presence and the checkbox is checked
2024-02-25T15:13:21.7657565Z       should be valid
2024-02-25T15:13:21.7658608Z     no social media presence and the checkbox isn't checked
2024-02-25T15:13:21.7718551Z       should not be valid
2024-02-25T15:13:21.7825669Z       should be valid if media_information is not needed
2024-02-25T15:13:21.7826560Z   client share behaviour
2024-02-25T15:13:21.7827163Z     no served areas
2024-02-25T15:13:21.7880827Z       has 0 client share
2024-02-25T15:13:21.7881595Z     multiple
2024-02-25T15:13:21.8042942Z       sums the client shares
2024-02-25T15:13:21.8196671Z       is valid if client share sum is 100
2024-02-25T15:13:21.8197353Z   associations
2024-02-25T15:13:21.8240350Z     is expected to have a has_many_attached called documents
2024-02-25T15:13:21.8278710Z     is expected to have a has_one_attached called proof_of_form_990
2024-02-25T15:13:21.8318316Z     is expected to have many served_areas
2024-02-25T15:13:21.8358166Z     is expected to have a has_one_attached called proof_of_partner_status
2024-02-25T15:13:21.8359225Z   versioning
2024-02-25T15:13:21.8392289Z     is expected to be versioned
2024-02-25T15:13:21.8393325Z   request settings validation for profile
2024-02-25T15:13:21.8394459Z     at least one request type is set to true
2024-02-25T15:13:21.8473795Z       should be valid when enable_quantity_based_requests is true
2024-02-25T15:13:21.8547937Z       should be valid when enable_individual_requests is true
2024-02-25T15:13:21.8619792Z       should be valid when enable_child_based_requests is true
2024-02-25T15:13:21.8620592Z     no settings are set to true
2024-02-25T15:13:21.8671865Z       should not be valid
2024-02-25T15:13:21.8672611Z 
2024-02-25T15:13:21.8673127Z ItemsOutTotalQuery
2024-02-25T15:13:21.8673898Z   items_out_total_query
2024-02-25T15:13:21.9971230Z     returns a sum total of all out-flows
2024-02-25T15:13:21.9972301Z 
2024-02-25T15:13:21.9972863Z Reports::SummaryReportService
2024-02-25T15:13:21.9973545Z   #report
2024-02-25T15:13:22.4496069Z     should report positive values
2024-02-25T15:13:22.6215762Z     should report zero values
2024-02-25T15:13:23.0663699Z     should report negative values
2024-02-25T15:13:23.0664383Z 
2024-02-25T15:13:23.0664573Z DistributionReminder
2024-02-25T15:13:23.0665716Z   conditionally sending the emails
2024-02-25T15:13:23.1055129Z     sends mail for future distributions
2024-02-25T15:13:23.1340030Z     does not send mail for past distributions
2024-02-25T15:13:23.1659287Z     sends mail for future distributions where the partner wants reminders
2024-02-25T15:13:23.1957113Z     does not send mail for future distributions if the partner wants no reminders
2024-02-25T15:13:23.1958648Z     when the partner is deactivated
2024-02-25T15:13:23.2252170Z       does not send mail
2024-02-25T15:13:23.2253089Z     when the distribution_id does not match any Distribution
2024-02-25T15:13:23.2297682Z       does not send mail for non existent distributions
2024-02-25T15:13:23.2298434Z 
2024-02-25T15:13:23.2298867Z Exports::ExportDistributionsCSVService
2024-02-25T15:13:23.2299698Z   #generate_csv_data
2024-02-25T15:13:23.4169918Z     should match the expected content for the csv
2024-02-25T15:13:23.4170998Z     when there are no distributions but the report is requested
2024-02-25T15:13:23.5989716Z       returns a csv with only headers and no rows
2024-02-25T15:13:23.5990597Z     when a new item is added
2024-02-25T15:13:23.7896392Z       should show up with a 0 quantity if there are none of this item in any distribution
2024-02-25T15:13:23.9750716Z       should add it to the end of the row
2024-02-25T15:13:23.9751278Z 
2024-02-25T15:13:23.9751552Z RemoveRoleService
2024-02-25T15:13:23.9752568Z   #call
2024-02-25T15:13:23.9755328Z     when the role does not exist
2024-02-25T15:13:24.1637078Z       should raise an error
2024-02-25T15:13:24.1637856Z     when not enough information provided
2024-02-25T15:13:24.3515433Z       should raise an error
2024-02-25T15:13:24.3516220Z     when the role exists
2024-02-25T15:13:24.5522432Z       should remove the admin role when removing user role
2024-02-25T15:13:24.7563646Z       should work with a type and ID instead of role ID
2024-02-25T15:13:24.9498237Z       should remove the role
2024-02-25T15:13:24.9498803Z 
2024-02-25T15:13:24.9499078Z Partners::ChildItemRequest
2024-02-25T15:13:24.9500540Z   versioning
2024-02-25T15:13:24.9611108Z     is expected to be versioned
2024-02-25T15:13:24.9611782Z   associations
2024-02-25T15:13:24.9660963Z     is expected to belong to item_request required: true
2024-02-25T15:13:24.9701883Z     is expected to belong to child required: true
2024-02-25T15:13:24.9740122Z     is expected to belong to authorized_family_member optional: true
2024-02-25T15:13:24.9740981Z   #ordered_item_diaperid
2024-02-25T15:13:24.9802040Z     should return the item_id on the item_request
2024-02-25T15:13:24.9803182Z   #quantity
2024-02-25T15:13:24.9843292Z     should return the quantity divided by the number of children
2024-02-25T15:13:24.9844135Z 
2024-02-25T15:13:24.9844622Z UiHelper
2024-02-25T15:13:24.9845672Z   optional_data_text
2024-02-25T15:13:24.9846847Z     when the field provided is not blank
2024-02-25T15:13:24.9926110Z       should return the content
2024-02-25T15:13:24.9927229Z     when the field provided is blank
2024-02-25T15:13:24.9971728Z       should return the text Not-Provided in gray text
2024-02-25T15:13:24.9972340Z 
2024-02-25T15:13:24.9972899Z ItemsInQuery
2024-02-25T15:13:24.9973621Z   items_in
2024-02-25T15:13:25.3061895Z     returns a collection with the fields name, item_id, quantity
2024-02-25T15:13:25.5917371Z     includes donations, purchases, adjustments, transfers among sources
2024-02-25T15:13:25.9495188Z     does not count negative adjustments towards in-flow
2024-02-25T15:13:26.3214412Z     does not count transfers going in the negative direction
2024-02-25T15:13:26.3215175Z 
2024-02-25T15:13:26.3215778Z Partners::RequestApprovalService
2024-02-25T15:13:26.3216469Z   #call
2024-02-25T15:13:26.3217049Z     when the partner is not yet awaiting approval
2024-02-25T15:13:26.3525913Z       should set the status on the partner record to awaiting_review
2024-02-25T15:13:26.3813874Z       should send an email notification to the partner's organization
2024-02-25T15:13:26.3815021Z     when the partner is already awaiting approval
2024-02-25T15:13:26.4094701Z       should return an error saying it the partner is already requested approval
2024-02-25T15:13:26.4095775Z     when the partner is not yet waiting for approval and there is a profile error
2024-02-25T15:13:26.4097251Z       should return an error re agency_type (PENDING: Temporarily skipped with xit)
2024-02-25T15:13:26.4359809Z       should return an error re social media
2024-02-25T15:13:26.4360608Z     when the partner is not yet waiting for approval and there is no profile error
2024-02-25T15:13:26.4683207Z       does not have an error
2024-02-25T15:13:26.4683778Z 
2024-02-25T15:13:26.4684102Z Partners::Family
2024-02-25T15:13:26.4686116Z   versioning
2024-02-25T15:13:26.4722435Z     is expected to be versioned
2024-02-25T15:13:26.4722939Z   #search_non_archived
2024-02-25T15:13:26.5685065Z     should return non-archived families if zero is passed in
2024-02-25T15:13:26.6640733Z     should return all families if one is passed in
2024-02-25T15:13:26.6641632Z   associations
2024-02-25T15:13:26.6685363Z     is expected to have many children dependent => destroy
2024-02-25T15:13:26.6726715Z     is expected to belong to partner required: true
2024-02-25T15:13:26.6763708Z     is expected to have many authorized_family_members dependent => destroy
2024-02-25T15:13:26.6764379Z   #guardian_display_name
2024-02-25T15:13:26.6815837Z     should return the guardian's first and last name
2024-02-25T15:13:26.6816437Z   #create_authorized
2024-02-25T15:13:26.7094706Z     should include authorized family members
2024-02-25T15:13:26.7095645Z   #total_children_count
2024-02-25T15:13:26.7145037Z     should return the family's total children count
2024-02-25T15:13:26.7145697Z   validations
2024-02-25T15:13:26.7224969Z     is expected to validate that :guardian_zip_code cannot be empty/falsy
2024-02-25T15:13:26.7301540Z     is expected to validate that :guardian_first_name cannot be empty/falsy
2024-02-25T15:13:26.7375832Z     is expected to validate that :guardian_last_name cannot be empty/falsy
2024-02-25T15:13:26.7376664Z 
2024-02-25T15:13:26.7376824Z DonationCreateService
2024-02-25T15:13:26.7377522Z   #call
2024-02-25T15:13:26.7584761Z     should create the donation
2024-02-25T15:13:26.7585391Z 
2024-02-25T15:13:26.7585764Z ProductDriveParticipant
2024-02-25T15:13:26.7587382Z   versioning
2024-02-25T15:13:26.7681576Z     is expected to be versioned
2024-02-25T15:13:26.7682313Z   Methods
2024-02-25T15:13:26.7682848Z     volume
2024-02-25T15:13:26.8462443Z       retrieves the amount of product that has been donated by participant
2024-02-25T15:13:26.8463338Z     donation_source_view
2024-02-25T15:13:26.8463873Z       no contact name
2024-02-25T15:13:26.8527123Z         is expected to be nil
2024-02-25T15:13:26.8527994Z       contact name present
2024-02-25T15:13:26.8585002Z         is expected to eq "Contact Name (participant)"
2024-02-25T15:13:26.8585762Z     volume_by_product_drive
2024-02-25T15:13:27.0072028Z       retrieves the amount of product that has been donated through specific product drive
2024-02-25T15:13:27.0073418Z   behaves like provideable
2024-02-25T15:13:27.0073887Z     import_csv
2024-02-25T15:13:27.1858288Z       imports from a csv file
2024-02-25T15:13:27.1859273Z     geocode
2024-02-25T15:13:27.1919148Z       adds coordinates to the database
2024-02-25T15:13:27.1919878Z     Validations
2024-02-25T15:13:27.1956569Z       is invalid without an organization
2024-02-25T15:13:27.2014740Z       is invalid unless it has either a contact name or a business name
2024-02-25T15:13:27.2015680Z   Validations
2024-02-25T15:13:27.2071636Z     is invalid unless it has either a phone number or an email
2024-02-25T15:13:27.2106936Z     is invalid without an organization
2024-02-25T15:13:27.2107490Z 
2024-02-25T15:13:27.2107869Z ItemsOutQuery
2024-02-25T15:13:27.2108796Z   items_out_query
2024-02-25T15:13:27.3280064Z     includes distributions, adjustments, transfers among sources
2024-02-25T15:13:27.4418516Z     returns a collection with the fields name, item_id, quantity
2024-02-25T15:13:27.4419966Z 
2024-02-25T15:13:27.4420504Z UsersRole
2024-02-25T15:13:27.4421033Z   versioning
2024-02-25T15:13:27.4458139Z     is expected to be versioned
2024-02-25T15:13:27.4459098Z   #current_role_for
2024-02-25T15:13:27.4459740Z     for org admin
2024-02-25T15:13:27.4656782Z       should return org admin
2024-02-25T15:13:27.4657718Z     for org user
2024-02-25T15:13:27.4778970Z       should return org user
2024-02-25T15:13:27.4779715Z     for partner user
2024-02-25T15:13:27.4978282Z       should return partner user
2024-02-25T15:13:27.4979054Z     for super admin
2024-02-25T15:13:27.5148350Z       should return super admin
2024-02-25T15:13:27.5151982Z 
2024-02-25T15:13:27.5152396Z RequestDestroyService
2024-02-25T15:13:27.5153618Z   #call
2024-02-25T15:13:27.5288391Z     should return an instance of itself
2024-02-25T15:13:27.5289589Z     when the request's partner is deactivated
2024-02-25T15:13:27.5575875Z       should have errors
2024-02-25T15:13:27.5576709Z     when the request_id matches no request
2024-02-25T15:13:27.5621063Z       should not be successful and have errors indicating request id is invalid
2024-02-25T15:13:27.5622403Z     when there are no validation errors
2024-02-25T15:13:27.5745074Z       should send a email notification to the partner
2024-02-25T15:13:27.5872565Z       should update the status column on the request
2024-02-25T15:13:27.5999493Z       should update the discarded_at column on the request
2024-02-25T15:13:27.6000371Z     when the request is already discarded
2024-02-25T15:13:27.6099670Z       should not be successful and have errors
2024-02-25T15:13:27.6100352Z 
2024-02-25T15:13:27.6100722Z Question
2024-02-25T15:13:27.6102081Z   validations
2024-02-25T15:13:27.6261317Z     is expected to validate that :title cannot be empty/falsy
2024-02-25T15:13:27.6411002Z     question for_banks and for_partners attributes can't both be false
2024-02-25T15:13:27.6470610Z     is expected to validate that :answer cannot be empty/falsy
2024-02-25T15:13:27.6471346Z   punctuate
2024-02-25T15:13:27.6513824Z     should punctuate each string in a given array
2024-02-25T15:13:27.6514956Z   remove_redundant_error
2024-02-25T15:13:27.6553917Z     should return an array with only one error message related to the checkboxes.
2024-02-25T15:13:27.6555037Z   scope for_banks
2024-02-25T15:13:27.6795851Z     should filter out questions that aren't meant for banks
2024-02-25T15:13:27.6796742Z   scope for_partners
2024-02-25T15:13:27.7029927Z     should filter out questions that aren't meant for partners
2024-02-25T15:13:27.7030616Z   versioning
2024-02-25T15:13:27.7067217Z     is expected to be versioned
2024-02-25T15:13:27.7068433Z 
2024-02-25T15:13:27.7068814Z BarcodeItem
2024-02-25T15:13:27.7069939Z   Organization barcodes
2024-02-25T15:13:27.7258691Z     updates a counter in Item whenever it tracks a new barcode
2024-02-25T15:13:27.7260121Z     validations >
2024-02-25T15:13:27.7422673Z       enforces value uniqueness within the organization
2024-02-25T15:13:27.7583576Z       is valid only with an organization
2024-02-25T15:13:27.7831121Z       does not enforces value uniqueness across organizations
2024-02-25T15:13:27.7955114Z       does not enforce value uniqueness compared with the global scope
2024-02-25T15:13:27.8070784Z       allows multiple barcodes to point at the same item
2024-02-25T15:13:27.8072137Z       value >
2024-02-25T15:13:27.8169386Z         requires a value
2024-02-25T15:13:27.8170382Z       quantity >
2024-02-25T15:13:27.8263716Z         is an integer
2024-02-25T15:13:27.8357187Z         is not nil
2024-02-25T15:13:27.8455185Z         is not a negative number
2024-02-25T15:13:27.8455868Z       item >
2024-02-25T15:13:27.8549551Z         is invalid without an item associated with it
2024-02-25T15:13:27.8550643Z     to_h >
2024-02-25T15:13:27.8672067Z       emits a hash for a line_item
2024-02-25T15:13:27.8673062Z     when searching for a barcode where there is a global and local with the same value
2024-02-25T15:13:27.8987857Z       favors the local barcode
2024-02-25T15:13:27.8988714Z     scopes >
2024-02-25T15:13:28.0866384Z       ->for_csv_export will accept an organization and provide all barcodes for that org
2024-02-25T15:13:28.1076545Z       #by_item_partner_key returns barcodes that match the partner key
2024-02-25T15:13:28.1185142Z       ->by_value returns the barcode with that value
2024-02-25T15:13:28.1185979Z     filters >
2024-02-25T15:13:28.1378980Z       ->item_id shows only barcodes for a specific item_id
2024-02-25T15:13:28.1379846Z   versioning
2024-02-25T15:13:28.1415072Z     is expected to be versioned
2024-02-25T15:13:28.1416240Z   Barcodes of BaseItems ('Global')
2024-02-25T15:13:28.1515266Z     updates a counter in BaseItem whenever it tracks a new barcode
2024-02-25T15:13:28.1516275Z     validations >
2024-02-25T15:13:28.1602814Z       enforces uniqueness in the global scope
2024-02-25T15:13:28.1675382Z       is valid with or without an organization
2024-02-25T15:13:28.1750774Z       allows multiple barcodes to point at the same base item
2024-02-25T15:13:28.1751753Z       item >
2024-02-25T15:13:28.1803169Z         is invalid without an item associated with it
2024-02-25T15:13:28.1804204Z       value >
2024-02-25T15:13:28.1854938Z         requires a value
2024-02-25T15:13:28.1855594Z       quantity >
2024-02-25T15:13:28.1906408Z         is an integer
2024-02-25T15:13:28.1956180Z         is not a negative number
2024-02-25T15:13:28.2004831Z         is not nil
2024-02-25T15:13:28.2005640Z     scopes >
2024-02-25T15:13:28.2006935Z       global
2024-02-25T15:13:28.2190778Z         includes all barcodes, for both base items and regular items
2024-02-25T15:13:28.2191760Z     filters >
2024-02-25T15:13:28.2341575Z       ->barcodeable_id shows only barcodes for a specific barcodeable_id
2024-02-25T15:13:28.2487277Z       #by_base_item_partner_key returns barcodes that match the partner key
2024-02-25T15:13:28.2597864Z       ->by_value returns the barcode with that value
2024-02-25T15:13:28.2598449Z 
2024-02-25T15:13:28.2598756Z HistoricalTrendsHelper
2024-02-25T15:13:28.2600471Z   #last_12_months
2024-02-25T15:13:28.2647645Z     returns the last 12 months starting from Jan when the current month is Dec
2024-02-25T15:13:28.2694461Z     returns the last 12 months starting from Feb when the current month is Jan
2024-02-25T15:13:28.2733865Z     returns the last 12 months starting from July when the current month is June
2024-02-25T15:13:28.2734692Z 
2024-02-25T15:13:28.2734953Z AllocateKitInventoryService
2024-02-25T15:13:28.2736255Z   #error
2024-02-25T15:13:28.2737263Z     when the Store location organization doesn't match
2024-02-25T15:13:28.4873304Z       returns error
2024-02-25T15:13:28.4874306Z   #allocate
2024-02-25T15:13:28.4874853Z     when inventory items are available
2024-02-25T15:13:28.7691346Z       allocates items, increases the quantity of the Kit Item and inventory in, and decreases inventory out
2024-02-25T15:13:28.7692680Z       When kit is allocated more then once
2024-02-25T15:13:29.0743235Z         increases the already existed inventory in and decreases the already existed inventory out
2024-02-25T15:13:29.0744459Z       when there are more then one line items
2024-02-25T15:13:29.0745324Z         when same kit is allocated multiple times
2024-02-25T15:13:29.3949288Z           inventory out for that kit contains both line_items with their respective quantity
2024-02-25T15:13:29.3950557Z         when there kit is allocated once
2024-02-25T15:13:29.6754610Z           inventory out for that kit contains both line_items with their respective quantity
2024-02-25T15:13:29.6755848Z     when more than one kit is requested
2024-02-25T15:13:29.6756929Z       but one of the items is out of stock
2024-02-25T15:13:29.9482606Z         returns error and does not change kit or item quantity
2024-02-25T15:13:29.9483298Z 
2024-02-25T15:13:29.9483515Z NotifyPartnerJob
2024-02-25T15:13:29.9484422Z   #perform
2024-02-25T15:13:29.9600668Z     is expected to call RequestsConfirmationMailer
2024-02-25T15:13:29.9643663Z     avoids exception when request doesn't exist
2024-02-25T15:13:29.9644868Z     when the request's partner is deactivated
2024-02-25T15:13:29.9936943Z       does not send the confirmation email
2024-02-25T15:13:29.9937542Z 
2024-02-25T15:13:29.9938117Z HistoricalTrendService
2024-02-25T15:13:29.9938767Z   #series
2024-02-25T15:13:30.4224803Z     returns an array of items with their monthly data
2024-02-25T15:13:30.4225520Z 
2024-02-25T15:13:30.4225764Z Exports::ExportReportCSVService
2024-02-25T15:13:30.4226243Z   .generate_csv_data
2024-02-25T15:13:30.4298400Z     creates CSV data including headers
2024-02-25T15:13:30.4380097Z     creates a CSV string
2024-02-25T15:13:30.4386939Z 
2024-02-25T15:13:30.4392228Z ItemsInTotalQuery
2024-02-25T15:13:30.4393383Z   items_in_total_query
2024-02-25T15:13:30.7083092Z     does not count negative adjustments towards in-flow
2024-02-25T15:13:30.8765772Z     returns a sum total of all in-flows
2024-02-25T15:13:31.1110487Z     does not count transfers going in the negative direction
2024-02-25T15:13:31.4863763Z     counts shared items together
2024-02-25T15:13:31.7754714Z     does not count donations, purchases, adjustments to other storage locations
2024-02-25T15:13:31.7755917Z 
2024-02-25T15:13:31.7756127Z ItemCreateService
2024-02-25T15:13:31.7756638Z   #call
2024-02-25T15:13:31.7757453Z     when an issue occurs in transaction
2024-02-25T15:13:31.7758322Z       because the item create raised an error
2024-02-25T15:13:31.9438583Z         should return a OpenStruct with the raised error
2024-02-25T15:13:31.9439958Z       because the organization_id does not match any Organization
2024-02-25T15:13:32.1307387Z         should return a OpenStruct with an ActiveRecord::RecordNotFound error
2024-02-25T15:13:32.1308471Z       because a inventory item creation failed and raised an error
2024-02-25T15:13:32.3087680Z         should return a OpenStruct with the raised error
2024-02-25T15:13:32.3088576Z     when there are no issues
2024-02-25T15:13:32.4908701Z       should execute the expected methods
2024-02-25T15:13:32.6624080Z       should return an OpenStruct with success? set to true and the item
2024-02-25T15:13:32.6625269Z 
2024-02-25T15:13:32.6625553Z BroadcastAnnouncement
2024-02-25T15:13:32.6753124Z   should roughly check if link is valid
2024-02-25T15:13:32.6814038Z   should validate a valid announcement
2024-02-25T15:13:32.6853381Z   is expected to belong to organization optional: true
2024-02-25T15:13:32.6905920Z   is expected to validate that :message cannot be empty/falsy
2024-02-25T15:13:32.6946445Z   is expected to belong to user required: true
2024-02-25T15:13:32.7010534Z   should validate a good link
2024-02-25T15:13:32.7011298Z   expired?
2024-02-25T15:13:32.7071388Z     should be true if the announcement is expired
2024-02-25T15:13:32.7129672Z     should be false if the announcement has not expired
2024-02-25T15:13:32.7130568Z   filter_announcements
2024-02-25T15:13:32.7281028Z     sorts announcements from most recently created to last
2024-02-25T15:13:32.7406601Z     should include only announcements from the passed organization
2024-02-25T15:13:32.7528852Z     shouldn't include expired announcements
2024-02-25T15:13:32.7529665Z   versioning
2024-02-25T15:13:32.7565276Z     is expected to be versioned
2024-02-25T15:13:32.7565956Z 
2024-02-25T15:13:32.7566191Z AccountRequestsController
2024-02-25T15:13:32.7567186Z   routing
2024-02-25T15:13:32.7605901Z     routes to #new
2024-02-25T15:13:32.7641839Z     routes to #create
2024-02-25T15:13:32.7642324Z 
2024-02-25T15:13:32.7642547Z ReminderDeadlineJob
2024-02-25T15:13:32.7643507Z   #perform
2024-02-25T15:13:32.7882740Z     should queue up reminder deadline emails for all partners that should be reminded
2024-02-25T15:13:32.7883763Z 
2024-02-25T15:13:32.7884159Z Exports::ExportDonationsCSVService
2024-02-25T15:13:32.7885336Z   #generate_csv_data
2024-02-25T15:13:32.9050305Z     should match the expected content for the csv
2024-02-25T15:13:32.9050946Z 
2024-02-25T15:13:32.9051240Z PartnerApprovalService
2024-02-25T15:13:32.9052227Z   #call
2024-02-25T15:13:32.9052788Z     when the arguments are correct
2024-02-25T15:13:32.9370028Z       should have no errors
2024-02-25T15:13:32.9697088Z       should change the partner status to approved
2024-02-25T15:13:32.9998964Z       should send an email notification to the partner
2024-02-25T15:13:32.9999875Z       but a unexpected error occured during the save
2024-02-25T15:13:33.0000766Z         for partner approval
2024-02-25T15:13:33.0290379Z           should have an error with the raised error
2024-02-25T15:13:33.0583966Z           should not send an email notification to the partner
2024-02-25T15:13:33.0871922Z           should not change the partner status to approved
2024-02-25T15:13:33.0872949Z     when the arguments are incorrect
2024-02-25T15:13:33.0873616Z       because the partner is not approvable
2024-02-25T15:13:33.1142448Z         should return the PartnerApprovalService object with an error
2024-02-25T15:13:33.1143466Z 
2024-02-25T15:13:33.1143794Z DistributionDestroyService
2024-02-25T15:13:33.1144406Z   #call
2024-02-25T15:13:33.1145318Z     when the distribution_id matches no Distribution
2024-02-25T15:13:33.1186043Z       to not be a success
2024-02-25T15:13:33.1186599Z     when the distribution_id does match a Distribution
2024-02-25T15:13:33.1187679Z       and the increase inventory operations fails
2024-02-25T15:13:33.3280509Z         should not delete the Distribution
2024-02-25T15:13:33.5403042Z         should not be successful and have the error message
2024-02-25T15:13:33.5403999Z       and the operations succeed
2024-02-25T15:13:33.7566410Z         should be successful
2024-02-25T15:13:33.9661538Z         should increase the inventory of the storage location
2024-02-25T15:13:34.1748082Z         should destroy the Distribution
2024-02-25T15:13:34.1748945Z       and the destroy! operation fails
2024-02-25T15:13:34.3763562Z         should not be successful and have the error message
2024-02-25T15:13:34.5799167Z         should not delete the Distribution
2024-02-25T15:13:34.5800225Z 
2024-02-25T15:13:34.5800530Z ProductDrive
2024-02-25T15:13:34.7306228Z   calculates donation quantity
2024-02-25T15:13:34.9590690Z   calculates donation quantity by date
2024-02-25T15:13:35.1137670Z   calculates in-kind value
2024-02-25T15:13:35.3569700Z   calculates and returns all donated organization item quantities by name and date
2024-02-25T15:13:35.3570810Z   scopes
2024-02-25T15:13:35.3571614Z     .by_name
2024-02-25T15:13:35.5088677Z       does not return other_name
2024-02-25T15:13:35.6576336Z       returns the product_drive with name some_name
2024-02-25T15:13:35.6578279Z     .within_date_range
2024-02-25T15:13:35.8129929Z       returns the product drive 1
2024-02-25T15:13:35.9634174Z       does not include product drive 2
2024-02-25T15:13:35.9635187Z   versioning
2024-02-25T15:13:36.1062314Z     is expected to be versioned
2024-02-25T15:13:36.1063097Z   associations
2024-02-25T15:13:36.1941492Z     has_many product_drive_participants through donations
2024-02-25T15:13:36.2846316Z     has_many donations
2024-02-25T15:13:36.2847327Z   donation_source_view
2024-02-25T15:13:36.4317903Z     returns formatted text
2024-02-25T15:13:36.4319016Z   .search_date_range
2024-02-25T15:13:36.5756400Z     is expected to eq {:end_date=>"2019-12-19", :start_date=>"2019-12-17"}
2024-02-25T15:13:36.5757327Z   validations
2024-02-25T15:13:36.7223592Z     is expected not to be valid
2024-02-25T15:13:36.8699242Z     is expected not to be valid
2024-02-25T15:13:37.0134146Z     is expected not to be valid
2024-02-25T15:13:37.0134975Z   distinct_items
2024-02-25T15:13:37.1940058Z     counts the distinct items correctly in overlapping donations
2024-02-25T15:13:37.3783806Z     counts the distince items correctly by given date
2024-02-25T15:13:37.5527993Z     doesn't double_count the items if there are two donations for the same item
2024-02-25T15:13:37.7293504Z 236023612362    counts the items correctly for 1 donation with multiple items
2024-02-25T15:13:37.7294772Z 
2024-02-25T15:13:37.7295065Z Partners::UpdateFamily
2024-02-25T15:13:37.7295736Z   #call
2024-02-25T15:13:37.7296326Z     when family has children
2024-02-25T15:13:37.7715322Z       archives the family and its children
2024-02-25T15:13:37.7716213Z     when an error occurs during archiving
2024-02-25T15:13:37.8091795Z       does not archive the family or its children and adds error to the service
2024-02-25T15:13:37.8092602Z 
2024-02-25T15:13:37.8092874Z RequestItem
2024-02-25T15:13:37.8093404Z   Methods >
2024-02-25T15:13:37.8094096Z     #from_json
2024-02-25T15:13:38.0605629Z       has the correct amount on hand for location
2024-02-25T15:13:38.3073906Z       has the correct quantity
2024-02-25T15:13:38.5532239Z       has the correct amount on hand
2024-02-25T15:13:38.8009709Z       has the correct name
2024-02-25T15:13:38.8010363Z 
2024-02-25T15:13:38.8010742Z DeallocateKitInventoryService
2024-02-25T15:13:38.8011871Z   #error
2024-02-25T15:13:38.8013273Z     when the storage location organization doesn't match
2024-02-25T15:13:39.0218694Z       returns error
2024-02-25T15:13:39.0219675Z   #deallocate
2024-02-25T15:13:39.0220252Z     when inventory items are available
2024-02-25T15:13:39.0221978Z       when decrease_by is greater then kit's quantity in inventory_in
2024-02-25T15:13:39.3267661Z         raises error about inconsistent inventory in or out
2024-02-25T15:13:39.3269049Z       when  decrease_by is equal to kit's quantity in inventory_in
2024-02-25T15:13:39.6573074Z         increases the quantity of the loose items contained in the kit and decrease kit quantity, and delete inventory_in and inventory_out
2024-02-25T15:13:39.6574517Z       when decrease_by is less then kit's quantity in inventory_in
2024-02-25T15:13:39.9896272Z         will add items in inventory_out and remove kits for decrease_by from inventory_in
2024-02-25T15:13:39.9897178Z       when kit_allocation not exist for inventory_in or inventory_out
2024-02-25T15:13:40.2619647Z         raises error about KitAllocation not found
2024-02-25T15:13:40.2620301Z 
2024-02-25T15:13:40.2620628Z PartnerMailerJob
2024-02-25T15:13:40.2621682Z   conditionally sending the emails
2024-02-25T15:13:40.4604140Z     does not send mail for past distributions
2024-02-25T15:13:40.7631390Z     sends mail for future distributions immediately
2024-02-25T15:13:40.7632079Z     when the distribution is for a deactivated partner
2024-02-25T15:13:40.9646390Z       does not send the email
2024-02-25T15:13:40.9646967Z 
2024-02-25T15:13:40.9647993Z DonationDestroyService
2024-02-25T15:13:40.9648693Z   #call
2024-02-25T15:13:40.9650443Z     when storage_location fails to decrease the inventory of the donation
2024-02-25T15:13:40.9703294Z       to not be a success
2024-02-25T15:13:40.9704118Z     when the donation_id matches no Donation owned by the organization
2024-02-25T15:13:40.9746382Z       to not be a success
2024-02-25T15:13:40.9747231Z     when the donation destroy fails
2024-02-25T15:13:40.9821227Z       to not be a success
2024-02-25T15:13:40.9821981Z     when the organization_id matches no Organization
2024-02-25T15:13:40.9861500Z       to not be a success
2024-02-25T15:13:40.9862347Z     when the donation succesfully gets destroyed
2024-02-25T15:13:41.0110959Z       to be a success
2024-02-25T15:13:41.0111895Z 
2024-02-25T15:13:41.0112391Z Partners::RequestCreateService
2024-02-25T15:13:41.0113503Z   #call
2024-02-25T15:13:41.0114459Z     when the arguments are incorrect
2024-02-25T15:13:41.0115701Z       because no item_requests_attributes and comments were defined
2024-02-25T15:13:41.0414424Z         should return the Request object with an error
2024-02-25T15:13:41.0415502Z       because a unrecogonized item_id was provided
2024-02-25T15:13:41.0773933Z         should return the Request object with an error
2024-02-25T15:13:41.0775112Z     when the arguments are correct
2024-02-25T15:13:41.1177524Z       should notify the Partner via email
2024-02-25T15:13:41.1548154Z       should create a Request record
2024-02-25T15:13:41.1917616Z       should have no errors
2024-02-25T15:13:41.1918509Z       but a unexpected error occured during the save
2024-02-25T15:13:41.1919553Z         for the Request record
2024-02-25T15:13:41.2302392Z           should have an error with the raised error
2024-02-25T15:13:41.2669658Z           should NOT create a Request record
2024-02-25T15:13:41.3014758Z           should NOT notify the Partner via email
2024-02-25T15:13:41.3018838Z 
2024-02-25T15:13:41.3019323Z Reports::PartnerInfoReportService
2024-02-25T15:13:41.3021249Z   #report
2024-02-25T15:13:41.4737578Z     should report zero values
2024-02-25T15:13:41.7273610Z     should report normal values (FAILED - 1)
2024-02-25T15:13:41.7274452Z 
2024-02-25T15:13:41.7274716Z DistributionMailer
2024-02-25T15:13:41.7275852Z   #reminder_email
2024-02-25T15:13:41.7276708Z     Text format
2024-02-25T15:13:41.7807296Z       renders the body with organization's email text
2024-02-25T15:13:41.7808927Z     HTML format
2024-02-25T15:13:41.8303645Z       renders the body with organization's email text
2024-02-25T15:13:41.8304524Z     with deliver_method: :delivery
2024-02-25T15:13:41.8829776Z       renders the body with 'delivery' specified
2024-02-25T15:13:41.9332180Z     with deliver_method: :pick_up
2024-02-25T15:13:41.9541466Z       renders the body with 'pick up' specified
2024-02-25T15:13:41.9542137Z   #partner_mailer
2024-02-25T15:13:41.9914949Z     renders the body with distributions text
2024-02-25T15:13:42.0452782Z     renders the body with organization's email text
2024-02-25T15:13:42.0453463Z     with distribution changes
2024-02-25T15:13:42.1008577Z       renders the body with changes that happened in the distribution
2024-02-25T15:13:42.1009516Z     with deliver_method: :delivery
2024-02-25T15:13:42.1542802Z       sends copy of email only to the partner
2024-02-25T15:13:42.2082025Z       renders the body with 'delivered' specified
2024-02-25T15:13:42.2082808Z     with deliver_method: :pick_up
2024-02-25T15:13:42.2629958Z       renders the body with 'picked up' specified
2024-02-25T15:13:42.2630622Z       when parners profile pick_up_email is present
2024-02-25T15:13:42.3145878Z         sends email to the primary contact and partner`s pickup person
2024-02-25T15:13:42.3147204Z         when pickup person happens to be the same as the primary contact
2024-02-25T15:13:42.3737966Z           does not send email twice
2024-02-25T15:13:42.3740091Z 
2024-02-25T15:13:42.3740382Z CalendarService
2024-02-25T15:13:42.9334942Z   #time_zones
2024-02-25T15:13:42.9335518Z   .calendar
2024-02-25T15:13:42.9939156Z     should print the calendar correctly
2024-02-25T15:13:42.9939672Z 
2024-02-25T15:13:42.9939972Z Reports::PeriodSupplyReportService
2024-02-25T15:13:42.9940832Z   #report
2024-02-25T15:13:43.1822126Z     should report zero values
2024-02-25T15:13:43.1822748Z     with values
2024-02-25T15:13:43.8080874Z       should report normal values
2024-02-25T15:13:43.8081530Z 
2024-02-25T15:13:43.8081791Z AccountRequestMailer
2024-02-25T15:13:43.8083265Z   #confirmation
2024-02-25T15:13:43.8314923Z     should be sent to the specified account_request email
2024-02-25T15:13:43.8436628Z     should be from no-reply@humanessentials.app
2024-02-25T15:13:43.8546604Z     should have the correct subject
2024-02-25T15:13:43.8547468Z     when the account_request_id provided does not match any AccountRequest
2024-02-25T15:13:43.8592344Z       should trigger raise a ActiveRecord::RecordNotFound error
2024-02-25T15:13:43.8593129Z     Text format
2024-02-25T15:13:43.8701659Z       should include the instruction video link
2024-02-25T15:13:43.8811765Z       should include the staging/demo account information
2024-02-25T15:13:43.8918257Z       should include the button to confirm the request
2024-02-25T15:13:43.8918970Z     HTML format
2024-02-25T15:13:43.9026351Z       should include the staging/demo account information
2024-02-25T15:13:43.9134485Z       should include the instruction video link
2024-02-25T15:13:43.9243004Z       should include the button to confirm the request
2024-02-25T15:13:43.9243843Z   #approval_request
2024-02-25T15:13:43.9379792Z     should have the correct subject
2024-02-25T15:13:43.9502632Z     should include the admin link to reject the organization
2024-02-25T15:13:43.9823514Z     should include details of the account request
2024-02-25T15:13:43.9955125Z     should be sent to the info@humanessentials.app email address
2024-02-25T15:13:44.0088821Z     should include the admin link to create the new organization from the account request
2024-02-25T15:13:44.0090281Z     when the account_request_id provided does not match any AccountRequest
2024-02-25T15:13:44.0134949Z       should trigger raise a ActiveRecord::RecordNotFound error
2024-02-25T15:13:44.0135680Z   #rejection
2024-02-25T15:13:44.0250505Z     should be sent to the correct email address
2024-02-25T15:13:44.0358101Z     should have the correct subject
2024-02-25T15:13:44.0468938Z     should include the rejection reason
2024-02-25T15:13:44.0470012Z     when the account_request_id provided does not match any AccountRequest
2024-02-25T15:13:44.0513453Z       should trigger raise a ActiveRecord::RecordNotFound error
2024-02-25T15:13:44.0514436Z 
2024-02-25T15:13:44.0514626Z ApplicationHelper
2024-02-25T15:13:44.0516921Z   flash_class
2024-02-25T15:13:44.0564003Z     returns appropriate class for notice
2024-02-25T15:13:44.0606697Z     returns appropriate class for alert
2024-02-25T15:13:44.0655244Z     returns appropriate class for error
2024-02-25T15:13:44.0696859Z     returns appropriate class for success
2024-02-25T15:13:44.0697651Z   confirm_delete_msg
2024-02-25T15:13:44.0741568Z     subs in string
2024-02-25T15:13:44.0742047Z   step_container_helper
2024-02-25T15:13:44.0745397Z     active_index is less than index
2024-02-25T15:13:44.0787514Z       returns empty string
2024-02-25T15:13:44.0788087Z     active_index is equal to index
2024-02-25T15:13:44.0830809Z       returns active
2024-02-25T15:13:44.0833511Z     active_index is greater than index
2024-02-25T15:13:44.0875593Z       returns done
2024-02-25T15:13:44.0876134Z   default_title_content
2024-02-25T15:13:44.0877489Z     Organization exists
2024-02-25T15:13:44.2642444Z       returns the organization's name
2024-02-25T15:13:44.2643172Z     Organization does not exist
2024-02-25T15:13:44.2706208Z       returns a default name
2024-02-25T15:13:44.2706943Z   active_class
2024-02-25T15:13:44.2764386Z     Returns the controller name (FAILED - 2)
2024-02-25T15:13:44.2765006Z   can_administrate?
2024-02-25T15:13:44.2765835Z     User is part of org but not org admin
2024-02-25T15:13:44.2918316Z       cannot administrate
2024-02-25T15:13:44.2918920Z     User is org admin and not part of org
2024-02-25T15:13:44.4906652Z       cannot administrate
2024-02-25T15:13:44.4907110Z     User is org admin and part of org
2024-02-25T15:13:44.5123647Z       can administrate
2024-02-25T15:13:44.5124841Z 
2024-02-25T15:13:44.5125203Z Reports::AcquisitionReportService
2024-02-25T15:13:44.5126242Z   acquisition report
2024-02-25T15:13:45.4364480Z     should return the proper results on #report
2024-02-25T15:13:45.4365192Z 
2024-02-25T15:13:45.4365449Z DistributionCreateService
2024-02-25T15:13:45.4366458Z   call
2024-02-25T15:13:45.5159767Z     replaces a big distribution with a smaller one, resulting in increased stored quantities
2024-02-25T15:13:45.5849979Z     returns a successful object with Scheduled distribution
2024-02-25T15:13:45.5851116Z     when there's not sufficient inventory
2024-02-25T15:13:45.6449334Z       preserves the Insufficiency error and is unsuccessful
2024-02-25T15:13:45.6450053Z     partner has send reminders setting set to false
2024-02-25T15:13:45.7180002Z       does not send a PartnerMailer
2024-02-25T15:13:45.7180728Z     partner has send reminders setting set to true
2024-02-25T15:13:46.0550443Z       Sends a PartnerMailer
2024-02-25T15:13:46.0551359Z     when there's multiple line items and one has insufficient inventory
2024-02-25T15:13:46.1186999Z       preserves the Insufficiency error and is unsuccessful
2024-02-25T15:13:46.1187680Z     when it fails to save
2024-02-25T15:13:46.1702372Z       preserves the error and is unsuccessful
2024-02-25T15:13:46.1703020Z     partner is deactivated
2024-02-25T15:13:46.2510260Z       does not send an email
2024-02-25T15:13:46.2511160Z     when the line item quantity is not positive
2024-02-25T15:13:46.3013336Z       preserves the RecordInvalid error and is unsuccessful
2024-02-25T15:13:46.3797646Z     when provided with a request ID
2024-02-25T15:13:46.3798335Z       changes the status of the request
2024-02-25T15:13:46.3799120Z       and the request already has a distribution associated with it
2024-02-25T15:13:46.4570773Z         should not be successful
2024-02-25T15:13:46.4571322Z 
2024-02-25T15:13:46.4571512Z Deadlinable
2024-02-25T15:13:46.4572453Z   validations
2024-02-25T15:13:46.4624116Z     validates that reminder day is not the same as deadline day
2024-02-25T15:13:46.4701031Z     is expected to validate that :deadline_day looks like an integer greater than or equal to 1 and less than or equal to 28 as long as it is not nil
2024-02-25T15:13:46.4771850Z     is expected to validate that :reminder_day looks like an integer greater than or equal to 1 and less than or equal to 28 as long as it is not nil
2024-02-25T15:13:46.4773278Z 
2024-02-25T15:13:46.4773475Z RequestsTotalItemsService
2024-02-25T15:13:46.4773950Z   #calculate
2024-02-25T15:13:46.4774493Z     when provided with requests that have no request items
2024-02-25T15:13:46.4849983Z       is expected to be blank
2024-02-25T15:13:46.4851685Z     when the request items is not blank
2024-02-25T15:13:46.4993614Z       return items with correct quantities calculated
2024-02-25T15:13:46.5131356Z       return the names of items correctly
2024-02-25T15:13:46.5131896Z     when provided requests is nil
2024-02-25T15:13:46.5165948Z       is expected to be blank
2024-02-25T15:13:46.5166527Z     when item name is nil
2024-02-25T15:13:46.5294488Z       return Unknown Item
2024-02-25T15:13:46.5295276Z 
2024-02-25T15:13:46.5295553Z Partners::AuthorizedFamilyMember
2024-02-25T15:13:46.5297126Z   versioning
2024-02-25T15:13:46.5335786Z     is expected to be versioned
2024-02-25T15:13:46.5336389Z   associations
2024-02-25T15:13:46.5380551Z     is expected to belong to family required: true
2024-02-25T15:13:46.5419927Z     is expected to have many child_item_requests dependent => nullify
2024-02-25T15:13:46.5420761Z   #display_name
2024-02-25T15:13:46.5708919Z     should return the family member's first and last name
2024-02-25T15:13:46.5709512Z 
2024-02-25T15:13:46.5709736Z Exports::ExportRequestService
2024-02-25T15:13:46.5710391Z   .generate_csv_data
2024-02-25T15:13:46.7728547Z     includes rows for each request with correct columns of item quantity
2024-02-25T15:13:46.9724157Z     includes headers as the first row with ordered item names alphabetically with deleted item included at the end
2024-02-25T15:13:46.9725218Z 
2024-02-25T15:13:46.9725384Z AccountRequest
2024-02-25T15:13:46.9864126Z   #reject!
2024-02-25T15:13:46.9994804Z   #confirm!
2024-02-25T15:13:46.9995734Z   #processed?
2024-02-25T15:13:46.9996951Z     when the account request has no associated organization
2024-02-25T15:13:47.0097551Z       should return false
2024-02-25T15:13:47.0098270Z     when the account request has a associated organization
2024-02-25T15:13:47.1879388Z       should return true
2024-02-25T15:13:47.1879985Z   #identity_token
2024-02-25T15:13:47.1974744Z     should return a JWT token that contains the id of the account_request_id
2024-02-25T15:13:47.1975597Z     when the account_request is not persisted
2024-02-25T15:13:47.2060728Z       should raise an error
2024-02-25T15:13:47.2061249Z   validations
2024-02-25T15:13:47.2185472Z     is expected to validate that the length of :request_details is at least 50
2024-02-25T15:13:47.2304978Z     is expected to validate that :request_details cannot be empty/falsy
2024-02-25T15:13:47.2451508Z     is expected to validate that :email cannot be empty/falsy
2024-02-25T15:13:47.2616559Z     is expected to validate that :name cannot be empty/falsy
2024-02-25T15:13:47.2730487Z     is expected to allow :email to be ‹"jeffery@will-hansen.example"›
2024-02-25T15:13:47.2863316Z     is expected to validate that :email is case-sensitively unique
2024-02-25T15:13:47.2962631Z     is expected not to allow :email to be ‹"not_email"›
2024-02-25T15:13:47.2963541Z     when the email provided is already used by an existing user
2024-02-25T15:13:47.3164192Z       should not allow the email
2024-02-25T15:13:47.3165030Z     when the email provided is already used by an existing organization
2024-02-25T15:13:47.4986231Z       should not allow the email
2024-02-25T15:13:47.4986881Z   versioning
2024-02-25T15:13:47.5027171Z     is expected to be versioned
2024-02-25T15:13:47.5027748Z   .get_by_identity_token
2024-02-25T15:13:47.5028641Z     when the identity_token corresponds to an existing AccountRequest
2024-02-25T15:13:47.5122078Z       should return the corresponding AccountRequest
2024-02-25T15:13:47.5123032Z     when the identity_token provided does not match any AccountRequest
2024-02-25T15:13:47.5158289Z       should return nil
2024-02-25T15:13:47.5158796Z   associations
2024-02-25T15:13:47.5216983Z     is expected to belong to ndbn_member class_name => NDBNMember optional: true
2024-02-25T15:13:47.5251944Z     is expected to have one organization class_name => Organization
2024-02-25T15:13:47.5252759Z 
2024-02-25T15:13:47.5253363Z OrganizationStats
2024-02-25T15:13:47.5254567Z   storage_locations_added method >
2024-02-25T15:13:47.5255543Z     current org is nil >
2024-02-25T15:13:47.5288692Z       should return 0
2024-02-25T15:13:47.5289210Z     current org is not nil >
2024-02-25T15:13:47.5325137Z       should return actual count of locations
2024-02-25T15:13:47.5325896Z   locations_with_inventory method >
2024-02-25T15:13:47.5326782Z     current org is not nil + no locations have items >
2024-02-25T15:13:47.5394400Z       should return an empty array
2024-02-25T15:13:47.5395094Z     current org is not nil + locations have items >
2024-02-25T15:13:47.5736089Z       should return storage location
2024-02-25T15:13:47.5736788Z     current org is nil >
2024-02-25T15:13:47.5772533Z       should return an empty array
2024-02-25T15:13:47.5773150Z   donation_sites_added method >
2024-02-25T15:13:47.5774104Z     current org is not nil >
2024-02-25T15:13:47.5810382Z       should return actual count of donation sites
2024-02-25T15:13:47.5811089Z     current org is nil >
2024-02-25T15:13:47.5843883Z       should return 0
2024-02-25T15:13:47.5844395Z   partners_added method >
2024-02-25T15:13:47.5845333Z     current org is nil >
2024-02-25T15:13:47.5879870Z       should return 0
2024-02-25T15:13:47.5880397Z     current org is not nil >
2024-02-25T15:13:47.5914176Z       should return actual count of partners
2024-02-25T15:13:47.5915149Z 
2024-02-25T15:13:47.5915491Z Kit
2024-02-25T15:13:47.7934111Z   deactivate and reactivate
2024-02-25T15:13:47.7934714Z   versioning
2024-02-25T15:13:47.7977218Z     is expected to be versioned
2024-02-25T15:13:47.7977728Z   #can_deactivate?
2024-02-25T15:13:47.7978578Z     with inventory items
2024-02-25T15:13:48.0167015Z       should return false
2024-02-25T15:13:48.0168058Z     without inventory items
2024-02-25T15:13:48.2133376Z       should return true
2024-02-25T15:13:48.2133875Z   Value >
2024-02-25T15:13:48.2302285Z     converts cents to dollars
2024-02-25T15:13:48.2465549Z     converts dollars to cents
2024-02-25T15:13:48.2466113Z     .value_per_itemizable
2024-02-25T15:13:48.2863290Z       calculates values from associated items
2024-02-25T15:13:48.2863889Z   Validations >
2024-02-25T15:13:48.3029966Z     requires at least one item
2024-02-25T15:13:48.3192414Z     must belong to an organization
2024-02-25T15:13:48.3350685Z     requires a name
2024-02-25T15:13:48.3519854Z     can't have negative value
2024-02-25T15:13:48.5510758Z     requires a unique name
2024-02-25T15:13:48.5677452Z     is valid as built
2024-02-25T15:13:48.5677957Z   Filtering >
2024-02-25T15:13:49.1200337Z     ->alphabetized retrieves items in alphabetical order
2024-02-25T15:13:49.1236119Z     can filter
2024-02-25T15:13:49.1236630Z     ->by_partner_key
2024-02-25T15:13:49.3620835Z       shows the kits for a particular item
2024-02-25T15:13:49.3621731Z 
2024-02-25T15:13:49.3622495Z ReminderDeadlineMailer
2024-02-25T15:13:49.3623542Z   notify deadline
2024-02-25T15:13:49.3921130Z     renders the sender email
2024-02-25T15:13:49.4210082Z     renders the body
2024-02-25T15:13:49.4517244Z     renders the subject
2024-02-25T15:13:49.4804658Z     renders the receiver email
2024-02-25T15:13:49.4805451Z 
2024-02-25T15:13:49.4805713Z InventoryAggregate
2024-02-25T15:13:49.4807111Z   individual events
2024-02-25T15:13:49.8637937Z     should process a kit deallocation event
2024-02-25T15:13:50.1727331Z     should process a purchase destroyed event
2024-02-25T15:13:50.4797827Z     should process a transfer event
2024-02-25T15:13:50.8041678Z     should process a distribution destroyed event
2024-02-25T15:13:51.1106060Z     should process a donation destroyed event
2024-02-25T15:13:51.4179233Z     should process an audit event
2024-02-25T15:13:51.7366535Z     should process a transfer destroy event
2024-02-25T15:13:52.0407952Z     should process a kit allocation event
2024-02-25T15:13:52.3429641Z     should process a distribution event
2024-02-25T15:13:52.6514336Z     should process a donation event after a new storage location is created
2024-02-25T15:13:52.9644253Z     should process an adjustment event
2024-02-25T15:13:53.2559201Z     should process a purchase event
2024-02-25T15:13:53.5327914Z     should process a snapshot event
2024-02-25T15:13:53.8163451Z     should process a donation event
2024-02-25T15:13:53.8164161Z   multiple events
2024-02-25T15:13:54.0927167Z     should handle timing correctly
2024-02-25T15:13:54.3990608Z     should handle intervening audits
2024-02-25T15:13:54.8034117Z     should process multiple events
2024-02-25T15:13:55.0676689Z     should handle changing storage location
2024-02-25T15:13:55.3316196Z     should ignore unusable snapshots
2024-02-25T15:13:55.3316896Z   validation
2024-02-25T15:13:55.3317345Z     subsequent event is incorrect
2024-02-25T15:13:55.6352133Z       should add the event to the message
2024-02-25T15:13:55.6352848Z     current event is incorrect
2024-02-25T15:13:55.8738585Z       should raise a bare error
2024-02-25T15:13:55.8739288Z 
2024-02-25T15:13:55.8739455Z Request
2024-02-25T15:13:55.8740720Z   item data
2024-02-25T15:13:55.8820568Z     coerces item quantity and id to always be an integer before saving
2024-02-25T15:13:55.8821340Z   Enums >
2024-02-25T15:13:55.8821678Z     #status
2024-02-25T15:13:55.9016437Z       scopes
2024-02-25T15:13:55.9016859Z   versioning
2024-02-25T15:13:55.9051134Z     is expected to be versioned
2024-02-25T15:13:55.9051686Z   total_items
2024-02-25T15:13:55.9145302Z     adds the quantity of all items in the request
2024-02-25T15:13:55.9145718Z 
2024-02-25T15:13:55.9145896Z Reports::ChildrenServedReportService
2024-02-25T15:13:55.9146871Z   #report
2024-02-25T15:13:56.0878010Z     should report zero values
2024-02-25T15:13:56.5974698Z     should work with no distribution_quantity
2024-02-25T15:13:57.2251980Z     should report normal values
2024-02-25T15:13:57.2256633Z 
2024-02-25T15:13:57.2256818Z EventDiffer
2024-02-25T15:13:57.4744497Z   should return a full diff
2024-02-25T15:13:57.4745140Z 
2024-02-25T15:13:57.4745299Z Purchase
2024-02-25T15:13:57.4747119Z   Validations >
2024-02-25T15:13:57.4833694Z     must belong to an organization
2024-02-25T15:13:57.5010536Z     is not valid if any category is non-zero but does not add up to the total
2024-02-25T15:13:57.5099320Z     is not valid if categories do not add up
2024-02-25T15:13:57.5184155Z     is valid if categories have no values
2024-02-25T15:13:57.5267049Z     ensures that the issued at is no earlier than 2000
2024-02-25T15:13:57.5352459Z     is not valid if period supplies is non-zero but no other category is
2024-02-25T15:13:57.5537224Z     is invalid when the line items are invalid
2024-02-25T15:13:57.5610272Z     requires an inventory (storage location)
2024-02-25T15:13:57.5694377Z     is valid if all categories add up to total
2024-02-25T15:13:57.5695050Z   Callbacks >
2024-02-25T15:13:57.5886078Z     automatically combines duplicate line_item records when they're created
2024-02-25T15:13:57.6064699Z     inititalizes the issued_at field to default to midnight if it wasn't explicitly set
2024-02-25T15:13:57.6065696Z   Associations >
2024-02-25T15:13:57.6066107Z     items >
2024-02-25T15:13:57.6263928Z       has_many
2024-02-25T15:13:57.6264390Z   versioning
2024-02-25T15:13:57.6301680Z     is expected to be versioned
2024-02-25T15:13:57.6302245Z   Methods >
2024-02-25T15:13:57.6302895Z     storage_view
2024-02-25T15:13:57.7041029Z       returns name of storage location
2024-02-25T15:13:57.7041664Z     remove
2024-02-25T15:13:57.7812990Z       fails gracefully if the item doesn't exist
2024-02-25T15:13:57.8496731Z       removes the item from the purchase
2024-02-25T15:13:57.8497552Z   behaves like itemizable
2024-02-25T15:13:57.8498488Z     .to_a
2024-02-25T15:13:57.8499410Z       with Flipper flag :deprecate_to_a enabled
2024-02-25T15:13:57.8873200Z         raises an error
2024-02-25T15:13:57.8873869Z       with Flipper flag :deprecate_to_a disabled
2024-02-25T15:13:57.9226969Z         calls line_item_values
2024-02-25T15:13:57.9227518Z     .line_items
2024-02-25T15:13:57.9228647Z       combine!
2024-02-25T15:13:57.9655153Z         combines multiple line_items with the same item_id into a single record
2024-02-25T15:13:58.0167902Z         incrementally combines line_items on donations that have already been created
2024-02-25T15:13:58.0169033Z       sorted
2024-02-25T15:13:58.0754842Z         displays the items, sorted by name
2024-02-25T15:13:58.0755334Z       quantities_by_name
2024-02-25T15:13:58.1142253Z         returns a hash of items with id, name, and quantity
2024-02-25T15:13:58.1548812Z         leaves out zero-quantitied items if requested
2024-02-25T15:13:58.1549514Z       total
2024-02-25T15:13:58.1936369Z         has an item total
2024-02-25T15:13:58.1937255Z   Scopes >
2024-02-25T15:13:58.1938137Z     during >
2024-02-25T15:13:58.2178994Z       returns all purchases created between two dates
2024-02-25T15:13:58.2179979Z 
2024-02-25T15:13:58.2180325Z OrganizationUpdateService
2024-02-25T15:13:58.2181425Z   #update
2024-02-25T15:13:58.2182593Z     when organization has partners
2024-02-25T15:13:58.2184005Z       when all of a single partner's request flags WILL NOT be disabled
2024-02-25T15:13:58.4426386Z         should allow the disabling of request flags in organization and its partners
2024-02-25T15:13:58.4427815Z       when all of a single partner's request flags will be disabled
2024-02-25T15:13:58.6684139Z         should add an error message to the organization
2024-02-25T15:13:58.8893818Z         should NOT change request flags in organization or its partners
2024-02-25T15:13:58.8894890Z     when object is valid
2024-02-25T15:13:59.0703371Z       should update and return true
2024-02-25T15:13:59.0703973Z     when object is invalid
2024-02-25T15:13:59.2461482Z       should not update and return false
2024-02-25T15:13:59.2462190Z   #update_partner_flags
2024-02-25T15:13:59.2463268Z     when request flags haven't changed
2024-02-25T15:13:59.4598884Z       should not update partners
2024-02-25T15:13:59.4599530Z     when request flags have changed
2024-02-25T15:13:59.6916291Z       should update partners when disabling child and individual request flags
2024-02-25T15:13:59.9181131Z       should update partners when disabling quantity-based request flags
2024-02-25T15:14:00.1364278Z       should NOT update partners' request flags when enabling request flags on the organization
2024-02-25T15:14:00.1365139Z 
2024-02-25T15:14:00.1365325Z ProductDriveHelper
2024-02-25T15:14:00.1366150Z   #is_virtual
2024-02-25T15:14:00.1368273Z     when the product drive wasn't held virtually
2024-02-25T15:14:00.1429626Z       is expected to eq "No"
2024-02-25T15:14:00.1430282Z     when the product drive was held virtually
2024-02-25T15:14:00.1484390Z       is expected to eq "Yes"
2024-02-25T15:14:00.1485013Z     when a product drive was not provided
2024-02-25T15:14:00.1528291Z       without argument
2024-02-25T15:14:00.1571596Z       with blank argument
2024-02-25T15:14:00.1573133Z 
2024-02-25T15:14:00.1573416Z Transfer
2024-02-25T15:14:00.1574894Z   Validations >
2024-02-25T15:14:00.1657453Z     must belong to an organization
2024-02-25T15:14:00.2295142Z     requires that the line items must have sufficient quantity in the inventory
2024-02-25T15:14:00.4123838Z     must only use storage locations that belong to the organization (no hacks!)
2024-02-25T15:14:00.4374281Z     requires that each line item exists in the inventory
2024-02-25T15:14:00.4494056Z     must have different storage locations
2024-02-25T15:14:00.4612721Z     must have storage locations set
2024-02-25T15:14:00.4613322Z   Scopes >
2024-02-25T15:14:00.4836401Z     `from_location` can filter out transfers from a specific location
2024-02-25T15:14:00.5058507Z     `to_location` can filter out transfers to a specific location
2024-02-25T15:14:00.5059298Z   behaves like itemizable
2024-02-25T15:14:00.5060073Z     .to_a
2024-02-25T15:14:00.5061152Z       with Flipper flag :deprecate_to_a enabled
2024-02-25T15:14:00.5413932Z         raises an error
2024-02-25T15:14:00.5414694Z       with Flipper flag :deprecate_to_a disabled
2024-02-25T15:14:00.5785772Z         calls line_item_values
2024-02-25T15:14:00.5786343Z     .line_items
2024-02-25T15:14:00.5787376Z       sorted
2024-02-25T15:14:00.6520162Z         displays the items, sorted by name
2024-02-25T15:14:00.6520835Z       quantities_by_name
2024-02-25T15:14:00.7016756Z         returns a hash of items with id, name, and quantity
2024-02-25T15:14:00.7522529Z         leaves out zero-quantitied items if requested
2024-02-25T15:14:00.7523235Z       total
2024-02-25T15:14:00.8007935Z         has an item total
2024-02-25T15:14:00.8008462Z       combine!
2024-02-25T15:14:00.8278372Z         incrementally combines line_items on donations that have already been created
2024-02-25T15:14:00.8750025Z         combines multiple line_items with the same item_id into a single record
2024-02-25T15:14:00.8750952Z   Methods >
2024-02-25T15:14:01.0708879Z     `self.storage_locations_transferred_to` and `..._from` constrains appropriately
2024-02-25T15:14:01.0709491Z   versioning
2024-02-25T15:14:01.0749179Z     is expected to be versioned
2024-02-25T15:14:01.0749962Z 
2024-02-25T15:14:01.0750106Z User
2024-02-25T15:14:01.0751512Z   #role_added
2024-02-25T15:14:01.1190893Z     renders the body correctly
2024-02-25T15:14:01.1191537Z   #send_reset_password_instructions
2024-02-25T15:14:01.1195016Z     user gets an email with instructions
2024-02-25T15:14:01.2110228Z       sends an email with instructions
2024-02-25T15:14:01.6583668Z 
2024-02-25T15:14:01.6584827Z Pending: (Failures listed here are expected and do not affect your suite's status)
2024-02-25T15:14:01.6586849Z 
2024-02-25T15:14:01.6588243Z   1) Partners::RequestApprovalService#call when the partner is not yet waiting for approval and there is a profile error should return an error re agency_type
2024-02-25T15:14:01.6589196Z      # Temporarily skipped with xit
2024-02-25T15:14:01.6589944Z      # ./spec/services/partners/request_approval_service_spec.rb:28
2024-02-25T15:14:01.6728186Z 
2024-02-25T15:14:01.6728528Z Failures:
2024-02-25T15:14:01.6728836Z 
2024-02-25T15:14:01.6729403Z   1) Reports::PartnerInfoReportService#report should report normal values
2024-02-25T15:14:01.6730426Z      Failure/Error:
2024-02-25T15:14:01.6730982Z        expect(report.report).to eq({
2024-02-25T15:14:01.6731891Z                                      entries: { "Agency Type: Career technical training" => 2,
2024-02-25T15:14:01.6732922Z                                                 "Agency Type: Education program" => 1,
2024-02-25T15:14:01.6733746Z                                                 "Number of Partner Agencies" => 3,
2024-02-25T15:14:01.6734859Z                                                 "Zip Codes Served" => "90210-1234, 12345, 09876-3564" },
2024-02-25T15:14:01.6735733Z                                      name: "Partner Agencies and Service Area"
2024-02-25T15:14:01.6736445Z                                    })
2024-02-25T15:14:01.6737114Z 
2024-02-25T15:14:01.6738843Z        expected: {:entries=>{"Agency Type: Career technical training"=>2, "Agency Type: Education program"=>1, "Number...3, "Zip Codes Served"=>"90210-1234, 12345, 09876-3564"}, :name=>"Partner Agencies and Service Area"}
2024-02-25T15:14:01.6742148Z             got: {:entries=>{"Agency Type: Career technical training"=>2, "Agency Type: Education program"=>1, "Number...3, "Zip Codes Served"=>"12345, 09876-3564, 90210-1234"}, :name=>"Partner Agencies and Service Area"}
2024-02-25T15:14:01.6743686Z 
2024-02-25T15:14:01.6743854Z        (compared using ==)
2024-02-25T15:14:01.6744155Z 
2024-02-25T15:14:01.6744299Z        Diff:
2024-02-25T15:14:01.6744697Z        @@ -1 +1 @@
2024-02-25T15:14:01.6746241Z        -:entries => {"Agency Type: Career technical training"=>2, "Agency Type: Education program"=>1, "Number of Partner Agencies"=>3, "Zip Codes Served"=>"90210-1234, 12345, 09876-3564"},
2024-02-25T15:14:01.6748833Z        +:entries => {"Agency Type: Career technical training"=>2, "Agency Type: Education program"=>1, "Number of Partner Agencies"=>3, "Zip Codes Served"=>"12345, 09876-3564, 90210-1234"},
2024-02-25T15:14:01.6750781Z      # ./spec/services/reports/partner_info_report_service_spec.rb:27:in `block (3 levels) in <top (required)>'
2024-02-25T15:14:01.6751676Z 
2024-02-25T15:14:01.6752019Z   2) ApplicationHelper active_class Returns the controller name
2024-02-25T15:14:01.6753187Z      Failure/Error: if name.include?(controller_path) || name.find { |n| request.path.ends_with?(n) }
2024-02-25T15:14:01.6753999Z 
2024-02-25T15:14:01.6754152Z      NoMethodError:
2024-02-25T15:14:01.6754711Z        undefined method `find' for "foo":String
2024-02-25T15:14:01.6755455Z      # ./app/helpers/application_helper.rb:18:in `active_class'
2024-02-25T15:14:01.6756494Z      # ./spec/helpers/application_helper_spec.rb:32:in `block (3 levels) in <top (required)>'
2024-02-25T15:14:01.6757381Z 
2024-02-25T15:14:01.6757736Z Finished in 47.81 seconds (files took 8.27 seconds to load)
2024-02-25T15:14:01.6758456Z 556 examples, 2 failures, 1 pending
2024-02-25T15:14:01.6758829Z 
2024-02-25T15:14:01.6758983Z Failed examples:
2024-02-25T15:14:01.6759226Z 
2024-02-25T15:14:01.6760173Z rspec ./spec/services/reports/partner_info_report_service_spec.rb:19 # Reports::PartnerInfoReportService#report should report normal values
2024-02-25T15:14:01.6762095Z rspec ./spec/helpers/application_helper_spec.rb:31 # ApplicationHelper active_class Returns the controller name
2024-02-25T15:14:01.6763100Z 
2024-02-25T15:14:01.6774697Z Randomized with seed 60855
2024-02-25T15:14:01.6775294Z 
2024-02-25T15:14:02.1762254Z Coverage report generated for RSpec to /home/runner/work/human-essentials/human-essentials/coverage. 3774 / 6454 LOC (58.48%) covered.
2024-02-25T15:14:02.1763918Z Stopped processing SimpleCov as a previous error not related to SimpleCov has been detected
2024-02-25T15:14:02.2319001Z /opt/hostedtoolcache/Ruby/3.2.2/x64/bin/ruby -I/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/lib:/home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-support-3.12.1/lib /home/runner/work/human-essentials/human-essentials/vendor/bundle/ruby/3.2.0/gems/rspec-core-3.12.2/exe/rspec  --format documentation --format KnapsackPro::Formatters::TimeTracker --default-path spec "spec/events/inventory_aggregate_spec.rb" "spec/models/product_drive_spec.rb" "spec/models/distribution_spec.rb" "spec/services/kit_create_service_spec.rb" "spec/services/organization_update_service_spec.rb" "spec/models/kit_spec.rb" "spec/services/allocate_kit_inventory_service_spec.rb" "spec/models/partner_spec.rb" "spec/services/deallocate_kit_inventory_service_spec.rb" "spec/services/distribution_destroy_service_spec.rb" "spec/queries/items_in_query_spec.rb" "spec/queries/items_in_total_query_spec.rb" "spec/services/remove_role_service_spec.rb" "spec/services/reports/children_served_report_service_spec.rb" "spec/services/reports/summary_report_service_spec.rb" "spec/models/request_item_spec.rb" "spec/models/transfer_spec.rb" "spec/services/reports/acquisition_report_service_spec.rb" "spec/services/item_create_service_spec.rb" "spec/services/distribution_create_service_spec.rb" "spec/services/reports/period_supply_report_service_spec.rb" "spec/models/purchase_spec.rb" "spec/services/exports/export_distributions_csv_service_spec.rb" "spec/mailers/distribution_mailer_spec.rb" "spec/jobs/partner_mailer_job_spec.rb" "spec/models/account_request_spec.rb" "spec/models/barcode_item_spec.rb" "spec/models/product_drive_participant_spec.rb" "spec/services/distributions_by_county_report_service_spec.rb" "spec/helpers/application_helper_spec.rb" "spec/services/exports/export_request_service_spec.rb" "spec/services/reports/partner_info_report_service_spec.rb" "spec/services/historical_trend_service_spec.rb" "spec/services/partners/request_create_service_spec.rb" "spec/services/calendar_service_spec.rb" "spec/models/partners/family_spec.rb" "spec/mailers/account_request_mailer_spec.rb" "spec/queries/items_out_query_spec.rb" "spec/events/event_differ_spec.rb" "spec/services/partner_approval_service_spec.rb" "spec/services/partners/request_approval_service_spec.rb" "spec/models/partners/profile_spec.rb" "spec/services/distribution_reminder_spec.rb" "spec/mailers/user_mailer_spec.rb" "spec/queries/items_out_total_query_spec.rb" "spec/services/exports/export_donations_csv_service_spec.rb" "spec/mailers/reminder_deadline_mailer_spec.rb" "spec/services/request_destroy_service_spec.rb" "spec/models/broadcast_announcement_spec.rb" "spec/models/question_spec.rb" "spec/services/partners/update_family_spec.rb" "spec/models/users_role_spec.rb" "spec/models/organization_stats_spec.rb" "spec/models/partners/authorized_family_member_spec.rb" "spec/services/requests_total_items_service_spec.rb" "spec/jobs/notify_partner_job_spec.rb" "spec/models/request_spec.rb" "spec/services/donation_destroy_service_spec.rb" "spec/models/partners/child_item_request_spec.rb" "spec/mailers/request_mailer_spec.rb" "spec/jobs/reminder_deadline_job_spec.rb" "spec/helpers/product_drive_helper_spec.rb" "spec/services/donation_create_service_spec.rb" "spec/models/concerns/deadlinable_spec.rb" "spec/helpers/historical_trends_helper_spec.rb" "spec/helpers/ui_helper_spec.rb" "spec/routing/account_requests_routing_spec.rb" "spec/services/exports/export_report_csv_service_spec.rb" failed
2024-02-25T15:14:02.6238229Z Stopped processing SimpleCov as a previous error not related to SimpleCov has been detected
2024-02-25T15:14:02.6240509Z Coverage report generated for RSpec to /home/runner/work/human-essentials/human-essentials/coverage. 38 / 10719 LOC (0.35%) covered.
2024-02-25T15:14:02.6555285Z ##[error]Process completed with exit code 1.
